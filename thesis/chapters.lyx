#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties false
\origin unavailable
\textclass book
\begin_preamble
\usepackage{pvcstyle}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
theorems-ams-extended
theorems-chap
\end_modules
\maintain_unincluded_children false
\language chinese-simplified
\language_package default
\inputencoding utf8-plain
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts true
\font_sc true
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing onehalf
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_pagemode FullScreen
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2.5cm
\bottommargin 2.5cm
\secnumdepth 2
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style cjk
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\listings_params "style=xcode,frame=leftline,baselinestretch={1.0},breaklines=true,fontsize={\small}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
绪论
\begin_inset CommandInset label
LatexCommand label
name "chap:绪论"

\end_inset


\end_layout

\begin_layout Section
研究背景和意义
\end_layout

\begin_layout Standard
直升机以其特有的垂直起降、悬停和低空低速飞行能力，特别适合于在军舰、科考船、海上钻井平台等起降条件和飞行环境较差的平台上执行任务。舰载直升机能够有效扩大舰船作业
半径、丰富海上作业科目、提升应对海上突发情况的能力。发展舰载直升机对于保障舰船航行安全、维护海洋权益具有重要意义。世界各海洋大国和航空大国历来重视舰载直升机的发
展，相继研制出各种不同构型的舰载直升机，如表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:shipborne-helicopter"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。我国海军正处于“近海防御型向近海防御与远海护卫型结合转变”
\begin_inset CommandInset citation
LatexCommand cite
key "PRC2015"
literal "false"

\end_inset

的关键时期，发展适合中国国情的舰载直升机，对于实施海洋强国战略具有重要意义。
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:shipborne-helicopter"

\end_inset

国外主要舰载直升机
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="17" columns="6">
<features booktabs="true" islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
首飞时间
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
研制单位
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
型号
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
别名/绰号
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
构型
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
旋翼直径 (m)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1954
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国西科斯基公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UH-34D/E
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea Horse
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17.07
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1959
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国西科斯基公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SH-3A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea King
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1959
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国卡曼宇航公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SH-2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea Sprite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13.14
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1961
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
苏联卡莫夫设计局
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ka-25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hormone
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼共轴式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1962
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国波音直升机公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CH-46
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea Knight
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼纵列式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.24
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1963
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
法国宇航公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SA321
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Super Frelon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1964
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国西科斯基公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CH-53A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea Stallion
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22.02
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1966
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国贝尔直升机公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TH-57A/B/C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea Ranger
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.16
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1973
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
苏联卡莫夫设计局
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ka-27/28
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Helix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼共轴式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1976
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
苏联卡莫夫设计局
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ka-29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Helix-B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼共轴式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1978
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
法国宇航公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AS332/AS532
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Super Puma
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1979
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国西科斯基公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SH-60B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sea Hawk
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1981
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
苏联卡莫夫设计局
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ka-32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Helix-C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼共轴式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1982
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
法国宇航公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SA365F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Panther
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
单旋翼带尾桨式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11.94
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1989
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
美国贝尔直升机公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V-22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Osprey
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼横列式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11.61
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1997
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
俄罗斯卡莫夫公司
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ka-52
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alligator
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
双旋翼共轴式
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.43
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
注：表中的“首飞时间”按原型机计；V-22 的“构型”只考虑其直升机形态。
\end_layout

\end_inset


\end_layout

\begin_layout Standard
在舰载直升机的设计、使用和维护过程中，存在大量亟待解决的科学和工程问题。其中，既有旋翼飞行器所共有的一般性问题，也有直升机执行海上作业任务所带来的特殊问题。与陆
基直升机对比，海面、舰面特有的气流环境，为舰载直升机设计、使用及维护带来了一些新的问题，空气动力学是其中最核心、最关键的问题。舰船在海面航行时，船体结构对海面气
流的扰动使得直升机起降平台附近的气流环境较为复杂，增加了直升机完成起降飞行任务的难度。海面的风速和风向、舰船的航速和航向都是影响上述“船体空气尾流
 (ship airwake)”的重要因素。直升机旋翼尾迹与船体空气尾流之间存在复杂的相互作用，进一步增加了上述问题的复杂程度。研究舰载直升机空气动力学，特别是
海面、船体与旋翼之间的气动干扰问题，对于确定直升机舰面起降的环境条件，制定和完善直升机舰面起降作业流程（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:landing"

\end_inset

 所示），提高舰载直升机的安全性和作业效率具有重要意义。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/landing.jpg
	lyxscale 30
	width 100text%
	height 30theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:landing"

\end_inset

英国海军舰载直升机着舰标准作业流程
\begin_inset CommandInset citation
LatexCommand cite
key "K_ri__2012"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Section
旋翼飞行器综合分析
\end_layout

\begin_layout Plain Layout
旋翼（Rotor）是以直升机（Helicopter）为代表的旋翼飞行器（Rotorcraft）区别于其他航空飞行器（Aircraft/Aerocraft）的标志
性部件。 从力学研究的角度来看，旋翼系统（以及旋翼-机体耦合系统）属于复杂的刚柔耦合多体动力学系统。 与其他复杂系统一样，对旋翼系统（以及旋翼-机体耦合系统）的
研究大致可以分为试验和计算两大类。
\end_layout

\begin_layout Plain Layout
试验研究，是人们对科学和工程问题所有理性认识的主要来源，也是检验一切物理模型和计算方法合理性的重要依据。 对旋翼飞行器的试验研究， 按试验对象可以分为缩比模型试
验、全尺寸样机试验； 按试验环境可以分为风洞试验、试飞试验。 由于代价昂贵，只有少数大型研究机构和企业有能力对旋翼飞行器开展系统的试验研究。
\end_layout

\begin_layout Plain Layout
计算研究，是对试验研究的重要补充，有时也被称为数值试验。 它是指从运动学、动力学、空气动力学等学科的基础理论出发，利用计算机，对直升机（特别是旋翼）的力学行为进
行分析计算。 相对于模型或样机试验，数值试验拥有巨大的成本优势，这是驱动计算研究不断发展的主要动力。 对于新的设计方案，数值试验能够先于模型或样机试验对其性能指
标进行评价，这也是其相对于模型或样机试验所具有的优势。 另外，对于飞行事故等模型或样机试验难以复现的过程，数值试验也是不可替代的研究手段。 可以预见，随着计算机
硬件和分析软件水平的不断提高，数值试验将在直升机设计、使用和维护过程中扮演越来越重要的角色。
\end_layout

\begin_layout Plain Layout
直升机界于1980年左右提出了“综合分析（Comprehensive Analysis）”的概念。 美国直升机界的权威专家、著名直升机综合分析软件CAMRAD
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Comprehensive Analytical Model of Rotorcraft Aerodynamics and Dynamics
\end_layout

\end_inset

 的开发者Wayne Johnson将综合分析定义为： “分析直升机在气动载荷作用下力学行为的通用计算程序”
\begin_inset CommandInset citation
LatexCommand cite
key "Johnson2012"
literal "false"

\end_inset

。 这里的“综合（Comprehensive）”应从以下几个角度来理解： 
\end_layout

\begin_layout Description
分析内容 综合分析涵盖了与直升机相关的所有力学问题，包括：总体性能、配平、桨叶运动、气动载荷、结构载荷、振动、噪声、气弹稳定性、气弹响应、飞行品质等。
 
\end_layout

\begin_layout Description
分析对象 综合分析适用于所有直升机构型（单旋翼带尾桨式、共轴式、纵列式、横列式）和旋翼构型（全铰式、跷跷板式、球铰式、无铰式、无轴承式）。 
\end_layout

\begin_layout Description
涉及学科 综合分析涉及空气动力学、结构动力学、飞行动力学等多个应用力学分支。 
\end_layout

\begin_layout Description
扩展性 综合分析的模型和程序应当具有扩展性，能够适用于新的构型设计方案，能够方便地引进新的物理模型和计算方法。 
\end_layout

\begin_layout Description
通用性 综合分析应当贯穿于直升机设计和改进过程的每个阶段。 
\end_layout

\begin_layout Plain Layout
要实现上述综合分析，必须首先解决空气动力学、动力学分析的若干关键技术。 过去几十年，这些学科各自独立的分析方法都得到了不同程度的发展，并且已经开发出许多通用的大
型分析软件。 理想的综合分析是在现有的认识水平下，采用各学科最先进的分析技术，以达到尽可能高的计算精度。 然而，由于理论和分析技术的发展水平参差不齐，目前尚无法
将各学科最先进技术的分析技术很好地整合在一起。 建立真正体现多物理场耦合的综合分析平台，始终是各国直升机界共同的奋斗目标。
\end_layout

\begin_layout Subsection
旋翼空气动力学
\end_layout

\begin_layout Plain Layout
在综合分析所涉及的几个主要学科中，空气动力学被认为是制约上述目标实现的主要瓶颈。 事实上，旋翼空气动力学也是流体力学研究的难点和热点，这主要是因为旋翼所处气流环
境具有非定常、非线性的特点。
\end_layout

\begin_layout Plain Layout
非定常主要表现在以下两个方面： 首先，由于旋翼始终相对机身运动，即使在悬停状态，旋翼-机身系统所处的气流环境也是随桨叶方位变化而变化的； 其次，随着旋翼高速旋转
，桨叶当地迎角剧烈变化，局部会出现大迎角甚至反流状态，桨叶剖面的动态失速特性十分明显
\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1998Aero"
literal "false"

\end_inset

。
\end_layout

\begin_layout Plain Layout
非线性主要体现在以下两个方面： 其一，气动力与当地迎角、马赫数、雷诺数的关系，在较大的迎角、马赫数范围内没有线性的（甚至也没有解析的）表达式；
 其二，旋翼尾迹由桨尖涡主导，机身、固定翼面尾迹与旋翼桨尖涡之间存在复杂的非线性自诱导和互诱导现象。
\end_layout

\begin_layout Plain Layout
非定常气动力、动态失速、空气压缩性 、桨尖涡主导的旋翼尾迹分析构成了旋翼空气动力学的主要研究内容
\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1995Wake"
literal "false"

\end_inset

。 研究方法大致分为试验和数值计算两大类。 试验研究包含定性流动显示试验、测力试验、测速试验、定量流动显示试验。 其中，基于三维粒子成像测速技术的高分辨率定量流
动显示试验的是该领域的研究热点。 数值计算研究包含旋翼入流模型、涡线尾迹模型、黏性涡粒子方法、基于欧拉观点的涡量输运方程、计算流体动力学（Computation
al Fluid Dynamics, CFD）等方法。 其中，CFD方法又分为雷诺平均Navier–Stokes方程、大涡模拟、直接数值模拟等几个层次。
 尽管直接数值模拟被认为是流体力学数值计算研究的终点，但旋翼流场飞行这一复杂流动问题的多尺度特性决定了该方法短时间内还难以应用于解决实际工程问题。
 基于流动特征的混合方法、自适应网格加密技术、高性能并行计算等，是目前较为可行的替代手段。
\end_layout

\begin_layout Subsection
结构动力学
\end_layout

\begin_layout Plain Layout
动力学问题最基本、最一般的表述已由Hamilton原理给出。 
\begin_inset Formula 
\begin{equation}
\delta\int_{t_{1}}^{t_{2}}\left(T-V+W\right)\dd t=0
\end{equation}

\end_inset

其中，
\begin_inset Formula $T$
\end_inset

为系统动能，
\begin_inset Formula $V$
\end_inset

为保守力（重力、弹性力）的势，
\begin_inset Formula $W$
\end_inset

为非保守力的功。
\end_layout

\begin_layout Plain Layout
旋翼系统、旋翼-机体系统的动能、势能（包括重力势能和弹性势能）、能量耗散函数、外力功的表达式原则上都可以按部就班地推出，但具体实施起来相当繁琐。
 针对某种特定构型，建立相应的动力学模型原则上并不困难。 如何使建模方法具有通用性和扩展性，则是该领域的研究热点。 为使推导过程尽可能具有通用性，尽可能减少手动
推导的工作量，需引入多体系统动力学的思想和方法
\begin_inset CommandInset citation
LatexCommand cite
key "HongJZ1999,Wittenburg2008,Shabana2013"
literal "false"

\end_inset

。
\end_layout

\begin_layout Plain Layout
早期的旋翼动力学分析采用小挥舞角、小摆振角、小变形假设，为的是得到线性或局部线性的表达式，以便于通过解析的方法进行分析计算。 但这样得出的动力学关系式并不能真实
反映旋翼系统的动力学特性。 进入21世纪，计算机性能相对于几十年前已经获得了很大程度的提高，以往被认为无法承受的计算量，现在已经能够在高性能工作站或集群上进行处
理。 另一方面，整个综合分析的计算量主要集中在气动分析方面，如果动力学模块的算法设计得合理，考虑几何非线性一般不会明显增加计算量。 但几何非线性给动力学分析带来
了新的问题，例如结构动力学分析中常用的有限元法（Finite Element Method, FEM），在处理大变形问题时会出现网格畸变，从而影响计算效果和计算
效率。
\end_layout

\begin_layout Plain Layout
动力学方程的规范列式和相应的数值求解方法，以及对非线性耦合效应的处理，是综合分析在动力学方面需要解决的关键问题
\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1998Dyna"
literal "false"

\end_inset

。
\end_layout

\begin_layout Subsection
舰载直升机
\end_layout

\begin_layout Plain Layout
以上所列举的旋翼飞行器所共有的一般性问题，是研究舰载直升机空气动力学、结构动力学、飞行动力学问题的基础。 海面、舰面特有的气流、动力学环境，则为舰载直升机设计、
使用及维护带来了一些新的问题。
\end_layout

\begin_layout Plain Layout
舰船在海面航行时，船体结构对海面气流的扰动使得直升机起降平台附近的气流环境较为复杂，增加了直升机完成起降飞行任务的难度。 海面的风速和风向、舰船的航速和航向都是
影响上述船体空气尾流（Ship Airwake）的重要因素。
\end_layout

\begin_layout Plain Layout
海浪和海风引起的船体起伏、俯仰、滚转运动，使舰载直升机舰面动力学问题的复杂程度，大大高于直升机在地面和空中飞行时所对应的动力学问题。 直升机旋翼尾迹与船体空气尾
流之间存在复杂的相互作用，进一步增加了上述问题的复杂程度。
\end_layout

\begin_layout Plain Layout
建立合适的海风模型、船体空气尾流模型、气动干扰模型，是舰载直升机空气动力学研究的主要任务； 研究舰载直升机在各种海浪和海风条件下的动力学稳定性，是舰载直升机结构
动力学研究的主要内容； 确定舰载直升机在各种海风条件和舰船航行状态下的安全飞行路径和操纵策略，则是舰载直升机飞行动力学、导航及控制方法研究的重点和难点。
\end_layout

\begin_layout Subsection
小结
\end_layout

\begin_layout Plain Layout
在舰载直升机设计和使用所面临的各种科学和工程问题中，空气动力学是其中最核心、最关键的问题。 国内外众多学者在这方面开展了大量研究工作，积累了丰富的研究方法和研究
成果。 本文对旋翼空气动力学、舰船空气动力学以及计算空气动力学新方法的研究现状进行了综述，介绍了与舰载直升机相关的一些应用问题，并总结了该领域在未来一段时间内的
发展趋势。
\end_layout

\end_inset


\end_layout

\begin_layout Section
国内外研究现状
\end_layout

\begin_layout Standard
旋翼是直升机最主要的气动部件，其对流场的周期性扰动使得直升机外流场具有显著不同于定翼机外流场的特征。因此，旋翼空气动力学构成了直升机空气动力学的主体（后者还包括
旋翼与机身、地面的气动干扰），从而也构成了舰载直升机空气动力学（侧重于研究旋翼尾迹与海面气流、船体空气尾流之间的气动干扰）的基础。旋翼空气动力学的研究方法包括试
验和计算两大类，前者可分为定性试验与定量试验，后者包括基于拉格朗日观点的涡方法、基于欧拉观点的
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "CFD"
description "computational fluid dynamics"
literal "true"

\end_inset

“计算流体动力学 (computational fluid dynamics, CFD)”方法以及兼具二者优势的混合方法。
\end_layout

\begin_layout Standard
舰载直升机所特有的空气动力学问题，主要表现为海面自由来流和舰船空气尾流与旋翼尾迹的相互作用。起飞和着舰过程中，海面和舰面阻挡旋翼尾迹向下游移动，引起的“地”面效
应，也是影响直升机飞行安全的重要因素。研究海面、舰面与旋翼之间的气动干扰，是舰载直升机舰面空气动力学的主要任务。与旋翼空气动力学类似，该领域的研究方法也分为试验
和计算两大类。
\end_layout

\begin_layout Subsection
旋翼空气动力学试验
\end_layout

\begin_layout Standard
对旋翼流场的试验研究始终伴随和促进着旋翼飞行器的发展，拓展着人们对旋翼空气动力学理解的深度和广度，不断为物理模型和计算方法的验证提供新的数据支持。得益于试验技术
的不断进步，对旋翼空气动力学的试验研究经历了从定性到定量，从总体力学参数测量到高分辨率流动细节捕捉的发展过程。
\end_layout

\begin_layout Subsubsection
定性试验
\end_layout

\begin_layout Standard
最简单的旋翼空气动力学“试验”并不需要经过人为的设计，也不需要使用任何试验设备。当空气的温度、湿度、气压满足一定的条件时，旋翼桨尖涡周围会出现自然凝结现象（如图
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:natural-condensation"

\end_inset

 所示），从而很容易让人们观察到桨尖涡的存在。基于这种观察，人们对旋翼流场有了最基本和最直观的理性认识，发现了旋翼尾迹由桨尖涡主导、尾迹收缩等重要物理事实。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/natural-condensation.png
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:natural-condensation"

\end_inset

通过自然凝结现象观察到的旋翼桨尖涡
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman1998"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了在不具备自然凝结条件的时候也能对旋翼尾迹进行观察，喷烟法被引入旋翼空气动力学的研究中。1951年，Drees 等
\begin_inset CommandInset citation
LatexCommand cite
key "Drees1951"
literal "false"

\end_inset

利用这种方法开展了旋翼流场的流动显示试验。该试验通过在风洞引入喷烟装置，获得了直升机在悬停、前飞、下降等状态下旋翼附近的流动图像，并重点研究了旋翼处于“涡环状态
 (vortex ring state, VRS)”时的流动图像。
\end_layout

\begin_layout Standard
桨尖涡涡核区与背景流场的空气密度的差别，对折射率等光学特性有显著影响。基于该原理和频闪摄影技术，人们发明了纹影法和阴影法，并将其引入旋翼空气动力学的研究中。19
93年，Bagai & Leishman
\begin_inset CommandInset citation
LatexCommand cite
key "Bagai1993"
literal "false"

\end_inset

利用该方法研究了螺旋桨和旋翼桨尖涡的几何结构，观察到了旋翼尾迹的不稳定（非周期）现象。
\end_layout

\begin_layout Standard
定性试验虽然没有给出描述流场的各物理量的具体数值，但给出了各种飞行状态下的旋翼尾迹结构的物理图像，并初步验证了一些早期旋翼空气动力学理论（如滑流理论）的结论。随
着测量技术的进步，一些定性试验方法后来发展成为定量试验方法，或发展成为定量试验的一个前置环节。
\end_layout

\begin_layout Subsubsection
定量试验
\end_layout

\begin_layout Standard
根据所测量的物理量以及对流场刻画的精细程度，可以将旋翼空气动力学定量试验大致分为两大类。： 
\end_layout

\begin_layout Description
测力试验 主要用于反映气流对旋翼影响的宏观效果。利用六分量天平、扭矩天平等仪器设备，可以对旋翼中心或全机参考点处的三个力分量和三个力矩分量进行测量。由于试验原理
和试验设备都比较简单，所得的试验数据经过简单处理即可应用于结构动力学和飞行动力学分析，因此这类试验至今仍受到许多研究机构的重视。
\end_layout

\begin_layout Description
测速试验 主要用于研究流场的流动细节。根据测量对象的范围，测速试验又可分为单点测量和多点测量两类。早期的单点测量试验主要采用
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "HWA"
description "hot wire anemometer"
literal "true"

\end_inset

“热线测速仪 (hot wire anemometer, HWA)”等介入式测量设备，测速探头本身对流场会造成一定干扰，因此测量结果不能完全反映真实流动情况。这
一弊端后来被
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "LDV"
description "laser doppler velocimetry"
literal "true"

\end_inset

“激光多普勒测速技术 (laser doppler velocimetry, LDV)”技术所克服，但 LDV 仍属于单点测量技术。同属于非介入式测量技术的
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "PIV"
description "particle image velocimetry"
literal "true"

\end_inset

“粒子成像测速 (particle image velocimetry, PIV)”技术，解决了多点同步测量的难题，能够实现对流场（流速）的高分辨率测量，目前已
成为流体力学新发现的重要来源，也是验证数值计算方法的重要依据。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
1983 年， Sun & Curtiss
\begin_inset CommandInset citation
LatexCommand cite
key "Sun1983,Sun1989"
literal "false"

\end_inset

 利用 HWA 定量测量了模型旋翼的诱导速度分布，研究了直升机低空低速飞行时地面效应对其气动性能的影响。结果显示：直升机低空低速飞行时，自由来流和地面将使旋翼尾
迹向上卷起，从而显著影响旋翼气动载荷特性；当卷起的尾迹接近桨盘平面并处于旋翼下方时，桨盘前侧诱导速度分布将发生较大幅度的不规则变化，从而引起旋翼气动力和气动力矩
的不规则剧烈变化。
\end_layout

\begin_layout Standard
1996–1998年，Leishman 等
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman1996,Leishman1998a"
literal "false"

\end_inset

利用 LDV 对桨尖涡切向和轴向速度、环量、黏性引起的涡核增大进行了测量，研究了旋翼尾迹的三维速度场；对桨尖涡涡核位置（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:tip-vortex-core"

\end_inset

 所示）进行了测量，研究了悬停状态桨尖涡的非周期现象。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/tip-vortex.jpg
	lyxscale 50
	height 30pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:tip-vortex-core"

\end_inset

利用喷烟法观察到的旋翼桨尖涡
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman1998"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
同一时期，南京航空航天大学的唐正飞、高正等
\begin_inset CommandInset citation
LatexCommand cite
key "Tang1997,Tang1998"
literal "false"

\end_inset

利用三维 LDV 测量了共轴式双旋翼悬停状态的流场；为了对比，他们对单旋翼流场也进行了测量。测量的物理量包括诱导速度沿三个方向（轴向、径向和周向）的分量，得到了
两副旋翼的尾迹相互交汇、干扰的流动图像。
\end_layout

\begin_layout Standard
2007年，北京航空航天大学的邓彦敏等
\begin_inset CommandInset citation
LatexCommand cite
key "Yu2007,Ma2012"
literal "false"

\end_inset

利用二维 PIV 技术，在水洞中对共轴式双旋翼悬停及不同前飞速度下的流场进行了测量，并对上下两副旋翼的气动干扰特性作了定量研究。该试验测量了流场的瞬时涡量和速度
分布、桨尖涡结构和脱落轨迹、尾迹边界等。结果显示：共轴双旋翼悬停流场由上旋翼所主导；与单旋翼相比，双旋翼的尾迹结构更加不稳定。
\end_layout

\begin_layout Standard
以上定量试验结果，为旋翼气动设计提供了重要参考信息，也为验证分析模型和计算方法提供了参照对象。
\end_layout

\begin_layout Subsubsection
由试验得出的结论
\end_layout

\begin_layout Standard
试验研究表明，旋翼流场具有以下关键特征
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman2006,Johnson2013"
literal "false"

\end_inset

： 
\end_layout

\begin_layout Description
桨尖涡主导 虽然流体力学界对于“涡 (vortex)”的定义仍存在分歧
\begin_inset CommandInset citation
LatexCommand cite
key "Tong2009"
literal "false"

\end_inset

， 但是无论根据何种定义，从试验事实中总能一致地识别出旋翼桨尖涡的存在。试验观测和数值计算都显示，旋翼高速旋转时，每片桨叶的桨尖和桨根处会各拖出一条集中涡。其中
，桨根涡自生成后会迅速耗散并失去规则的涡结构，而桨尖涡自生成后则能在较长时间内保持强度和涡结构，因而主导着旋翼流场。定量研究进一步表明，桨尖涡的涡核半径很小，涡
核内速度梯度较大，涡核外则接近无旋流动。这一流动特征对试验观测和数值计算在分辨率的空间配置上提出了不同的需求。 
\end_layout

\begin_layout Description
非定常 桨叶的固体表面对于空气流场而言，属于移动的固壁边界。通常，桨叶绕旋翼轴作周期运动时，描述其周围流场的各物理量的也随时间近似按周期变化。即使是悬停状态，虽
然桨叶附近的空气流动接近定常状态，但是远离桨盘的桨尖涡也会因系统不稳定而表现出空间和时间的随机性。因此，非定常性是旋翼流场固有的特征，这决定了与旋翼相关的流动问
题的研究难度往往要高于固定翼所对应的问题。 
\end_layout

\begin_layout Description
动态失速 通过简单的运动学分析可知，直升机处于前飞状态时，后行侧桨叶剖面的迎角大于前行侧，容易发生失速。另一方面，桨叶剖面的迎角随旋翼转动而周期变化，这种迎角的
周期变化会导致翼型气动力出现时滞效应。 这种动态失速现象，使得许多对固定翼行之有效的定常或准定常分析方法对旋翼不再适用。
\end_layout

\begin_layout Description
局部可压缩 直升机旋翼桨尖速度的设计值通常为 0.7–0.9 马赫，属于高亚声速范围，压缩性已较为明显。随着前飞速度增大，在前行侧桨叶桨尖处可能会出现局部跨声速区，
甚至产生激波。桨叶的旋转又使得可压缩区域与低速不可压缩区域之间没有固定的、显著的界线。这一流动特征使得原本在固定翼空气动力学中已经形成的分别适用于不可压缩和可压
缩流动的分析方法，需经过特殊处理才能应用于旋翼空气动力学的研究。 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
上述旋翼流场所固有的流动特征，使得旋翼空气动力学的研究难度明显大于固定翼空气动力学。除此之外，以下在直升机各种常见工作状态中普遍存在的气动干扰现象（如图
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:helicopter-aerodynamic-interference"

\end_inset

 所示）也增加了问题的复杂程度：
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/aero-interaction.jpg
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:helicopter-aerodynamic-interference"

\end_inset

直升机气动干扰示意图
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman1998"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Description
桨-涡干扰 在下降、俯冲、大机动等飞行条件下，或对于桨盘面积有重叠的双旋翼构型，桨尖涡与桨叶之间不可避免地会发生碰撞。桨尖涡经过桨叶时，桨叶表面的压力分布受到强
烈扰动，从而成为旋翼振动和噪声的重要来源。
\end_layout

\begin_layout Description
旋翼-机身干扰 通常，直升机机身处于旋翼的下游区域，对旋翼尾迹起阻挡作用。旋翼拉力、悬停气动效率这些重要的总体性能指标将受到影响。另一方面，桨尖涡以一定频率与机
身发生碰撞，使得机身表明的压力分布受到扰动，从而成为机体振动的重要来源。 
\end_layout

\begin_layout Description
旋翼-固定翼干扰 直升机上除了旋翼以外，一般还有水平尾翼、垂直尾翼等固定翼面，用于增加飞行稳定性，或提供额外的操纵面。当这些固定翼面受到旋翼尾迹扰动时，其上感知
的气动力有别于相应孤立部件在相同自由来流条件下所感知的气动力，从而会影响全机的配平和稳定性。
\end_layout

\begin_layout Description
旋翼-地面干扰 当直升机从地面起飞或贴地低空飞行时，地面的阻挡将改变旋翼尾迹的流向。一般而言，地面效应会使旋翼拉力、悬停气动效率等总体性能指标有所提升；但在地面
存在大量砂石等颗粒物的条件下，地面效应会进一步引发沙盲现象，导致飞行员视线受到遮挡，从而影响飞行安全。 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
以上旋翼流场特有的关键特征和直升机特有的气动干扰现象，始终是旋翼空气动力学研究的关键问题。许多在固定翼空气动力学中得到成功应用的方法，在应用到旋翼空气动力学研究
之前，必须经过适当的改造；旋翼空气动力学本身也产生了一些特有的分析模型和数值计算方法，并且还在不断发展和改进。
\end_layout

\begin_layout Subsection
旋翼空气动力学计算
\end_layout

\begin_layout Subsubsection
入流模型
\end_layout

\begin_layout Standard
入流模型描述的是旋翼尾迹在桨盘平面处的诱导速度与旋翼气动力之间的数量关系。
\end_layout

\begin_layout Standard
滑流理论，又称动量理论，是最早也是最简单的入流模型。该理论基于作用盘模型和动量定理，给出的悬停状态下桨盘平面的诱导速度为
\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1994"
literal "false"

\end_inset

：
\begin_inset Formula 
\begin{equation}
v_{\mathrm{0}}=\sqrt{\frac{C_{T}}{2}}
\end{equation}

\end_inset

其中，
\begin_inset Formula $C_{T}$
\end_inset

 是旋翼拉力系数，
\begin_inset Formula $v_{\mathrm{0}}$
\end_inset

 是无量纲诱导速度。该模型只给出了沿桨盘平面均匀分布的诱导速度场，并且属于静态（准定常）入流模型，所以通常只在初步设计阶段被用来进行旋翼性能估算。此后，各种改进
的静态入流模型不断被提出，桨盘平面诱导速度分布的非均匀性得以体现。
\end_layout

\begin_layout Standard
在此基础上，出现了一阶状态空间方程形式的动态入流模型，以考虑旋翼气动力与入流关系的非定常性，其中最具代表性的是 Pitt–Peters 动态入流模型。在该模型中
，桨盘上任意一点的无量纲诱导速度 
\begin_inset Formula $v$
\end_inset

 可以写为无量纲展向位置 
\begin_inset Formula $r$
\end_inset

 和气流方位角 
\begin_inset Formula $\psi$
\end_inset

 的函数：
\begin_inset Formula 
\begin{equation}
v=v_{0}+v_{\mathrm{c}}r\cos\psi+v_{\mathrm{s}}r\sin\psi,
\end{equation}

\end_inset

其中 
\begin_inset Formula $v_{\mathrm{0}},v_{\mathrm{s}},v_{\mathrm{c}}$
\end_inset

 分别为均匀入流分量、横向入流分量、纵向入流分量。这三个无量纲诱导速度分量和它们的无量纲时间导数，与桨盘的三个无量纲气动力 
\begin_inset Formula $C_{T},C_{L},C_{M}$
\end_inset

 之间的关系，呗写成状态空间形式：
\begin_inset Formula 
\begin{equation}
\left(\underline{M}\,\dv{t}+\underline{L}^{-1}\right)\begin{bmatrix}v_{\mathrm{0}}\\
v_{\mathrm{s}}\\
v_{\mathrm{c}}
\end{bmatrix}=\begin{bmatrix}C_{T}\\
C_{L}\\
C_{M}
\end{bmatrix}
\end{equation}

\end_inset

文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Chen1989"
literal "false"

\end_inset

 对截至 1980 年代末的各种静态、动态入流模型作了详细的综述。
\end_layout

\begin_layout Standard
1989年，He
\begin_inset CommandInset citation
LatexCommand cite
key "He1989,Peters1995"
literal "false"

\end_inset

 基于势流理论，提出了广义动态尾迹模型，又称 Peters–He 有限状态入流模型。该模型将状态变量个数推广到任意多，进一步体现了高阶谐波的影响。值得注意的是，
经典的动量理论模型是 Pitt–Peters 动态入流模型在准静态情况下的特例，Pitt–Peters 动态入流模型又是 Peters–He 有限状态入流模型只
取一阶状态变量时的特例。
\end_layout

\begin_layout Standard
动态入流模型具有形式紧凑、计算效率高的优点，在直升机飞行动力学建模
\begin_inset CommandInset citation
LatexCommand cite
key "Yang1996,Sun2001"
literal "false"

\end_inset

和旋翼气动弹性问题
\begin_inset CommandInset citation
LatexCommand cite
key "Panda1985,Jang1988"
literal "false"

\end_inset

的研究中得到了广泛的应用。
\end_layout

\begin_layout Standard
但是，以上所有入流模型都是从作用盘模型出发，引入尾迹形状规则且无限延伸等理想化假设，最后得到气动力与入流系数的关系。显然，这种简单的物理模型无法真实反映旋翼流场
由桨尖涡主导、局部可压缩等特性，也无法处理存在复杂气动干扰的问题，已经逐步被更接近物理真实的自由尾迹模型取代。
\end_layout

\begin_layout Subsubsection
涡线尾迹模型
\end_layout

\begin_layout Standard
涡线尾迹模型是用于描述旋翼尾迹中涡量空间分布情况的物理模型，在一些文献中也用来指代该物理模型所对应的数值计算方法。该模型的基本思想是用直线或曲线涡元（涡线单元）
对涡量场进行离散，通过研究涡线单元的运动和演化来描述涡量场，属于连续介质力学
\begin_inset CommandInset citation
LatexCommand cite
key "Fung1994"
literal "false"

\end_inset

中的拉格朗日观点（质点系观点）。得到涡量场后，再利用 Biot–Savart 定律对涡量场进行积分，从而得到诱导速度场。从发展历程来看，尾迹模型经历了刚性尾迹，
预定尾迹和自由尾迹三个阶段。
\end_layout

\begin_layout Paragraph
刚性尾迹模型
\end_layout

\begin_layout Standard
刚性尾迹模型假设旋翼尾迹中的涡量集中分布在以桨盘为底面的直圆柱面或斜圆柱面上，或集中分布在从桨尖拖出的螺旋线上。在此模型中，涡系的几何形状只受自由来流和平均入流
的驱动，不因涡系自诱导和互诱导而发生变形，故而得名“刚性尾迹”。
\end_layout

\begin_layout Standard
由于刚性尾迹的几何形状简单，经过一些数学推导，有时可以得出初等函数、特殊函数或级数形式的解。2004 年，北京航空航天大学的陈铭
\begin_inset CommandInset citation
LatexCommand cite
key "Chen2003,Chen2004,Chen2005"
literal "false"

\end_inset

利用刚性尾迹模型，将旋翼用作用盘代替，对共轴双旋翼前飞气动特性进行了研究，得到了解析形式的诱导速度解。
\end_layout

\begin_layout Standard
虽然根据刚性尾迹模型得出的解析形式的解能够快速给出计算结果，但其所假设的尾迹几何结构与实际情况相差较大。尤其是在大机动、贴地飞行等条件下，尾迹畸变严重，刚性尾迹
模型不再适用。目前，刚性尾迹模型只被用于对实时性要求极高的飞行仿真程序，或用于为自由尾迹模型、CFD 求解器提供迭代初值。
\end_layout

\begin_layout Paragraph
预定尾迹模型
\end_layout

\begin_layout Standard
预定尾迹模型在刚性尾迹模型的基础上，根据一些特殊旋翼在特殊状态下的试验结果，引入一些参数对刚性尾迹的几何形状进行修正。1971 年，Landgrebe
\begin_inset CommandInset citation
LatexCommand cite
key "Landgrebe1971"
literal "false"

\end_inset

基于水洞试验，提出了一种半经验的旋翼尾迹模型。 但该模型的适用性严重依赖于根据个别试验确定的经验参数，普适性较差，并没有从根本上解决刚性尾迹模型无法准确描述尾迹
几何结构的问题。
\end_layout

\begin_layout Paragraph
自由尾迹模型
\end_layout

\begin_layout Standard
自由尾迹模型允许涡元像流体微团一样在流场中自由运动。这里的“自由”是指相对于刚性尾迹和预定尾迹，自由尾迹不再对尾迹几何结构进行限制，涡元（流体微团）的运动仍然受
流体力学基本原理支配。该模型所依据的“涡元像流体微团一样在流场中自由运动”是指涡元运动满足如下关系： 
\begin_inset Formula 
\begin{equation}
\frac{\dd\vec{r}}{\dd t}=\vec{u}=\vec{u}_{\mathrm{\infty}}+\vec{u}_{\mathrm{ind}}\label{eq:vortex_element}
\end{equation}

\end_inset

其中，
\begin_inset Formula $\vec{r}$
\end_inset

 是涡元位置，
\begin_inset Formula $\vec{u}_{\mathrm{\infty}}$
\end_inset

 是自由来流速度，
\begin_inset Formula $\vec{u}_{\mathrm{ind}}$
\end_inset

 是旋翼涡系对该点的诱导速度。该诱导速度需根据 Biot–Savart定律
\begin_inset CommandInset citation
LatexCommand cite
key "Anderson_2017"
literal "false"

\end_inset

计算得到。考虑 
\begin_inset Formula $A,B$
\end_inset

 两点之间一段强度为 
\begin_inset Formula $\Gamma$
\end_inset

 的涡线，它对空间任意一点 
\begin_inset Formula $C$
\end_inset

 的诱导速度由以下积分给出：
\begin_inset Formula 
\begin{equation}
\vec{u}_{\mathrm{ind}}^{C}=\int_{A}^{B}\frac{\Gamma}{4\pi}\frac{\dd\vec{l}\times\vec{r}}{r^{3}}
\end{equation}

\end_inset

引入涡线模型离散后，式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:vortex_element"
plural "false"
caps "false"
noprefix "false"

\end_inset

 变为一个高度非线性的常微分方程组。
\end_layout

\begin_layout Standard
式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:vortex_element"

\end_inset

 所表示的“涡元像流体微团一样在流场中自由运动”，实际上是 Kelvin 定理
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
在理想流体中，沿一条封闭物质线的速度环量不随时间变化
\begin_inset CommandInset citation
LatexCommand cite
key "Cottet2000"
literal "false"

\end_inset

。
\end_layout

\end_inset

应用到理想流体时的一个推论，因而自由尾迹模型的成立条件是流体无黏、正压且外力有势。在旋翼尾迹问题中，外力（重力）可以忽略，流体（空气）满足正压条件，但黏性通常不
可忽略，为此需引入黏性涡核模型
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman2006"
literal "false"

\end_inset

进行修正。该模型可进一步分有限涡核模型和涡核演化模型两部分。简单的集中涡线模型存在奇异性，为消除这种奇异性，通常以一个截面半径为有限值的涡管代替截面半径为零的集
中涡线。在有限涡核模型的基础上，令涡核半径随涡龄的增长而变大，以此来体现空气黏性引起的涡量耗散，涡核以外的流体则认为是无黏的。
\end_layout

\begin_layout Standard
最早尝试利用自由尾迹模型对旋翼流场进行建模的有 Scully
\begin_inset CommandInset citation
LatexCommand cite
key "Scully1967,Scully1975"
literal "false"

\end_inset

、Landgrebe
\begin_inset CommandInset citation
LatexCommand cite
key "Landgrebe1969"
literal "false"

\end_inset

等。这些早期的自由尾迹算法普遍存在收敛性差的问题，此后一段时间，许多学者在改善该模型的收敛性方面做了大量工作。
\end_layout

\begin_layout Standard
1983 年，美国普林斯顿大学的 Sun & Curtiss
\begin_inset CommandInset citation
LatexCommand cite
key "Sun1983,Sun1989a"
literal "false"

\end_inset

 建立了一种简化的自由尾迹卷起模型，用以研究旋翼尾迹与地面的相互影响，并在此基础上计算了桨盘平面的诱导速度分布。结果显示：地面和卷起涡显著地改变了旋翼近尾迹的几
何形态，从而造成了桨盘平面诱导速度分布的剧烈变化。
\end_layout

\begin_layout Standard
自 1990 年代起，美国马里兰大学的 Leishman 团队提出和改进了多种自由尾迹算法。1993年，Crouse & Leishman
\begin_inset CommandInset citation
LatexCommand cite
key "Crouse1993"
literal "false"

\end_inset

 提出了一种“预估校正 (predictor–corrector, PC)”格式，用于提高收敛性，控制计算量。该算法采用两点中心差分格式对涡量场进行时间和空间离
散，并通过引入周期条件确保稳态解收敛。但对悬停状态客观存在的非周期解，无法给出正确的计算结果。1995 年，Bagai & Leishman
\begin_inset CommandInset citation
LatexCommand cite
key "Bagai1995,Bagai1995a,Bagai1996"
literal "false"

\end_inset

 提出了一种“伪隐式预估校正 (pseudo-implicit predictor–corrector, PIPC)”格式，用于求解存在稳态周期解的旋翼尾迹问题
。该算法采用五点中心差分格式对涡量场进行时间和空间离散，并利用松弛迭代法和周期条件改善解的收敛性。基于该算法，他们计算了单旋翼、双旋翼构型的直升机在悬停、低速前
飞、高速前飞等各种飞行状态中的旋翼尾迹，结果很好地反映了旋翼尾迹的畸变。但该方法用到了周期条件，因而只适用于存在稳态周期解的问题；但也有学者质疑稳态周期解的存在
性
\begin_inset CommandInset citation
LatexCommand cite
key "Kini2002"
literal "false"

\end_inset

。另外，参数分析表明，解的收敛性和尾迹几何结构与部分经验参数的选取有关，使该方法的通用性受到质疑。2000–2004年，Bhagwat & Leishman
\begin_inset CommandInset citation
LatexCommand cite
key "Bhagwat2000,Bhagwat2000a,Leishman2002,Leishman2004"
literal "false"

\end_inset

 提出了一种“时间精确”自由尾迹模型，用于分析旋翼尾迹的动态响应过程。该算法采用“二阶后向差分预估校正 (predictor–corrector
 2nd-backward, PC2B)”格式，提高了算法的数值稳定性。由松弛迭代法（如 Bagai 的 PIPC 格式）给出初始条件后，可以沿时间积分尾迹方程
和桨叶动力学方程，得到旋翼尾迹和桨叶运动的动态响应值。基于该算法，他们计算了多种旋翼构型在不同飞行条件下的尾迹几何形态（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:free-wake"

\end_inset

 所示），研究了旋翼作机动时的尾迹瞬态变化过程，并对涡环状态这一典型的不稳定状态进行了模拟。该模型在以上算例中均给出了很好的结果。2006年，Gupta
 & Leishman
\begin_inset CommandInset citation
LatexCommand cite
key "Gupta2006"
literal "false"

\end_inset

 将上述时间精确自由尾迹模型应用到风力机械的气动性能研究中。同年，Ananthan & Leishman
\begin_inset CommandInset citation
LatexCommand cite
key "Ananthan2006"
literal "false"

\end_inset

 基于时间精确自由尾迹模型，研究了机动飞行状态下的旋翼尾迹几何形态和涡量分布，初步研究了桨涡干扰引起的旋翼噪声。此后，Ribera & Celi
\begin_inset CommandInset citation
LatexCommand cite
key "Ribera2007"
literal "false"

\end_inset

 也利用该模型开展了一些直升机飞行动力学方面的研究。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/free-wake.png
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:free-wake"

\end_inset

利用自由尾迹模型计算得到的纵列式双旋翼尾迹
\begin_inset CommandInset citation
LatexCommand cite
key "Leishman2002"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
本世纪初，美国俄亥俄州立大学的 Conlisk 团队
\begin_inset CommandInset citation
LatexCommand cite
key "Conlisk2001"
literal "false"

\end_inset

也开展了一些自由尾迹模型算法方面的研究。2000年，Jain & Conlisk
\begin_inset CommandInset citation
LatexCommand cite
key "Jain2000"
literal "false"

\end_inset

 采用升力线理论对桨叶进行建模，采用时间步进自由涡方法对桨尖涡运动进行计算。在做时间步进积分时，他们采用了数值稳定的四阶隐式 Adams–Moulton
 格式。基于上述方法，他们通过数值计算研究了在试验中观察到的两条桨尖涡之间相互缠绕的现象。2002年，Kini & Conlisk
\begin_inset CommandInset citation
LatexCommand cite
key "Kini2002"
literal "false"

\end_inset

 采用与文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Jain2000"
literal "false"

\end_inset

 中类似方法研究了悬停状态桨尖涡几何结构的稳定性。计算结果显示，悬停状态时，桨尖涡几何结构的周期性条件只对前几圈桨叶适用，后几圈的桨尖涡几何结构表现出明显的时间
非周期性。由于采用了数值稳定的隐式 Adams–Moulton 格式，并且在步长小于 
\begin_inset Formula $\ang{4}$
\end_inset

 时可以给出足够精确的结果。此文认为，物理不稳定是导致悬停状态桨尖涡远场尾迹非周期结构的主要原因，而非算法的数值稳定性问题。这与 Leishman
 团队的观点
\begin_inset CommandInset citation
LatexCommand cite
key "Bagai1995,Bagai1995a,Bagai1996"
literal "false"

\end_inset

相反。2006年，Pulla & Conlisk
\begin_inset CommandInset citation
LatexCommand cite
key "Pulla2006"
literal "false"

\end_inset

 基于时间步进自由尾迹方法研究了地面效应影响下的直升机气动特性。其中，旋翼尾迹通过自由涡方法进行建模，桨叶气动力由升力面理论给出，地面则采用镜像法进行处理。时间
步进算法采用与文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Jain2000,Kini2002"
literal "false"

\end_inset

 中类似的 Adams–Moulton 格式。计算结果与佐治亚理工的试验数据进行了对比，验证了算法的可行性。
\end_layout

\begin_layout Standard
在国内，自由尾迹模型也有相应的发展和应用。2007 年，南京航空航天大学的李春华、徐国华等
\begin_inset CommandInset citation
LatexCommand cite
key "Li2007"
literal "false"

\end_inset

基于时间精确自由尾迹模型，研究了倾转旋翼的气动特性；2010 年，该校的李攀、陈仁良等
\begin_inset CommandInset citation
LatexCommand cite
key "Li2010"
literal "false"

\end_inset

 基于时间精确自由尾迹模型，提出了一种新的差分格式，建立了一种高置信度的直升机飞行动力学模型。2014 年，北京航空航天大学的陈铭等
\begin_inset CommandInset citation
LatexCommand cite
key "Wang2014"
literal "false"

\end_inset

基于稳态自由尾迹模型，研究了旋翼几何参数对共轴双旋翼悬停性能的影响；2015 年，该校的曹义华等
\begin_inset CommandInset citation
LatexCommand cite
key "Lv2015"
literal "false"

\end_inset

采用自由尾迹模型和面元法，分别对旋翼和机身进行建模，建立了一种旋翼–机身气动干扰模型，并进行了配平计算。
\end_layout

\begin_layout Standard
尽管自由尾迹模型仍然是目前直升机工程界普遍认可的旋翼空气动力学分析手段，但该模型本身也存在一定的局限性。首先，自由尾迹模型必须与其他模型（如升力面模型）配合，才
能获得桨尖涡环量的初始值。其次，目前常用的涡核模型都存在若干经验参数，并且桨尖涡的截断位置也需要人工设置。另外，这种物理模型虽然能够大体上还原桨尖涡的几何结构，
但在处理桨尖涡与固体壁面碰撞等问题时，只能采取回避或镜像处理的方法，无法描述涡结构破碎等现象。
\end_layout

\begin_layout Subsubsection
黏性涡粒子模型
\begin_inset CommandInset label
LatexCommand label
name "sec:Viscous-Vortex-Particle-Method"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "VPM"
description "vortex particle model; vortex particle method"
literal "true"

\end_inset

“黏性涡粒子模型 (vortex particle model, VPM)”与自由尾迹模型类似，也属于基于拉格朗日观点的分析模型。不同的是该模型用涡粒子代替了涡
线，每个涡粒子由位置 
\begin_inset Formula $\vec{r}$
\end_inset

 和涡量 
\begin_inset Formula $\vec{\omega}$
\end_inset

 两个矢量来描述。其中，涡元位置的变化规律与自由尾迹模型一样，由如下简单的运动学关系描述：
\begin_inset Formula 
\begin{equation}
\frac{\dd\vec{r}}{\dd t}=\vec{u},
\end{equation}

\end_inset

而涡量的变化规律则由涡量输运方程给出。旋翼尾迹流场属于低亚声速流动，通常可以对空气采用各项同性、不可压缩、正压等理想化假设。基于这些假设，可以将
 Navier–Stokes 方程（详见 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Navier-Stokes-Equation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 小节）简化为： 
\begin_inset Formula 
\begin{equation}
\frac{\partial\vec{u}}{\partial t}+\left(\vec{u}\cdot\nabla\right)\vec{u}=-\frac{1}{\rho}\nabla p+\nu\nabla^{2}\vec{u}+\vec{f}
\end{equation}

\end_inset

利用矢量分析公式
\begin_inset CommandInset citation
LatexCommand cite
key "Zorich2004"
literal "false"

\end_inset

、涡量定义
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Formula $\vec{\omega}=\nabla\times\vec{u}$
\end_inset


\end_layout

\end_inset

、不可压
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Formula $\nabla\cdot\vec{u}=0$
\end_inset


\end_layout

\end_inset

、正压
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Formula $\nabla\rho\times\nabla p=\vec{0}$
\end_inset


\end_layout

\end_inset

、体积力有势
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Formula $\vec{f}=-\nabla V$
\end_inset


\end_layout

\end_inset

等条件，可将上式改写成涡量形式： 
\begin_inset Formula 
\begin{equation}
\frac{\partial\vec{\omega}}{\partial t}+\left(\vec{u}\cdot\nabla\right)\vec{\omega}=\vec{\omega}\cdot\nabla\vec{u}+\nu\nabla^{2}\vec{\omega}\label{Vorticity-Transport-Equation}
\end{equation}

\end_inset

该式左端为涡元涡量的物质导数，右端第一项表示涡元变形（拉伸、弯曲）的影响，右端第二项表示黏性引起的涡量扩散。 此即不可压缩、正压流体的涡量输运方程。
\end_layout

\begin_layout Standard
2009年，He 等
\begin_inset CommandInset citation
LatexCommand cite
key "He2009"
literal "false"

\end_inset

利用 VPM 研究了旋翼尾迹中涡量的输运和扩散现象。该方法避免了基于欧拉观点的数值离散方法所引入的数值耗散。计算结果显示：VPM 可以精确模拟旋翼尾迹在悬停、前
飞等状态下的动态变化；不借助经验参数，很好地捕捉到了尾迹收缩、桨尖涡卷起、涡量扩散等物理现象；尾迹对总距突增操纵的动态响应计算结果与试验吻合很好。此文中的旋翼尾
迹初始涡量由升力线模型获得。此文指出了用 CFD 替代该模型的可能性，但没有进一步给出具体实施方法和计算结果。
\end_layout

\begin_layout Standard
2012年，南京航空航天大学的魏鹏、徐国华等
\begin_inset CommandInset citation
LatexCommand cite
key "Wei2012,Wei2012a"
literal "false"

\end_inset

基于VPM建立了一种适用于旋翼非定常流场特性分析的数值方法。桨叶附着涡以及新生涡环量由升力面模型
\begin_inset CommandInset citation
LatexCommand cite
key "Weissinger1947"
literal "false"

\end_inset

给出。计算结果显示：该方法与自由尾迹模型和CFD相比，能够在兼顾效率的同时，更好地捕捉旋翼尾迹运动（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:vortex-particle"

\end_inset

 所示）。但升力面模型只适用于势流，并不能很好反映动态失速、桨尖激波等现象。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/vortex-particle.png
	lyxscale 50
	height 26theight%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:vortex-particle"

\end_inset

利用黏性涡方法计算得到的涡元分布
\begin_inset CommandInset citation
LatexCommand cite
key "Wei2012"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
2014年，清华大学的王浩文等
\begin_inset CommandInset citation
LatexCommand cite
key "Tan2014"
literal "false"

\end_inset

采用非定常面元法、VPM 及涡量镜面法，建立了旋翼–平尾非定常气动干扰分析模型。计算结果显示，此方法计算精度高于时间精确自由尾迹，计算效率高于
 CFD。但面元法只适用于势流，并不能真实反映桨叶表面的分离、压缩性等流动现象。
\end_layout

\begin_layout Standard
从上述研究内容来看，VPM 本身可以比较高效（与 CFD 相比）且精确（与自由尾迹相比）地捕捉旋翼尾迹中的典型流动现象；但在处理桨叶、机身、固定翼面等壁面时，需
引入其他模型作为补充。除上面提到的只适用于势流的升力线模型、升力面模型、面元法外，也有研究人员尝试采用 CFD 对近壁面进行处理。
\end_layout

\begin_layout Subsubsection
涡量输运方程
\begin_inset CommandInset label
LatexCommand label
name "sec:Vorticity-Transport-Model"

\end_inset


\end_layout

\begin_layout Standard
该方法基于欧拉观点（场观点），直接对涡量输运方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "Vorticity-Transport-Equation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 进行数值求解。从离散方法的角度看，该方法属于有限体积法，但描述流场的变量为涡量。由于采用了涡量形式的问题表述形式，该方法能够有效地减小数值耗散引起的涡量非物理
扩散。涡量输运方法的主要弊端是难以处理壁面边界条件，无法考虑空气压缩性，因而必须引入其他方法（升力线、升力面、CFD 等）作为补充。
\end_layout

\begin_layout Standard
2000年，Brown
\begin_inset CommandInset citation
LatexCommand cite
key "Brown2000"
literal "false"

\end_inset

 通过求解涡量输运方程，计算了孤立旋翼和共轴双旋翼周围的非定常气动环境，并与试验数据进行了对比验证。由于涡量输运方程不能直接处理壁面边界条件，此文利用升力线方法
给出尾迹初始涡量。
\end_layout

\begin_layout Standard
2003年，Houston & Brown
\begin_inset CommandInset citation
LatexCommand cite
key "Brown2000a,Houston2003"
literal "false"

\end_inset

 采用有限状态入流模型与涡量输运模型两种方法，研究了直升机配平、自转下滑状等飞行力学问题。计算结果表明，当自转下滑率较小时，两种模型给出的计算结果差别不大；随着
下滑角的增大，两者的差别变得明显。同年，Whitehouse & Brown
\begin_inset CommandInset citation
LatexCommand cite
key "Whitehouse2003"
literal "false"

\end_inset

 将涡量输运方法应用到大型固定翼飞机尾涡与直升机尾迹气动干扰问题的研究中。计算结果显示，直升机高速飞行时，飞机尾涡不会对其造成严重影响；但在低速飞行时，飞机尾涡
会引起旋翼气动载荷和气弹响应的振荡，从而增加飞行员操纵的难度。
\end_layout

\begin_layout Standard
2005年，Brown & Line
\begin_inset CommandInset citation
LatexCommand cite
key "Brown2005"
literal "false"

\end_inset

 对涡量输运方法进行了改进，使其计算效率得到提高，计算结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VTM"

\end_inset

 所示。新算法引入了一种半拉格朗日自适应网格系统，在尽可能避免产生额外计算量的前提下，显著提高了计算结果的空间分辨率。同时，该网格系统避免了在处理计算区域边界附
近尾迹截断时需借助数值边界条件的问题。对于壁面边界条件，此文仍借助升力线模型进行处理。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/vtm.jpg
	lyxscale 20
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:VTM"

\end_inset

由涡量输运方法计算得到的涡量分布
\begin_inset CommandInset citation
LatexCommand cite
key "Brown2005"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Navier–Stokes 方程
\begin_inset CommandInset label
LatexCommand label
name "sec:Navier-Stokes-Equation"

\end_inset


\end_layout

\begin_layout Standard
Navier–Stokes 方程
\begin_inset CommandInset citation
LatexCommand cite
key "Landau_1987"
literal "false"

\end_inset

是连续介质假设下，描述流体运动最精确的物理模型。对此方程的数值求解，构成了 CFD 研究的主流，所涉及的文献浩如烟海，这里只介绍其中与旋翼相关的部分研究内容。
\end_layout

\begin_layout Standard
早期的旋翼 CFD 研究完全不考虑空气黏性的影响，因此实际上是在求解 Navier–Stokes 方程的简化版本 —— Euler 方程。1985年，Rober
ts 等
\begin_inset CommandInset citation
LatexCommand cite
key "Roberts1985"
literal "false"

\end_inset

将旋翼流场分为两部分：远离桨叶的部分通过自由尾迹模型给出涡量分布，并计算出响应的诱导速度；靠近桨叶的部分由三维欧拉方程进行描述，利用有限体积法进行求解。基于这种
耦合算法，他们研究了孤立机翼和悬停状态的旋翼桨叶附近的流场。1999 年，北京航空航天大学的曹义华等
\begin_inset CommandInset citation
LatexCommand cite
key "Cao1998,Cao1999"
literal "false"

\end_inset

也开展了类似的工作。由于没有考虑空气黏性，这种计算模型并不能用于分析旋翼气动效率。
\end_layout

\begin_layout Standard
1997 年，北京航空航天大学的康宁、孙茂
\begin_inset CommandInset citation
LatexCommand cite
key "Kang1997"
literal "false"

\end_inset

 基于三维定常不可压缩 Navier–Stokes 方程，研究了旋翼受地面效应影响的流动情况。 该方法以时间平均动量源模型
\begin_inset CommandInset citation
LatexCommand cite
key "Rajagopalan1991,Rajagopalan1991a"
literal "false"

\end_inset

来体现旋翼对流场的扰动，计算并分析了尾迹畸变、地面涡的形成、桨盘平面诱导速度分布、不同旋翼离地高度及前进比下的地面效应。通过将计算得到的流动图像和旋翼诱导速度与
试验值进行对比，验证了算法的适用性。2000 年，他们又将该方法用于分析共轴式和纵列式两种双旋翼构型的地面效应问题研究中
\begin_inset CommandInset citation
LatexCommand cite
key "Kang2000"
literal "false"

\end_inset

。该方法对于远离桨叶的流场能够以较小的计算量给出合理的计算结果，但对桨叶表面的流动情况无法给出详细的信息。
\end_layout

\begin_layout Standard
2007年，Whitehouse 等
\begin_inset CommandInset citation
LatexCommand cite
key "Whitehouse2007"
literal "false"

\end_inset

将涡量输运方程与 Navier–Stokes 方程相结合，建立了一种更加接近物理真实的旋翼空气动力学分析模型。该模型采用基于原始变量（速度、压力）的
 Navier–Stokes 方程对桨叶附近的流动情况进行描述，可以体现这一区域存在的空气黏性、压缩性等势流模型无法很好处理的流动特性；对涡流主导的尾迹部分则采
用基于欧拉观点的涡量输运方程进行描述，可以有效降低常规 CFD 造成的涡量非物理扩散。利用该耦合模型，他们给出了一些固定翼、钝体、直升机上的算例，在流动特性捕捉
和非定常载荷计算方面都给出了较好的结果。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/whitehouse.png
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
涡量输运方程与 Navier–Stokes 方程耦合模型示意图
\begin_inset CommandInset citation
LatexCommand cite
key "Whitehouse2007"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
2008年，Anusonti-Inthra 等
\begin_inset CommandInset citation
LatexCommand cite
key "Anusonti-Inthra2008"
literal "false"

\end_inset

将 RANS (Reynolds-averaged Navier–Stokes) 方程
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "RANS"
description "Reynolds-averaged Navier–Stokes"
literal "true"

\end_inset

与基于粒子的涡量输运方法进行耦合，用于分析固定孤立机翼低速飞行时的气动性能和尾迹特性，并通过与风动试验数据进行对比，对该计算模型进行了验证。该耦合方法将流场按主
要流动特性，分为近壁面和远场区域，分别用三维可压缩 RANS 方程和基于粒子的涡量输运方程进行求解。计算结果显示：该耦合方法可以对机翼翼梢的三维流动效应进行合理
的模拟，并且有效解决了常规 CFD 存在的数值耗散问题。但也有学者认为，耦合方法本身及不同计算区域数据交换带来的复杂性，可能会减弱涡粒子模型对计算效率的提升效果
\begin_inset CommandInset citation
LatexCommand cite
key "Kamkar2011"
literal "false"

\end_inset

。
\end_layout

\begin_layout Subsubsection
网格自适应加密技术
\end_layout

\begin_layout Standard
对于任何基于离散网格的数值方法而言，加密网格都是提高计算精度的一个重要途径。但是有限的计算资源不允许我们在整个计算区域内无差别地对网格进行加密，而只能有选择地在
某些物理量随空间或时间变化剧烈的地方进行加密。另外，加密网格的过程应当尽可能减少对人工操作的需求，且便于逐次递推，这样才能达到充分利用现有计算资源以获得尽可能高
的精度的目的。根据上一步基于粗糙网格的计算结果，由计算机自主确定下一步需要对网格进行加密的区域，并通过递推逐次实现网格的精细化，充分利用计算机软硬件资源，以获得
尽可能高的计算精度，这就是“自适应网格加密 (adaptive mesh refinement, AMR)”
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "AMR"
description "adaptive mesh refinement"
literal "true"

\end_inset

技术的主要思想。这是解决由涡流主导的旋翼尾迹数值计算问题的关键技术，也是多年以来 CFD 领域的研究热点。
\end_layout

\begin_layout Standard
2011年，美国斯坦福大学的 Kamkar & Jameson
\begin_inset CommandInset citation
LatexCommand cite
key "Kamkar2011,Sankaran2011"
literal "false"

\end_inset

 提出了一种适用于涡主导流动问题的自适应网格加密方法。该方法将网格细化过程分为两步：先利用特征检测方法自动识别需要加密网格的区域，再利用基于 Richardso
n 外插方法的误差估计，给出合适的网格精细程度（分辨率）。此文所用计算网格为“对偶网格 (dual-mesh)”：靠近物体表面用非结构网格处理复杂的几何外形及边
界层，远离物体表面的区域用自适应结构网格和高阶格式处理涡流尾迹。结果表明，该方法能够同时提高直升机性能分析精度和尾迹分辨率（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:AMR"

\end_inset

 所示）。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/adaptive.jpg
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:AMR"

\end_inset

网格自适应加密对涡量分布计算结果的改善
\begin_inset CommandInset citation
LatexCommand cite
key "Sankaran2011"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Subsubsection
无网格法
\end_layout

\begin_layout Plain Layout
近些年，网格生成技术的发展已落后于数值算法和计算机硬件的发展，日益成为制约计算流体动力学发展和工程应用的瓶颈。 目前，许多网格生成技术的自动化水平较低，网格质量
过度依赖研究者的操作经验，并且生成网格需要耗费大量人工劳动时间； 而已有的自动化网格生成方法在处理复杂几何外形时，计算效果并不理想。 解决网格生成问题的一种方案
是采用无网格法。
\end_layout

\begin_layout Plain Layout
美国工程院院士Atluri教授
\begin_inset CommandInset citation
LatexCommand cite
key "Atluri1998"
literal "false"

\end_inset

 提出了一种基于局部弱形式的无网格法（Meshless Local Petrov-Galerkin method, MLPG）。 该方法在进行插值和积分时，不再
像传统方法（有限差分法、有限元法、边界元法等）那样依赖不重叠的连续网格，因而是一种真正的无网格法。 该方法已经在固体力学、结构力学、拓扑优化等领域获得了成功应用
。
\end_layout

\begin_layout Plain Layout
美国加州大学洛杉矶分校
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
University of California, Los Angeles
\end_layout

\end_inset

的林洪昌
\begin_inset CommandInset citation
LatexCommand cite
key "Lin2000"
literal "false"

\end_inset

 首次将该方法应用到对流扩散输运问题和不可压缩流动问题的分析中。 在求解高
\begin_inset Formula $Re$
\end_inset

的对流扩散问题时，此文将迎风格式（Upwind scheme）引入到MLPG方法中，解决了解的非物理振荡问题。 在求解不可压缩Navier–Stokes方程时，
此文也将迎风格式与MLPG方法相结合，得到了很好的结果。 但此文中的算例比较简单，都是一维、二维问题，对于更加复杂、工程实践中更有意义的三维问题，作者只给出了对
于该方法应用前景的乐观预期。 尽管如此，MLPG方法的确解决了网格生成困难这一计算力学领域日益突出的问题，因而有希望在今后得到更广泛的应用。
\end_layout

\begin_layout Plain Layout
美国斯坦福大学的Katz和Jameson
\begin_inset CommandInset citation
LatexCommand cite
key "Katz2009"
literal "false"

\end_inset

 提出了一种适用于计算流体动力学的无网格法，并与传统的基于网格的有限体积法进行了对比。 对于二维跨声速、超声速、黏性流动问题（翼型绕流问题），此文提出的无网格算
法在计算精度和效率上与大多数有限体积法相当。 此外，把无网格法应用到重叠网格的无缝连接中，计算结果好于传统的在不同网格之间进行插值的处理方法。
 然而， 这里所用的无网格法仍然属于非守恒的算法，因而不能取代基于网格的传统方法。 此文也没有提出具体的计算点生成方法，因而并没有解决传统方法中网格生成难的问题
。 Katz认为，无网格法并不会取代传统方法，而只会作为传统的方法在处理一些问题时的补充手段，例如重叠网格的无缝连接问题。 此文只用无网格法求解了二维问题，将其
推广到三维问题是该方法未来的发展方向之一。
\end_layout

\begin_layout Plain Layout
伊朗阿米尔卡比尔理工大学
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Amirkabir University of Technology
\end_layout

\end_inset

的Sattarzadeh等（2012）
\begin_inset CommandInset citation
LatexCommand cite
key "Sattarzadeh2012"
literal "false"

\end_inset

 提出了一种隐式无网格法，将其用于求解具有复杂几何边界的三维可压缩流动问题，给出了三维机翼、直升机机身绕流等算例，证实了无网格法在流体工程问题分析中的应用潜力。
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/meshless.jpg
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
由无网格法计算得到的直升机机身表面压力分布
\begin_inset CommandInset citation
LatexCommand cite
key "Sattarzadeh2012"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
其他方法
\end_layout

\begin_layout Plain Layout
美国斯坦福大学的Jameson教授和Butsuntorn、Allaneau等，在计算流体动力学新方法领域所开展的一些研究，直接或间接地为旋翼空气动力学研究提供了
新的工具。
\end_layout

\begin_layout Plain Layout
Butsuntorn和Jameson
\begin_inset CommandInset citation
LatexCommand cite
key "Butsuntorn2008"
literal "false"

\end_inset

 采用时间谱方法（Time Spectral method）和涡量约束方法（Vorticity Confinement method）研究了旋翼飞行器的流动问题
。 时间谱方法在满足工程问题所需精度要求的前提下，显著减少了计算时间，其计算效率大约比传统方法（隐式时间积分格式）提高了10倍。 但是，这种时间谱方法利用了旋翼
流场周期变化的特点，因而不适用于机动飞行等非周期工况。 对于结果中含有高频成分的问题，所需计算量将显著增加，从而失去该方法计算效率高的优势。 涡量约束方法较好地
模拟了旋翼流场中普遍存在的亚声速和跨声速流动现象。 该方法不需采用传统的网格加密技术，就能使涡结构在较长距离内保持存在。 但是，这种涡量约束方法并没有严格的数学
基础。 约束参数的选取与计算精度和稳定性密切相关，但还没有标准的取值方法。 因此，涡量约束方法目前还不是一种成熟的流体动力学计算方法。 另外，此文只研究了刚性、
无扭、矩形桨叶在总距和周期变距为常值时孤立旋翼的流动问题，没有考虑桨毂连接形式，也没有考虑机身、尾桨存在时的气动干扰问题。
\end_layout

\begin_layout Plain Layout
Allaneau和Jameson
\begin_inset CommandInset citation
LatexCommand cite
key "Allaneau2012"
literal "false"

\end_inset

 提出了一种动能守恒非连续Galerkin格式（Kinetic Energy Preserving Discontinous Galerkin
 scheme, DG-KEP），用于求解Euler方程和低雷诺数的黏性流动问题。 该方法能够保证全局动能守恒，一定程度上解决了数值离散引起的非物理耗散问题，并
且大大提高了算法的稳定性。 该方法能够比较真实地模拟机翼尾流的复杂涡结构，从而有助于精确地计算升力和阻力。 在特定情况下，DG-KEP格式成为动能守恒有限体积格
式（Kinetic Energy Preserving Finite Volume scheme, FV-KEP）。 这是一种特殊的中心格式，比常规的通量平均中
心格式更加稳定，且不需引入人工耗散。 对于黏性流动问题，适当选取网格雷诺数几乎可以完全消除数值解的非物理振荡，并且计算成本远低于引入人工耗散的常规中心格式。
 在二维激波管算例中，该格式成功捕捉了激波和声波，验证了算法的有效性。 在此基础上，研究了激波与涡的相互干扰，对非定常运动的二维翼型进行了直接数值模拟，对三维可
变形机翼也进行了流固耦合分析。 该算法在这些简单算例中所表现出了低数值耗散的特点，有助于解决传统CFD方法在计算桨尖涡时存在非物理耗散的弊端，但目前还没有被直接
应用到直升机或旋翼空气动力学的研究中。
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
舰载直升机气动干扰试验
\end_layout

\begin_layout Standard
2003 年，Derby & Yamauchi
\begin_inset CommandInset citation
LatexCommand cite
key "Derby2003"
literal "false"

\end_inset

 搭建了一套用于研究直升机与两栖攻击舰气动干扰问题的 
\begin_inset Formula $1/48$
\end_inset

 缩比模型。该模型还被用于研究直升机与大型建筑物以及地面的气动干扰问题。此项目对倾转旋翼机、纵列式直升机、单主旋翼直升机三种构型都进行了缩比模型试验，获得的结果
可用于指导全尺寸直升机舰上操纵以及编队飞行的研究。
\end_layout

\begin_layout Standard
2007 年，Lamar 等
\begin_inset CommandInset citation
LatexCommand cite
key "Lamar2004,Lamar2007"
literal "false"

\end_inset

通过试验研究了利用柱状涡流发生器对船体空气尾流进行修改（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:CVG"

\end_inset

 所示）的可行性。他们希望该技术能够应用于改善舰载机（包括直升机）的起降环境。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/modifying.png
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:CVG"

\end_inset

利用柱状涡流发生器改善舰载直升机起降环境
\begin_inset CommandInset citation
LatexCommand cite
key "Lamar2004"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
2011 年，Herry & Vorst
\begin_inset CommandInset citation
LatexCommand cite
key "Herry2011"
literal "false"

\end_inset

 利用 PIV 与激光断层扫描显示技术，在 ONERA 的 L2 风洞中测量了 
\begin_inset Formula $1/60$
\end_inset

 简单外形军舰缩比模型和 
\begin_inset Formula $1/100$
\end_inset

 真实外形军舰缩比模型两种船体的空气尾流。
\end_layout

\begin_layout Standard
2012 年，Kääriä 等
\begin_inset CommandInset citation
LatexCommand cite
key "Kaeaeriae2012"
literal "false"

\end_inset

通过开展水洞试验，研究了直升机在船体空气尾流中的气动载荷特征。该试验是在一架 
\begin_inset Formula $1/54$
\end_inset

 的直升机缩比模型与一艘虽经简化但仍具有机库和飞行甲板的护卫舰模型上进行的，旋翼桨叶被简化为刚性连接到桨毂，气动载荷通过安装在机身内的六分量天平来测量。试验在船
头正面迎风与 
\begin_inset Formula $\ang{45}$
\end_inset

 侧面迎风两种来流条件下，沿直升机着舰飞行路径选取了若干观测点，测量了直升机在这几个点上的非定常气动载荷。试验结果表明，当船头正面迎风时，甲板上方存在一个拉力不
足区域，迫使驾驶员增大总距以保持高度；而在 
\begin_inset Formula $\ang{45}$
\end_inset

 侧风条件下，甲板上方存在一堵压力墙，迫使驾驶员减小总距以降低高度、增大横向周期变距以保持飞行路径。他们认为上述现象是由船体空气尾流的速度梯度引起的，并通过对船
体空气尾流进行非定常 CFD 计算验证了此观点。尽管该试验是在固定直升机的条件下进行的，仍不能完全反映直升机着舰过程的真实载荷特征，但可作为验证计算模型的参照对
象。的条件下进行的，但已将试验环境从室内转移到了真实的船只上，因而更接近舰载直升机的真实工作环境。
\end_layout

\begin_layout Standard
2015 年，Friedman 等
\begin_inset CommandInset citation
LatexCommand cite
key "Friedman2015"
literal "false"

\end_inset

利用固定在（长 
\begin_inset Formula $\SI{32.9}{m}$
\end_inset

）真实船只尾部甲板上方的模型直升机（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:real_ship"

\end_inset

 所示），研究了船体空气尾流与直升机旋翼尾迹的相互影响。通过安置在旋翼周围的风速计，测量了试验船静止、无侧风航行、侧风航行等条件下的流场信息。尽管该试验是在固定
直升机的条件下进行的，但已将试验环境从室内转移到了真实的船只上，因而更接近舰载直升机的真实工作环境。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/pvc/code/manuscript/review/figures/ship-helicopter-interaction.jpg
	lyxscale 15
	width 100text%
	height 30theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:real_ship"

\end_inset

固定在真实船只尾部甲板上方的模型直升机
\begin_inset CommandInset citation
LatexCommand cite
key "Friedman2015"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
舰载直升机气动干扰计算
\end_layout

\begin_layout Standard
1995 年，Landsberg 等
\begin_inset CommandInset citation
LatexCommand cite
key "Landsberg1995"
literal "false"

\end_inset

利用 FAST3D 非定常流动求解器，分析了船体空气尾流与旋翼入流的相互作用。该求解器采用的是通量修正输运及虚拟单元嵌入方法。旋翼对流场的影响是通过一个简化的桨
盘模型来体现的，该模型中动量源沿桨盘均匀分布，因此只能反映旋翼整体的气动特性，而不能精细到每片桨叶。虽然计算模型较为简单，但计算结果仍能反映船体空气尾流中的非定
常性对旋翼入流的影响。
\end_layout

\begin_layout Standard
2008 年，He 等
\begin_inset CommandInset citation
LatexCommand cite
key "He2008"
literal "false"

\end_inset

介绍了介绍了其所属公司在建立高置信度舰载直升机飞行仿真环境方面所做的工作。该仿真系统集成了直升机动力学、船体动力学以及非定常船体空气尾流方面的建模方法，为舰载直
升机飞行训练和测试提供了一种高效的模拟工具。该仿真系统提供了三种不同精细程度的仿真模型：(1) 旋翼尾迹由有限状态入流模型描述，船体空气尾流由平板模型描述；(2
) 旋翼尾迹由有限状态入流模型描述，船体空气尾流由 CFD 或试验数据描述；(3) 旋翼尾迹和船体空气尾流由VPM描述。其中，前两种模型可用于实时仿真计算。此后
，该公司的 Zhao 等
\begin_inset CommandInset citation
LatexCommand cite
key "Zhao2013"
literal "false"

\end_inset

将 VPM 与基于非结构网格的 CFD 求解器相结合，研究了旋翼尾迹与船体空气尾流的相互作用。基于此混合方法的计算结果，他们推广了 Peters–He
 有限状态入流模型，使其适用于实时仿真。
\end_layout

\begin_layout Standard
2013 年，Muijden 等
\begin_inset CommandInset citation
LatexCommand cite
key "Muijden2013"
literal "false"

\end_inset

基于结构网格，用 RANS 方程与 RANS/大涡模拟 (large eddy simulation, LES
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "LES"
description "large eddy simulation"
literal "true"

\end_inset

) 混合方法两种物理模型，分析了船体空气尾流（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:structured-mesh"

\end_inset

 所示），并与试验数据进行了比较。结果表明：RANS 方程的计算结果很好地反映了船体空气尾流的时间平均特征，而 RANS/LES 混合方法则进一步给出了更加接近
物理真实的流场波动特征。上述计算结果已被用到直升机飞行模拟器中，并且得到了经验丰富的飞行员给出的积极评价。但只计算了船体空气尾流，并没有将直升机（特别是旋翼）包
括在计算模型中，因此没有体现船体空气尾流与旋翼尾迹的耦合效应。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/RANS-LES_merged.png
	lyxscale 15
	width 100text%
	height 50theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:structured-mesh"

\end_inset

用于计算船体空气尾流的结构网格（上）及 RANS（左）与 RANS/LES（右）计算结果对比
\begin_inset CommandInset citation
LatexCommand cite
key "Muijden2013"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
2014 年，Crozon 等
\begin_inset CommandInset citation
LatexCommand cite
key "Crozon2014"
literal "false"

\end_inset

基于结构网格，利用作用盘方法对旋翼在船体影响下的入流特征进行了静态计算。作用盘方法的结果表明，当旋翼接近船体时，其入流会受到船体的显著影响，这种影响是非线性的，
因而叠加法不再适用。为突破作用盘方法只能描述旋翼整体入流特征的限制，此文通过在滑动结构网格（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sliding-mesh"

\end_inset

 所示）上求解非定常 RANS 方程获得了每片桨叶的流场信息。通过该方法得到的旋翼拉力的计算结果与试验结果吻合较好，验证了方法的有效性。他们希望此文的计算方法有
助于确定直升机着舰过程的安全飞行包线，但并没有给出具体的结论。就算例而言，此文只研究了孤立旋翼与船体的气动干扰，没有考虑机身对气流的影响。
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../review/figures/structured_sliding_mesh.jpg
	lyxscale 50
	width 100text%
	height 30theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:sliding-mesh"

\end_inset

用于计算旋翼–船体非定常气动干扰的滑动结构网格
\begin_inset CommandInset citation
LatexCommand cite
key "Crozon2014"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
2017 年，南京航空航天大学的史勇杰等
\begin_inset CommandInset citation
LatexCommand citet
key "Shi_2017"
literal "false"

\end_inset

利用重叠网格技术（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overset-mesh"

\end_inset

 所示），研究了孤立旋翼与多种船体构型之间的气动干扰问题。他们用静态结构网格离散船体周围的空间，作为背景网格；用 C-O 或 C-H 型结构网格包裹桨叶，作为贴
体网格。贴体网格被允许在背景网格中做任意运动，以模拟桨叶的旋转、挥舞、边距。两套网格上的数据通过三维线性插值进行交换。该方法在进行挖洞和贡献单元搜索时，利用了结
构网格易于定位单元的性质，所需时间与流场计算时间相比可忽略不计。这种对结构网格的依赖，限制了该方法的适用范围。
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/overset_mesh.jpeg
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:overset-mesh"

\end_inset

用于计算旋翼–船体非定常气动干扰的重叠结构网格
\begin_inset CommandInset citation
LatexCommand citet
key "Shi_2017"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
受气动干扰影响的工程问题
\end_layout

\begin_layout Standard
在舰载直升机的实际工程应用中，人们通常更关注其飞行安全性与驾乘舒适度，这就需要从结构动力学、飞行动力学、导航与飞控等学科的视角对舰载直升机开展研究。这些学科或多
或少都需要以气动载荷作为输入，因此可以被视为舰载直升机空气动力学的下游学科。最理想情况当然是将基于 PIV 或 CFD 的精细空气动力学模型植入到结构动力学、飞
行动力学模型中。然而现实情况却是上下游学科的研究存在明显脱节，工程领域往往还在使用陈旧且粗糙的气动模型，有些学科甚至直接将气动力作为黑箱或随机过程处理。这种脱节
说明舰载直升机空气动力学的研究成果尚未充分发挥其价值，应当引起上下游学科的共同关注。
\end_layout

\begin_layout Subsubsection
结构动力学
\end_layout

\begin_layout Standard
Wei 等
\begin_inset CommandInset citation
LatexCommand cite
key "Wei1992"
literal "false"

\end_inset

于 1992 年分析了 SH-2F 型直升机在预定的甲板运动、甲板摩擦、定常风条件下的结构动力学特性，用以确定该型直升机安全着舰和离舰的条件。对处于工作状态的旋
翼、处于非工作状态的旋翼、折叠起来的旋翼以及机身分别进行了建模，以研究这4种情况的空气动力学特性。利用能量法推导了船体运动的动力学方程，包含三个线位移、两个角位
移（滚转、俯仰）共五个自由度。此外，他们还分析了不同甲板摩擦条件对直升机结构动力学特性的影响。基于上述分析模型，此文给出了一些定性和定量的安全指标，但有待试验数
据的验证。
\end_layout

\begin_layout Standard
Wall
\begin_inset CommandInset citation
LatexCommand cite
key "Wall2009"
literal "false"

\end_inset

 于 2009 年研究了直升机着舰和离舰过程中桨叶特有的气动弹性问题。在海上风速较大且旋翼转速较低时，桨叶容易出现较大变形，这是由桨叶的动力学特性、船体运动、船
体空气尾流等因素共同作用所引起的。他们将柔性桨叶离散为若干刚性的微段，用以表现非线性的桨叶弯曲变形；基于试验数据对船体空气尾流进行建模，体现了甲板上方气流随时间
、空间变化的非定常、非均匀的特征。此文反映了影响桨叶气弹响应的各种因素之间相互作用关系的复杂性，但分析所用气动模型依赖试验数据，可考虑用更一般的
 CFD 方法代替。
\end_layout

\begin_layout Subsubsection
飞行动力学
\end_layout

\begin_layout Standard
1986 年，Jewell 等
\begin_inset CommandInset citation
LatexCommand cite
key "Jewell1986"
literal "false"

\end_inset

介绍了一项由美国海军航空发展中心支持的试验研究。该项研究的目的是在直升机操稳参数、舰面操纵流程、环境条件等方面，对飞行品质规范的修订提出建议。
\end_layout

\begin_layout Standard
Clement 等
\begin_inset CommandInset citation
LatexCommand cite
key "Clement1992"
literal "false"

\end_inset

于 1992 年建立了一种用于模拟直升机着舰飞行的实时仿真模型。该模型采用叶素法对旋翼进行气动建模；利用 CFD 软件得到船体空气尾流数据，并经过三维快速傅里叶
变换算法处理，使其适用于实时仿真。
\end_layout

\begin_layout Standard
1994 年，Zhang 等
\begin_inset CommandInset citation
LatexCommand cite
key "Zhang1994"
literal "false"

\end_inset

利用全尺寸海上试验数据，识别出了一个关于船体空气尾流速度垂直分量的功率谱模型。基于上述半经验的船体空气尾流模型和一个简化的旋翼气动模型，他们研究了船体空气尾流对
旋翼拉力和滚转、俯仰力矩的影响。此后，他们又建立了一种用于模拟直升机与船体气动干扰并考虑地面效应的实时仿真模型。该模型中，船体由板块表示，旋翼尾迹由固定尾迹和预
定尾迹模型表示，海面的影响（地面效应）通过镜像法体现。基于以上模型，将旋翼入流表示成有限状态形式，以便于进行实时仿真。该模型只适用于直升机在甲板上方悬停的配平问
题。此后，他们还对直升机与船体气动干扰问题中的地面效应问题进行了研究
\begin_inset CommandInset citation
LatexCommand cite
key "Zhang1995"
literal "false"

\end_inset

。
\end_layout

\begin_layout Standard
1999 年，Bogstad 等
\begin_inset CommandInset citation
LatexCommand cite
key "Bogstad1999,Bogstad2002"
literal "false"

\end_inset

利用基于欧拉方程和非结构网格的有限元求解器，研究了船体空气尾流，并将得到的数据整合到直升机飞行仿真软件中。Zan
\begin_inset CommandInset citation
LatexCommand cite
key "Zan2003"
literal "false"

\end_inset

 于 2003 年对文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Bogstad2002"
literal "false"

\end_inset

 中的一些观点提出了质疑，其认为特殊算例的计算结果与试验数据进行的对比，并不能证明该方法在更一般的条件下仍然有效；试验和基于 Navier–Stokes
 方程的计算结果都显示，在某些情况下，船体空气尾流是由涡流主导的，并且存在强烈的流动分离现象，因此文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Bogstad2002"
literal "false"

\end_inset

 中基于 Euler 方程得到的结论并不可靠。
\end_layout

\begin_layout Standard
2003–2005 年，Lee 等
\begin_inset CommandInset citation
LatexCommand cite
key "Lee2003,Lee2005"
literal "false"

\end_inset

基于非结构网格，利用无黏 CFD 计算得到船体空气尾流，并将其引入到直升机飞行仿真程序 GENHEL 中。基于此模型，他们针对特定的直升机着舰和离舰飞行轨迹，设
计了最优控制算法。结果表明，船体空气尾流的非定常性对于直升机着舰和离舰操纵具有显著影响，这正是舰载直升机与舰载固定翼飞机明显不同的地方。此文中的
 CFD 计算模型没有考虑空气黏性，因而丢失了一些真实船体空气尾流的特征。在后续研究
\begin_inset CommandInset citation
LatexCommand cite
key "Lee2004"
literal "false"

\end_inset

中，他们引入了一种随机船体空气尾流模型，用以提高仿真的效率。该模型可用于优化飞行控制系统，以提高飞行器抗干扰性能。
\end_layout

\begin_layout Standard
2006 年，Hoydonck 等
\begin_inset CommandInset citation
LatexCommand cite
key "Hoydonck2006"
literal "false"

\end_inset

建立了一种用于模拟直升机着舰操纵的飞行力学模型。旋翼模型采用刚性桨叶，考虑二阶挥舞运动，用叶素法对主旋翼进行建模。旋翼入流采用一种改进的 Pitt–Peters
 动态入流模型进行建模，通过引入四个状态变量来体现尾迹畸变对旋翼入流的影响。利用该模型，他们研究了直升机按预定路径着舰的飞行稳定性和控制问题，但并没有考虑船体空
气尾流对旋翼的影响。
\end_layout

\begin_layout Standard
2007 年，Akinyanju
\begin_inset CommandInset citation
LatexCommand cite
key "Akinyanju2007"
literal "false"

\end_inset

 基于直升机综合分析软件 FLIGHTLAB，对舰载直升机舰面操纵进行了建模和分析，并将仿真结果与试验数据进行了比较。他们采用叶素法、有限状态尾迹和自由尾迹对旋
翼进行建模，基于 CFD 对船体空气尾流进行模拟，引入地面涡模拟甲板和海面引起的地面效应。计算结果表明：船的航行速度、航向、旋翼转速、海况对直升机的舰面操纵具有
显著影响，并且得到了试验数据的验证。但此文中的建模工作过于依赖该软件提供的功能，因而不具有一般性，也不易引入更精细的空气动力学或结构动力学模型。
\end_layout

\begin_layout Standard
2012 年，Forres 等
\begin_inset CommandInset citation
LatexCommand cite
key "Forrest2012"
literal "false"

\end_inset

将非定常 CFD 计算所得的船体空气尾流数据引入到直升机飞行模拟器中，得到了一个比较接近真实情况的飞行仿真环境。一些直升机着舰过程中真实存在的现象，在该仿真模型
中得到了体现。通过飞行员的主观评价以及其他客观指标，验证了该模型的有效性，也验证了将船体空气尾流 CFD 计算结果引入飞行仿真的可行性。尽管该方法只考虑了船体空
气尾流对旋翼尾迹的影响，但仍可应用于舰载直升机飞行员的日常训练。
\end_layout

\begin_layout Subsubsection
导航与飞控
\end_layout

\begin_layout Standard
1991 年，Negrin 等
\begin_inset CommandInset citation
LatexCommand cite
key "Negrin1991"
literal "false"

\end_inset

介绍了一种用于手动执行直升机在移动甲板上方低空悬停任务的叠加显示技术。分析和试验结果表明，将惯性参考系中的位置信息提供给飞行员，有助于提高直升机在移动甲板上方执
行悬停任务的质量。该研究以线化方程表示直升机运动，以马尔可夫过程模拟大气扰动，因此并没有将空气动力学的研究成果引入其中。
\end_layout

\begin_layout Standard
2005 年，Hess
\begin_inset CommandInset citation
LatexCommand cite
key "Hess2005"
literal "false"

\end_inset

 基于简化的船体运动和直升机飞行动力学模型，提出了一种适用于直升机全包线飞行控制系统设计的方法，并将该方法应用于直升机在高速航行的船只甲板附近执行位置保持任务。
该模型将大气扰动的影响表示为传递函数，后者基于 UH-60 直升机的飞行试验数据而获得，因此间接利用了气动试验研究的成果。 
\end_layout

\begin_layout Standard
2014 年，Ngo & Sultan
\begin_inset CommandInset citation
LatexCommand cite
key "Ngo2014"
literal "false"

\end_inset

 建立了一种用于着舰操纵的面向控制系统设计的非线性直升机飞行力学模型。该模型具有隐式常微分方程的形式，其结果与基于悬停和前飞状态线化模型的结果吻合较好。此外，他
们用一种简单的船体运动模型来模拟海面不规则运动对船体的影响。基于以上直升机模型和船体模型，他们利用模型预测控制方法，设计了一种能够完成自主着舰任务的控制系统。从
工程实践角度看，该模型具有一定的应用价值，但其所用的 Pitt–Peters 入流模型，并没有考虑旋翼与船体之间的气动干扰。
\end_layout

\begin_layout Subsection
国内外研究现状小结
\end_layout

\begin_layout Standard
舰载直升机空气动力学的研究内容，既包括所有直升机的共性问题，也包括海上作业带来的特殊问题。对共性问题的研究属于旋翼空气动力学的范畴，其主要任务是认识旋翼流场的特
征，为结构动力学、飞行动力学等下游学科提供气动模型。对特殊问题的研究则是舰载直升机空气动力学的侧重点，其主要任务是研究海面、船体与旋翼之间的气动干扰规律，为提高
舰载直升机海面作业的安全性、舒适性提供支持。
\end_layout

\begin_layout Standard
对旋翼乃至舰载直升机空气动力学的试验研究经历了从定性到定量、从宏观到微观的发展过程。定量试验包含测力试验和测速试验两类。伴随试验技术的进步，测速试验经历了介入式
测速（HWA 技术）、非介入式单点测速（LDV 技术）、非介入式多点测速（PIV 技术）的发展过程。目前，三维 PIV 技术已经能够在全尺寸亚声速风洞[84]中
对旋翼流场进行高分辨率测量。可以预见，该技术在未来一段时间里仍将是旋翼空气动力学研究的重要工具。
\end_layout

\begin_layout Standard
数值计算是旋翼乃至舰载直升机空气动力学的另一类重要的研究方法。旋翼流场的非定常、非线性特征决定了问题的复杂性。为了真实还原旋翼流场的流动特征，必须解决好转捩、附
面层分离、涡核粘性耗散、涡结构失稳破裂等复杂的流体力学问题。为了解决网格离散带来的涡量非物理耗散问题，网格自适应加密技术、涡量约束方法等新兴的流体力学计算方法正
成为该领域的研究热点。
\end_layout

\begin_layout Standard
尽管舰载直升机空气动力学的研究已经用上 PIV、CFD 等先进技术，但其所积累的研究成果尚未广泛应用到结构动力学、飞行动力学、导航与飞控等以气动载荷作为输入的下
游学科。近些年来，随着人工智能算法的不断改进以及计算机软硬件水平的稳步提升，直升机飞控系统的设计正朝着无人自主控制的方向迈进（美国已实现无人直升机的海上自动起降
）
\begin_inset CommandInset citation
LatexCommand cite
key "DengJingHui_2021"
literal "false"

\end_inset

。另一方面，大数据、机器学习技术的进步，也为建立基于 PIV、CFD 数据的精细气动模型创造了前所未有的条件。相比之下，我国在这些方向开展的研究工作仍十分有限。
\end_layout

\begin_layout Section
研究内容
\end_layout

\begin_layout Subsection
船体空气尾流计算方法
\end_layout

\begin_layout Standard
舰载直升机气动问题与路基直升机气动问题的主要区别，在于船体空气尾流的存在及其对旋翼尾迹的影响。
\end_layout

\begin_layout Standard
单纯的船体空气尾流问题，与 CFD 文献中常见的圆柱绕流问题具有相同的物理背景。因此，适用于后者的计算方法，原则上都可以用来计算船体空气尾流。由于圆柱具有简单的
几何外形，为其生成结构网格较为容易，因此大多数用于计算圆柱绕流的求解器，都是基于有限差分格式。这类格式构造简单、易于升阶，但只适用于结构网格。然而在实际工程应用
中，船体通常具有复杂的几何外形，这为结构网格的生成带来了非常大的困难。
\end_layout

\begin_layout Standard
得益于计算几何的发展，非结构网格能够在具有复杂几何外形的区域内自动生成，因此适用于船体空气尾流的计算。但适用于非结构网格的计算方法，通常需要引入较为复杂的数据结
构，因此比有限差分格式更难实现。另一方面，在非结构网格上构造的计算格式，通常不易提升精度阶数，这大大降低了非结构网格计算结果的参考价值。
\end_layout

\begin_layout Standard
寻找并实现一种在非结构网格上易于构造高阶格式的 CFD 方法，是本文要解决的首要问题。
\end_layout

\begin_layout Subsection
旋翼空气动力学模型
\end_layout

\begin_layout Standard
不同旋翼空气动力学模型的主要区别，在于如何反映旋转的桨叶对流场的非定常扰动。
\end_layout

\begin_layout Standard
基于拉格朗日观点的涡元法（如：自由尾迹模型、涡粒子模型），将流场的涡量分布表示为一系列离散的涡量单元。这些涡元生成于旋转的桨叶上，从桨叶后缘脱落后随当地气流自由
运动。在不考虑边界条件或边界条件足够简单（如平直大地）的情况下，这类模型（相对于 CFD 方法）能够高效地模拟桨叶的非定常运动及旋翼尾迹的动态变化。但这类模型通
常难以植入现有的 CFD 方法，因此不适合于舰载直升机气动干扰问题的研究。
\end_layout

\begin_layout Standard
基于欧拉观点的连续介质模型（如：涡量输运方程、Navier–Stokes 方程），将桨叶视为移动的固壁边界。为了在这些移动固壁上施加边界条件，通常需要借助变形网
格、滑动网格、重叠网格等动态网格技术。与不含移动固壁边界从而可以使用静态网格的常规 CFD 问题相比，使用动态网格技术必然会带来计算量的剧增。
\end_layout

\begin_layout Standard
提出并验证一种既能处理具有复杂外形的边界，又能模拟桨叶的非定常运动，还能避免使用动态网格技术的旋翼空气动力学建模方法，是本文研究的主要内容。
\end_layout

\begin_layout Subsection
算法的并行加速
\end_layout

\begin_layout Standard
舰载直升机气动干扰问题属于复杂流动问题，无论采用何种计算模型，都需要消耗大量的计算资源。为了提高问题的求解效率，扩大问题的求解规模，必须对算法做并行加速。为了评
估加速的效果，需要在具体的计算设备上进行测试，以确定性能瓶颈和进一步改进的方向。
\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "MPI"
description "message passing interface"
literal "true"

\end_inset

“消息传递接口 (message passing interface, MPI)”是目前最主流的并行计算标准，几乎所有高性能计算平台上都部署了该标准的某种具体实
现。应用程序通过调用它提供的函数，将计算任务发送到各个计算节点（核心）上做并行处理，从而扩大求解规模、提高计算效率。MPI 技术基于粗粒度的进程级并行，对单核性
能的要求较低，具有良好的可移植性和可扩展性。
\end_layout

\begin_layout Standard
利用 MPI 技术实现对既有算法的并行加速，是本文对前人工作的一大改进。
\end_layout

\begin_layout Section
全文结构
\end_layout

\begin_layout Standard
本文共分为五章，各章内容安排如下：
\end_layout

\begin_layout Standard
第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:绪论"

\end_inset

章为绪论，首先介绍本文的研究背景，随后综述国内外研究现状，并提出本文的研究内容，最后给出全文的组织结构。
\end_layout

\begin_layout Standard
第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:算法"

\end_inset

章推导一种适用于三维非结构网格、能够有效压制数值振荡的龙格–库塔间断伽辽金 (RKDG) 有限元方法。在此基础上，将一种非定常动量源模型 (UMS)
 与该方法相结合，提出一种支持对旋翼空气动力学问题进行高效、高精度数值模拟的 UMS–RKDG 方法。
\end_layout

\begin_layout Standard
第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:验证"
plural "false"
caps "false"
noprefix "false"

\end_inset

章
\begin_inset Note Note
status open

\begin_layout Plain Layout
基于现代 C++ 的标准库、类机制、模板机制，编写出一套求解器各模块的类模板，并以此模板生成不同精度阶数、不同物理背景的 RKDG 求解器实例。
\end_layout

\end_inset

利用具有解析解或精确解的一维标准算例，定量验证上述 RKDG 求解器的正确性和精度阶数。利用拥有公认数值解的二维标准算例，定性验证上述求解器捕捉复杂流动图象的能
力。
\end_layout

\begin_layout Standard
第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:并行"
plural "false"
caps "false"
noprefix "false"

\end_inset

章对上述求解器做了并行加速，以支持高性能计算平台上的分布式并行计算。基于并行化的 RKDG 求解器，在具有复杂几何外形边界的非结构网格上，定性验证
 RK3/DG3 近似解的正确性和高精度优势。基于并行化的 UMS–RKDG 求解器，开展爬升、前飞两种工况的旋翼数值风洞试验，定性验证 UMS–RK3/DG3
 近似解的正确性和高精度优势。在此过程中，对上述求解器的并行性能进行了测量和评估。
\end_layout

\begin_layout Standard
第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:应用"
plural "false"
caps "false"
noprefix "false"

\end_inset

章利用上述经过验证的 UMS–RK3/DG3 求解器，模拟了一种简化条件下的单旋翼–船体–海面气动干扰的形成过程。结果表明：本文提出并实现的上述求解器，能够在较
粗的网格上捕捉到单旋翼–船体–海面气动干扰的主要流场特征，可用于更复杂的舰载直升机气动干扰问题研究。
\end_layout

\begin_layout Standard
最后是结论部分，总结了本文的主要内容及创新点，并对进一步研究的方向给出了建议。
\end_layout

\begin_layout Chapter
舰载直升机三维流场的高阶计算格式
\begin_inset CommandInset label
LatexCommand label
name "chap:算法"

\end_inset


\end_layout

\begin_layout Standard
目前在航空航天工程中使用的大多数 CFD 求解器都是基于有限体积格式。有限体积格式可以在非结构网格上构造，因此比有限差分格式更容易处理具有复杂几何外形的流场边界
。然而，有限体积格式通常只有二阶空间精度，这是由于不规则局部模板的尺寸随着精度的阶数增加而迅速增长。在高阶有限体积格式中，单元的本地模板由单元和单元的邻居、邻居
的邻居等组成。为了简化非结构网格上的高阶格式的设计，最好使用局部模板比有限体积格式更紧致的有限单元法，如：“间断伽辽金 (discontinuous
 Galerkin, DG)”法。DG 法在每个单元内部用连续函数做近似（这一点更像经典有限元法），但允许在单元边界上存在间断（这一点更像经典有限体积法）。这样
的假设使格式设计者在为每个单元选择基函数时有更大的自由度，例如：基于正交基函数的模态型 DG 法，基于拉格朗日多项式的节点型 DG 法
\begin_inset CommandInset citation
LatexCommand cite
key "Hesthaven_2008"
literal "false"

\end_inset

。
\end_layout

\begin_layout Standard
最早的 DG 格式由 Reed & Hill
\begin_inset CommandInset citation
LatexCommand cite
key "Reed_1973"
literal "false"

\end_inset

 引入，用于求解中子输运方程。这是一个仅包含一阶空间导数的线性问题。对于非线性守恒律，Chavent & Salzano
\begin_inset CommandInset citation
LatexCommand cite
key "Chavent_1982"
literal "false"

\end_inset

 首次尝试使用 DG 法进行空间离散，并使用显式 Euler 格式进行时间离散。该格式在空间上是二阶精度的，但在时间上只有一阶精度。为了提高时间离散的精度，Co
ckburn & Shu
\begin_inset CommandInset citation
LatexCommand citep
key "Cockburn_1988"
literal "false"

\end_inset

 将一阶 Euler 格式替换为某种特殊的二阶 Runge–Kutta (RK) 格式
\begin_inset CommandInset citation
LatexCommand cite
key "Shu_1988,Shu_1989"
literal "false"

\end_inset

，所得格式是“总变差递减的 ( total variation diminishing, TVD)”。它是第一个取得成功的 RKDG 格式，该格式在空间和时间上
都具有高阶精度，适用于标量守恒定律。这种方法很快被推广到一维守恒律方程组
\begin_inset CommandInset citation
LatexCommand citep
key "Cockburn_1989"
literal "true"

\end_inset

、高维标量守恒律
\begin_inset CommandInset citation
LatexCommand citep
key "Cockburn_1990"
literal "false"

\end_inset

以及高维守恒律方程组
\begin_inset CommandInset citation
LatexCommand cite
key "Cockburn_1998"
literal "false"

\end_inset

，包括描述无黏可压流的 Euler 方程。几乎在同一时期（1990 年代后期），DG 法也被扩展到控制黏性流动的 Navier–Stokes 方程。Bassi
 & Rebay
\begin_inset CommandInset citation
LatexCommand cite
key "Bassi_1997"
literal "false"

\end_inset

 首次尝试将 DG 离散应用于未知量及其梯度，以求解 Navier–Stokes 方程。该方法随后被 Cockburn & Shu
\begin_inset CommandInset citation
LatexCommand cite
key "Cockburn_1998b"
literal "false"

\end_inset

 推广为局部 DG 法，将 RKDG 方法从守恒律推广到对流占优问题，具体推广过程可参考文献-
\begin_inset CommandInset citation
LatexCommand citep
key "Cockburn_2001"
literal "false"

\end_inset

。
\end_layout

\begin_layout Standard
RKDG 方法虽然能在非结构网格上构造出高阶格式，但对于含有移动边界（如：旋翼桨叶）的问题，通常需要使用动态网格技术（例如变形网格、滑动网格、重叠网格）。另一方
面，在有限差分及有限体积法中，典型的升力体（如：旋翼）已成功地被建模为各种形式的动量源。Rajagopalan & Mathur 
\begin_inset CommandInset citation
LatexCommand cite
key "Rajagopalan_1989,Rajagopalan_1993"
literal "false"

\end_inset

 提出了第一个基于有限差分及有限体积的动量源模型，该模型将旋翼的时间平均效应建模为作用盘。北航的康宁和孙茂
\begin_inset CommandInset citation
LatexCommand cite
key "Kang_1997,Kang_2000"
literal "false"

\end_inset

用这种时间平均的动量源模型，模拟了处于地面效应中的旋翼的流场。南航的史勇杰等
\begin_inset CommandInset citation
LatexCommand cite
key "Shi_2017"
literal "false"

\end_inset

将该模型与非定常重叠网格方法进行了比较，发现定常动量源模型能够以更低的计算成本模拟旋翼和飞行甲板之间的复杂气动干扰。Shen
\begin_inset CommandInset citation
LatexCommand cite
key "Shen_2009"
literal "false"

\end_inset

 和 Kim
\begin_inset CommandInset citation
LatexCommand cite
key "Kim_2015"
literal "false"

\end_inset

用代表各片桨叶的作用面模型，，捕获了旋翼流场的非定常效应。此类早期工作要么通过忽略非定常效应而过度简化（如文献-
\begin_inset CommandInset citation
LatexCommand citep
key "Rajagopalan_1989,Rajagopalan_1993,Kang_1997,Kang_2000"
literal "false"

\end_inset

），要么仅限于结构网格（如文献-
\begin_inset CommandInset citation
LatexCommand citep
key "Shen_2009,Shi_2017"
literal "false"

\end_inset

）。
\end_layout

\begin_layout Standard
本章将前人为解决二维守恒律问题而提出的带有紧致型 WENO 限制器的 RKDG 方法，推广为含有源项的三维双曲型方程组的求解方法，并在最后一节给出一种特殊的源项
，用以模拟旋翼对流场的非定常扰动。
\end_layout

\begin_layout Section
三维非结构网格上的 DG 空间离散
\begin_inset CommandInset label
LatexCommand label
name "sec:DG"

\end_inset


\end_layout

\begin_layout Subsection
非结构网格
\end_layout

\begin_layout Standard
离散某空间区域最常用的方法，是将该区域分割为有限个互不重叠的“单元 (element/cell)”。这些单元通常具有简单的几何外形，例如：直线段、三角形、四边形
、四面体、三棱柱、六面体。定义单元所用到的几何点被称为“结点 (node/point)”，由多个单元共享的结点被称为“顶点”，由某个单元独占的结点被称为“内点”
。记录所有单元及结点信息的数据结构被称为“网格 (mesh/grid)”。为方便叙述，表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:mesh"

\end_inset

 列出了本文用到的网格术语及记号，其中“对象 
\begin_inset Formula $X$
\end_inset

”指代由网格成员组成的任意子集。
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:mesh"

\end_inset

网格术语及记号
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
中文名
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
英文名
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
记号
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
简写
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
含义
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
网格
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G(\varOmega)$
\end_inset

 或 
\begin_inset Formula $G_{\varOmega}$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$G(\\varOmega)$ 或 $G_{\\varOmega}$"
description "表示覆盖区域 $\\varOmega$ 的网格"
literal "true"

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
用于离散空间区域 
\begin_inset Formula $\varOmega$
\end_inset

 的网格
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
索引
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Index
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $I(X)$
\end_inset

 或 
\begin_inset Formula $I_{X}$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$I(X)$ 或 $I_{X}$"
description "表示对象 $X$ 中所有成员编号之集"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $I$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中所有成员编号之集
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
数量
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N(X)$
\end_inset

 或 
\begin_inset Formula $N_{X}$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$N(X)$ 或 $N_{X}$"
description "表示对象 $X$ 中所有成员的数量"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中所有成员的数量
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
体单元
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Volume element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $V(X,i)$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$V(X,i)$ 或 $V_{i}$"
description "表示对象 $X$ 中的第 $i$ 号体单元"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $V_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中的第 
\begin_inset Formula $i$
\end_inset

 号体单元
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $V(X)$
\end_inset

 或 
\begin_inset Formula $V_{X}$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$V(X)$ 或 $V_{X}$"
description "表示对象 $X$ 中的所有体单元"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $V$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中的所有体单元
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
面单元
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $S(X,i)$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$S(X,i)$"
description "表示对象 $X$ 中的第 $i$ 号面单元"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $S_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中的第 
\begin_inset Formula $i$
\end_inset

 号面单元
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $S(X)$
\end_inset

 或 
\begin_inset Formula $S_{X}$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$S(X)$ 或 $S_{X}$"
description "表示对象 $X$ 中的所有面单元"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $S$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中的所有面单元
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
结点
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Point
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P(X,i)$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$P(X,i)$"
description "表示对象 $X$ 中的第 $i$ 号结点"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中的第 
\begin_inset Formula $i$
\end_inset

 号结点
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P(X)$
\end_inset

 或 
\begin_inset Formula $P_{X}$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$P(X)$ 或 $P_{X}$"
description "表示对象 $X$ 中的所有结点"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
对象 
\begin_inset Formula $X$
\end_inset

 中的所有结点
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
从几何的角度看，网格应恰好填满整个区域，即
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\varOmega$"
description "表示计算区域"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\varOmega=\bigcup_{i\in I_{V(G)}}\overline{V_{i}},
\end{equation}

\end_inset

且相邻体单元之交的体积为零，即
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\mathrm{\\delta}_{ik}$"
description "表示 Kronecker 记号，$i=k$ 时取值为 $1$，否则取值为 $0$"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{V_{i}\cap V_{k}}1=\mathrm{\delta}_{ik}\int_{V_{i}}1,\qquad\forall(i,k)\in I_{V(G)}\times I_{V(G)},
\end{equation}

\end_inset

其中 
\begin_inset Formula $\overline{V_{i}}\coloneqq V_{i}\cup(\partial V_{i})$
\end_inset

 为 
\begin_inset Formula $V_{i}$
\end_inset

 之“闭包 (closure)”。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\overline{V_{i}}$"
description "表示体单元 $V_{i}$ 的闭包"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\partial V_{i}$"
description "表示体单元 $V_{i}$ 的边界"
literal "true"

\end_inset

如无特殊说明，本文所称“体单元”均指开集。
\end_layout

\begin_layout Standard
从数据结构的角度看，网格是所有体单元、面单元、结点的“容器 (container)”，体单元又是其所拥有的面单元、结点的容器，因此这些容器应当支持对其成员的快速
“遍历 (traversal)”，即复杂度不超过 
\begin_inset Formula $N\lg^{3}N$
\end_inset

，这里 
\begin_inset Formula $N$
\end_inset

 为该容器某种成员的数量。除此之外，面单元应当支持对其两侧体单元的快速“查询 (query)”，即复杂度不超过 
\begin_inset Formula $\lg^{3}N$
\end_inset

，这里 
\begin_inset Formula $N$
\end_inset

 为体单元数量。
\end_layout

\begin_layout Standard
除上述条件外，有限体积法、有限单元法对网格没有更多的要求，因此特别适合于“非结构 (unstructured)”网格，从而特别适合于具有复杂几何边界的问题。这种
网格的灵活性正是有限体积法、有限单元法相对于有限差分法的优势之一。在连续介质力学中，“控制体 (control volume)”与“控制面 (control
 surface)”具有重要的物理意义。最自然的方案是：以体单元为控制体、以面单元为控制面。
\end_layout

\begin_layout Standard
对于一维问题，最简单的网格方案是一维结构网格：用 
\begin_inset Formula $N_{P}$
\end_inset

 个结点将一维区间 
\begin_inset Formula $[a,b]$
\end_inset

 分割为首尾相连的 
\begin_inset Formula $N_{V}=N_{P}-1$
\end_inset

 个控制体，即
\begin_inset Formula 
\begin{equation}
\varOmega\coloneqq[a,b],\qquad P(G)=\left\{ P_{i}\coloneqq x_{i}\right\} _{i=1}^{N_{P}},\qquad V(G)=\left\{ V_{i}\coloneqq(x_{i},x_{i+1})\right\} _{i=1}^{N_{V}},
\end{equation}

\end_inset

以相邻控制体的公共端点为控制面，因此 
\begin_inset Formula $P_{i}\equiv S_{i}$
\end_inset

。对于静态网格（在计算过程中保持不变的网格），最简单的数据结构（数组）即可满足前述条件。在更一般的一维非结构网格中，结点编号可能相当无序，即不要求
 
\begin_inset Formula $i<j\iff x_{i}<x_{j}$
\end_inset

，而是记 
\begin_inset Formula $V_{i}\coloneqq(x_{i-1/2},x_{i+1/2})$
\end_inset

，其中 
\begin_inset Formula $x_{i\pm1/2}$
\end_inset

 表示控制体 
\begin_inset Formula $V_{i}$
\end_inset

 两端点的坐标值。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$x_{i-1/2}$"
description "表示一维网格中第 $i$ 号单元的左端点"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$x_{i+1/2}$"
description "表示一维网格中第 $i$ 号单元的右端点"
literal "true"

\end_inset

按此记法，
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\vert V_{i}\\vert$"
description "表示单元 $V_{i}$ 的测度（线单元的长度、面单元的面积、体单元的体积）"
literal "true"

\end_inset


\begin_inset Formula $V_{i}$
\end_inset

 的长度（一维体积）可以记为
\begin_inset Formula 
\begin{equation}
h_{i}\coloneqq\vert V_{i}\vert\coloneqq\int_{V_{i}}1=\int_{x_{i-1/2}}^{x_{i+1/2}}1\dd{x}=x_{i+1/2}-x_{i-1/2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
对于高维问题，网格的生成是一项重要且相对独立的技术，需要借助专业的软件（例如：
\begin_inset CommandInset href
LatexCommand href
name "Gmsh"
target "http://gmsh.info/"
literal "false"

\end_inset

、
\begin_inset CommandInset href
LatexCommand href
name "CGAL"
target "https://www.cgal.org/"
literal "false"

\end_inset

）来完成。这些软件输出的非结构网格文件（例如：
\begin_inset CommandInset href
LatexCommand href
name "MSH"
target "http://gmsh.info/doc/texinfo/gmsh.html#File-formats"
literal "false"

\end_inset

、
\begin_inset CommandInset href
LatexCommand href
name "VTK"
target "https://www.vtk.org/wp-content/uploads/2015/04/file-formats.pdf"
literal "false"

\end_inset

、
\begin_inset CommandInset href
LatexCommand href
name "CGNS"
target "http://cgns.github.io/"
literal "false"

\end_inset

）通常只含有结点坐标与体单元结点编号等信息，而不会显式记录面单元及其与体单元的关联信息。在导入这类网格文件时，需要以 
\begin_inset Formula $\order{N_{V}\lg^{3}N_{V}}$
\end_inset

 复杂度构造所有面单元，并为每个面单元创建其相邻体单元的引用
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset CommandInset href
LatexCommand href
name "OpenFOAM"
target "https://www.openfoam.com"
literal "false"

\end_inset

 定义的 
\begin_inset CommandInset href
LatexCommand href
name "polyMesh 格式"
target "https://www.openfoam.com/documentation/user-guide/4-mesh-generation-and-conversion/4.1-mesh-description"
literal "false"

\end_inset

会显式记录面元及两侧体元的信息，故无需此操作
\end_layout

\end_inset

。
\begin_inset Note Note
status open

\begin_layout Subsection
创建面单元
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
多项式近似
\end_layout

\begin_layout Standard
给定函数 
\begin_inset Formula $u\colon\varOmega\to\mathbb{R}$
\end_inset

 及非结构网格 
\begin_inset Formula $G(\varOmega)$
\end_inset

，在任意体单元 
\begin_inset Formula $V_{i}\subset\varOmega$
\end_inset

 上总是可以定义 
\begin_inset Formula $u$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的多项式近似
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$u^{h}\\vert_{V_{i}}$"
description "表示标量函数 $u$ 在体单元 $V_{i}$ 上的多项式近似"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$u^{h}$"
description "表示标量函数 $u$ 在尺度为 $h$ 的网格上的多项式近似"
literal "true"

\end_inset

，记作
\begin_inset Formula 
\begin{equation}
u^{h}|_{V_{i}}(x,y,z)=\sum_{a,b,c}\hat{u}_{a,b,c}(x-x_{0})^{a}(y-y_{0})^{b}(z-z_{0})^{c},\qquad(x,y,z)\in V_{i},
\end{equation}

\end_inset

其中 
\begin_inset Formula $a,b,c$
\end_inset

 均为非负整数，
\begin_inset Formula $\hat{u}_{a,b,c}$
\end_inset

 为常值系数
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\hat{u}_{a,b,c}$"
description "表示多项式 $u^{h}\\vert_{V_{i}}$ 以 $(x_{0},y_{0},z_{0})$ 为中心的展开式中 $(x-x_{0})^{a}(y-y_{0})^{b}(z-z_{0})^{c}$ 的系数"
literal "true"

\end_inset

，
\begin_inset Formula $(x_{0},y_{0},z_{0})$
\end_inset

 为 
\begin_inset Formula $V_{i}$
\end_inset

 内任意一点，
\begin_inset Formula $h$
\end_inset

 表示单元尺寸（棱长平均值或外接球半径）
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$h$"
description "表示单元的尺寸（棱长平均值或外接球半径）"
literal "true"

\end_inset

。将 
\begin_inset Formula $u$
\end_inset

 在所有体单元 
\begin_inset Formula $V(G)$
\end_inset

 上的这种多项式近似拼接在一起，就得到一个定义在所有体单元的并集 
\begin_inset Formula $\bigcup_{i\in I_{V(G)}}V_{i}$
\end_inset

 上的函数：
\begin_inset Formula 
\begin{equation}
u^{h}(x,y,z)=\begin{cases}
u^{h}|_{V_{1}}(x,y,z), & (x,y,z)\in V_{1},\\
\vdots & \vdots\\
u^{h}|_{V_{i}}(x,y,z), & (x,y,z)\in V_{i},\\
\vdots & \vdots\\
u^{h}|_{V_{N_{V(G)}}}(x,y,z), & (x,y,z)\in V_{N_{V(G)}}.
\end{cases}\label{eq:piecewise_polynomial}
\end{equation}

\end_inset

该函数的定义域 
\begin_inset Formula $\bigcup_{i\in I_{V(G)}}V_{i}$
\end_inset

 与被网格 
\begin_inset Formula $G$
\end_inset

 离散的区域 
\begin_inset Formula $\varOmega$
\end_inset

 相比，遗漏了面单元上的点。为了让 
\begin_inset Formula $u^{h}$
\end_inset

 真正成为 
\begin_inset Formula $u$
\end_inset

 在 
\begin_inset Formula $\varOmega$
\end_inset

 上的近似，需要补充其在这些面单元上的值。在间断伽辽金有限元法框架内，这些值可以由精确或近似黎曼求解器给出。本小节暂不对其展开讨论，因为所有面单元的并集在三维空
间内的测度为零，而零测度集上的值不影响体积分。
\end_layout

\begin_layout Standard
为了定量描述 
\begin_inset Formula $u^{h}$
\end_inset

 对 
\begin_inset Formula $u$
\end_inset

 的近似精度，需要在二者共同所属的函数空间上引入某种“度量 (metric)”。通常的做法是取 
\begin_inset Formula $\varOmega$
\end_inset

 上的平方可积函数空间
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$L^{2}(\\varOmega)$"
description "表示 $\\varOmega$ 上的平方可积函数空间"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
L^{2}(\varOmega)\coloneqq\left\{ \phi:\int_{\varOmega}\vert\phi\vert^{2}<\infty\right\} ,\label{eq:L2-space}
\end{equation}

\end_inset

并在此空间上定义“内积 (inner-product)”：
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\langle\\phi\\vert\\psi\\rangle_{\\varOmega}$"
description "表示 $L^{2}(\\varOmega)$ 上的内积"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\langle\phi\vert\psi\rangle_{\varOmega}\coloneqq\int_{\varOmega}(\phi\psi),\qquad\forall(\phi,\psi)\in L^{2}(\varOmega)\times L^{2}(\varOmega),\label{eq:inner-product}
\end{equation}

\end_inset

再由其诱导出“范数 (norm)”：
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\Vert\\phi\\Vert_{\\varOmega}$"
description "表示 $L^{2}(\\varOmega)$ 上的范数"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\Vert\phi\Vert_{\varOmega}\coloneqq\sqrt{\langle\phi\vert\phi\rangle_{\varOmega}},\qquad\forall\phi\in L^{2}(\varOmega).\label{eq:norm}
\end{equation}

\end_inset

可以证明：式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inner-product"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:norm"

\end_inset

 与内积、范数的公理化定义是相容的，且 
\begin_inset Formula $L^{2}(\varOmega)$
\end_inset

 是完备的无穷维内积空间。有了上述概念，便可以定义误差的“阶数 (order)”：若随着 
\begin_inset Formula $h\to0$
\end_inset

，函数 
\begin_inset Formula $u$
\end_inset

 与其多项式近似 
\begin_inset Formula $u^{h}$
\end_inset

 之差的范数是 
\begin_inset Formula $h$
\end_inset

 的 
\begin_inset Formula $p$
\end_inset

 阶无穷小量，即
\begin_inset Formula 
\begin{equation}
\Vert u^{h}-u\Vert_{\varOmega}=\order{h^{p}},\label{eq:accuracy_order}
\end{equation}

\end_inset

则称 
\begin_inset Formula $u^{h}$
\end_inset

 是 
\begin_inset Formula $u$
\end_inset

 的 
\begin_inset Formula $p$
\end_inset

 阶近似，或 
\begin_inset Formula $u^{h}$
\end_inset

 对 
\begin_inset Formula $u$
\end_inset

 的近似具有 
\begin_inset Formula $p$
\end_inset

 阶精度。若规定多项式 
\begin_inset Formula $u^{h}$
\end_inset

 中任意一项的次数之和小于 
\begin_inset Formula $p$
\end_inset

，则对于一般的 
\begin_inset Formula $u$
\end_inset

，多项式近似至多具有 
\begin_inset Formula $p$
\end_inset

 阶精度。式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:accuracy_order"

\end_inset

 所定义的阶数是“后验的 (a posteriori)”，需要得到 
\begin_inset Formula $u^{h}$
\end_inset

 以后才能计算。为了叙述方便，这里定义“先验 (a priori)”或“名义 (nominal)”阶数：若所有 
\begin_inset Formula $u^{h}|_{V_{i}}$
\end_inset

 的次数都等于 
\begin_inset Formula $p$
\end_inset

，则称 
\begin_inset Formula $u^{h}$
\end_inset

 对 
\begin_inset Formula $u$
\end_inset

 的近似具有 
\begin_inset Formula $p+1$
\end_inset

 阶（先验或名义）精度。
\end_layout

\begin_layout Standard
将式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:L2-space"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:norm"

\end_inset

 中的 
\begin_inset Formula $\varOmega$
\end_inset

 替换为 
\begin_inset Formula $V_{i}$
\end_inset

，就得到
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$L^{2}(V_i)$"
description "表示 $V_i$ 上的平方可积函数空间"
literal "true"

\end_inset

函数空间 
\begin_inset Formula $L^{2}(V_{i})$
\end_inset

 及其上的内积
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\langle\\phi\\vert\\psi\\rangle_{V_i}$"
description "表示 $L^{2}(V_i)$ 上的内积"
literal "true"

\end_inset

与范数
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\Vert\\phi\\Vert_{V_i}$"
description "表示 $L^{2}(V_i)$ 上的范数"
literal "true"

\end_inset

。由此可以给出确定 
\begin_inset Formula $u^{h}|_{V_{i}}$
\end_inset

 的一般方法。实际计算不可能取遍整个 
\begin_inset Formula $L^{2}(V_{i})$
\end_inset

，而是只能在 
\begin_inset Formula $L^{2}(V_{i})$
\end_inset

 的某个有限维完备子空间 
\begin_inset Formula $X$
\end_inset

 内寻找 
\begin_inset Formula $u$
\end_inset

 的最优近似：
\begin_inset Formula 
\begin{equation}
\min_{u^{h}\in X}\Vert u-u^{h}\Vert_{V_{i}}.
\end{equation}

\end_inset

例如：可以将 
\begin_inset Formula $X$
\end_inset

 取作由定义在 
\begin_inset Formula $V_{i}$
\end_inset

 上的次数低于 
\begin_inset Formula $p$
\end_inset

 的多项式所张成的线性空间，记作
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\mathbb{P}^{<p}(V_{i})$"
description "表示定义在 $V_{i}$ 上的次数低于 $p$ 的多项式所张成的线性空间"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbb{P}^{<p}(V_{i})\coloneqq\mathrm{span}\left\{ x^{a}y^{b}z^{c}:\vert a+b+c\vert<p\right\} .
\end{equation}

\end_inset

可以证明：该空间的其维数为
\begin_inset Formula 
\begin{equation}
n=\binom{p+2}{3}=\frac{(p+2)(p+1)p}{6},
\end{equation}

\end_inset

且关于式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inner-product"

\end_inset

 所定义的内积是完备的。于是，在 
\begin_inset Formula $\mathbb{P}^{<p}(V_{i})$
\end_inset

 内寻找 
\begin_inset Formula $u$
\end_inset

 的最优近似 
\begin_inset Formula $u^{h}$
\end_inset

 就归结为求解关于 
\begin_inset Formula $\left\{ \hat{u}_{a,b,c}\right\} _{\vert a+b+c\vert<p}$
\end_inset

 这 
\begin_inset Formula $(p+2)(p+1)p/6$
\end_inset

 个待定系数的最小值问题：
\begin_inset Formula 
\begin{equation}
\min_{\hat{u}_{a,b,c}\in\mathbb{R}}\int_{V_{i}}\left(u-\sum_{\vert a+b+c\vert<p}\hat{u}_{a,b,c}x^{a}y^{b}z^{c}\right)^{2}.
\end{equation}

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
正定二次型
\end_layout

\end_inset

直接求解该优化问题过于繁琐，更简洁的方式为借助式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inner-product"

\end_inset

 所定义的内积构造 
\begin_inset Formula $u$
\end_inset

 在 
\begin_inset Formula $\mathbb{P}^{<p}(V_{i})$
\end_inset

 上的投影。
\end_layout

\begin_layout Subsection
正交归一化
\begin_inset CommandInset label
LatexCommand label
name "subsec:orthonormal"

\end_inset


\end_layout

\begin_layout Standard
任取 
\begin_inset Formula $\mathbb{P}^{<p}(V_{i})$
\end_inset

 的一组基函数，总是可以借助式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inner-product"

\end_inset

 所定义的内积，构造出 
\begin_inset Formula $\mathbb{P}^{<p}(V_{i})$
\end_inset

 的一组正交归一化的基函数。不失一般性，可以取
\begin_inset Formula 
\begin{equation}
\phi_{1}(\vec{r})=1,\qquad\begin{bmatrix}\phi_{2}(\vec{r})\\
\phi_{3}(\vec{r})\\
\phi_{4}(\vec{r})
\end{bmatrix}=\begin{bmatrix}x-x_{0}\\
y-y_{0}\\
z-z_{0}
\end{bmatrix},\qquad\begin{bmatrix}\phi_{5}(\vec{r})\\
\phi_{6}(\vec{r})\\
\phi_{7}(\vec{r})\\
\phi_{8}(\vec{r})\\
\phi_{9}(\vec{r})\\
\phi_{10}(\vec{r})
\end{bmatrix}=\begin{bmatrix}(x-x_{0})(x-x_{0})\\
(x-x_{0})(y-y_{0})\\
(x-x_{0})(z-z_{0})\\
(y-y_{0})(y-y_{0})\\
(y-y_{0})(z-z_{0})\\
(z-z_{0})(z-z_{0})
\end{bmatrix},
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\phi_{11}(\vec{r})\\
\phi_{12}(\vec{r})\\
\phi_{13}(\vec{r})\\
\phi_{14}(\vec{r})\\
\phi_{15}(\vec{r})\\
\phi_{16}(\vec{r})\\
\phi_{17}(\vec{r})\\
\phi_{18}(\vec{r})\\
\phi_{19}(\vec{r})\\
\phi_{20}(\vec{r})
\end{bmatrix}=\begin{bmatrix}(x-x_{0})(x-x_{0})(x-x_{0})\\
(x-x_{0})(x-x_{0})(y-y_{0})\\
(x-x_{0})(x-x_{0})(z-z_{0})\\
(x-x_{0})(y-y_{0})(y-y_{0})\\
(x-x_{0})(y-y_{0})(z-z_{0})\\
(x-x_{0})(z-z_{0})(z-z_{0})\\
(y-y_{0})(y-y_{0})(y-y_{0})\\
(y-y_{0})(y-y_{0})(z-z_{0})\\
(y-y_{0})(z-z_{0})(z-z_{0})\\
(z-z_{0})(z-z_{0})(z-z_{0})
\end{bmatrix},\qquad\dots
\end{equation}

\end_inset

其中 
\begin_inset Formula $(x_{0},y_{0},z_{0})$
\end_inset

 是体单元 
\begin_inset Formula $V_{i}$
\end_inset

 内任意一点。可以证明：
\begin_inset Formula 
\begin{equation}
\underline{\phi}(\vec{r})\coloneqq\begin{bmatrix}\phi_{1}(\vec{r}) & \phi_{2}(\vec{r}) & \cdots & \phi_{n}(\vec{r})\end{bmatrix}^{t},\qquad n=\frac{p}{6}(p+1)(p+2),
\end{equation}

\end_inset

的确是函数空间 
\begin_inset Formula $\mathbb{P}^{<p}(V_{i})$
\end_inset

 的一组基。对其应用 Gram–Schimidt 过程，即得一组正交归一化的基函数：
\end_layout

\begin_layout Itemize
首先对 
\begin_inset Formula $\phi_{1}$
\end_inset

 作归一化：
\begin_inset Formula 
\begin{equation}
e_{1}=\frac{\phi_{1}}{\Vert\phi_{1}\Vert_{V_{i}}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
假设已得出前 
\begin_inset Formula $m-1$
\end_inset

 个正交归一化的基函数 
\begin_inset Formula $\left\{ e_{k}\right\} _{k=1}^{m-1}$
\end_inset

，那么构造 
\begin_inset Formula $e_{m}$
\end_inset

 只需先从 
\begin_inset Formula $\phi_{m}$
\end_inset

 中减去其在 
\begin_inset Formula $\left\{ e_{k}\right\} _{k=1}^{m-1}$
\end_inset

 上的投影，再对剩余部分作归一化：
\begin_inset Formula 
\begin{equation}
e_{m}=\frac{\phi_{m}-\sum_{k=1}^{m-1}e_{k}\langle e_{k}\vert\phi_{m}\rangle_{V_{i}}}{\left\Vert \phi_{m}-\sum_{k=1}^{m-1}e_{k}\langle e_{k}\vert\phi_{m}\rangle_{V_{i}}\right\Vert _{V_{i}}},\qquad m>1.\label{eq:ortho-normal}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
如果将所得结果记为
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}e_{1}(\vec{r})\\
e_{2}(\vec{r})\\
\vdots\\
e_{n}(\vec{r})
\end{bmatrix}}_{\underline{e}}=\underbrace{\begin{bmatrix}S_{11}\\
S_{21} & S_{22}\\
\vdots & \vdots & \ddots\\
S_{n1} & S_{n2} & \cdots & S_{nn}
\end{bmatrix}}_{\underline{S}}\underbrace{\begin{bmatrix}\phi_{1}(\vec{r})\\
\phi_{2}(\vec{r})\\
\vdots\\
\phi_{n}(\vec{r})
\end{bmatrix}}_{\underline{\phi}},
\end{equation}

\end_inset

那么 
\begin_inset Formula $\underline{S}$
\end_inset

 为下三角阵，其元素可逐行算出
\begin_inset CommandInset citation
LatexCommand cite
key "JYY_2021"
literal "false"

\end_inset

：
\end_layout

\begin_layout Itemize
第一行只需做归一化：
\begin_inset Formula 
\begin{equation}
S_{11}=\frac{1}{\Vert\phi_{1}\Vert_{V_{i}}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
假设已获得 
\begin_inset Formula $\underline{S}$
\end_inset

 的前 
\begin_inset Formula $m-1$
\end_inset

 行，将已知的
\begin_inset Formula 
\begin{equation}
e_{k}=\sum_{j=1}^{k}S_{kj}\phi_{j},\qquad k=1,2,\dots,m-1,\label{eq:partially_orthonormal}
\end{equation}

\end_inset

代入式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ortho-normal"

\end_inset

 右端的分子，可得
\begin_inset Formula 
\begin{equation}
\begin{aligned}\phi_{m}-\sum_{k=1}^{m-1}e_{k}\langle e_{k}\vert\phi_{m}\rangle_{V_{i}} & =\phi_{m}-\sum_{k=1}^{m-1}\left(\sum_{j=1}^{k}S_{kj}\phi_{j}\right)\ip{\sum_{l=1}^{k}S_{kl}\phi_{l}}{\phi_{m}}_{V_{i}}\\
 & =\phi_{m}-\sum_{k=1}^{m-1}\left(\sum_{j=1}^{k}S_{kj}\phi_{j}\right)\left(\sum_{l=1}^{k}S_{kl}\langle\phi_{l}\vert\phi_{m}\rangle_{V_{i}}\right)\\
 & =\sum_{j=1}^{m}a_{j}\phi_{j},
\end{aligned}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
a_{j}=\begin{cases}
-\sum_{k=1}^{m-1}\left(\sum_{l=1}^{k}S_{kl}\langle\phi_{l}\vert\phi_{m}\rangle_{V_{i}}\right)S_{kj}, & j<m;\\
1, & j=m.
\end{cases}
\end{equation}

\end_inset

最后对 
\begin_inset Formula $\sum_{j=1}^{m}a_{j}\phi_{j}$
\end_inset

 作归一化，即得 
\begin_inset Formula $\underline{S}$
\end_inset

 的第 
\begin_inset Formula $m$
\end_inset

 行：
\begin_inset Formula 
\begin{equation}
S_{mj}=\frac{a_{j}}{\left\Vert \sum_{j=1}^{m}a_{j}\phi_{j}\right\Vert _{V_{i}}}=\frac{a_{j}}{\sqrt{\sum_{j=1}^{m}\sum_{l=1}^{m}a_{j}a_{l}\langle\phi_{j}\vert\phi_{l}\rangle_{V_{i}}}},\qquad j=1,\dots,m.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
含有 
\begin_inset Formula $m$
\end_inset

 个成员的矩阵函数 
\begin_inset Formula $\underline{U}(\vec{r})=\begin{bmatrix}U_{1}(\vec{r}) & \cdots & U_{m}(\vec{r})\end{bmatrix}^{t}$
\end_inset

 可以用其在正交归一基底 
\begin_inset Formula $\underline{e}(\vec{r})=\begin{bmatrix}e_{1}(\vec{r}) & \cdots & e_{n}(\vec{r})\end{bmatrix}^{t}$
\end_inset

 上的投影来近似：
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}U_{1}^{h}(\vec{r})\\
\vdots\\
U_{m}^{h}(\vec{r})
\end{bmatrix}}_{\underline{U}^{h}(\vec{r})}=\underbrace{\begin{bmatrix}\langle U_{1}\vert e_{1}\rangle_{V_{i}} & \cdots & \langle U_{1}\vert e_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle U_{m}\vert e_{1}\rangle_{V_{i}} & \cdots & \langle U_{m}\vert e_{n}\rangle_{V_{i}}
\end{bmatrix}}_{\langle\underline{U}\vert\underline{e}\rangle_{V_{i}}}\underbrace{\begin{bmatrix}e_{1}(\vec{r})\\
\vdots\\
e_{n}(\vec{r})
\end{bmatrix}}_{\underline{e}(\vec{r})}.\label{eq:function_projection}
\end{equation}

\end_inset

这里的“近似”有两层含义：一是该式中的内积一般不能精确算出，二是有限维的多项式空间不足以精确表达任意函数。如果 
\begin_inset Formula $\underline{U}$
\end_inset

 的成员都是多项式，且计算内积所使用的数值积分器（详见 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:quadrature"

\end_inset

 小节）有足够高的代数精度，那么上述投影所得的 
\begin_inset Formula $\underline{U}^{h}$
\end_inset

 就是 
\begin_inset Formula $\underline{U}$
\end_inset

 的精确表示。
\end_layout

\begin_layout Standard
如果 
\begin_inset Formula $\underline{e'}(\vec{r})=\begin{bmatrix}e'_{1}(\vec{r}) & \cdots & e'_{n}(\vec{r})\end{bmatrix}^{t}$
\end_inset

 是另一组正交归一化的基底，那么原始基底 
\begin_inset Formula $\underline{E}$
\end_inset

 在新的基底 
\begin_inset Formula $\underline{E'}$
\end_inset

 上的投影为
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}e_{1}(\vec{r})\\
\vdots\\
e_{n}(\vec{r})
\end{bmatrix}}_{\underline{e^{h}}(\vec{r})}=\underbrace{\begin{bmatrix}\langle e_{1}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle e{}_{1}\vert e'_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle e_{n}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle e_{n}\vert e'_{n}\rangle_{V_{i}}
\end{bmatrix}}_{\langle\underline{e}\vert\underline{e'}\rangle_{V_{i}}}\underbrace{\begin{bmatrix}e'_{1}(\vec{r})\\
\vdots\\
e'_{n}(\vec{r})
\end{bmatrix}}_{\underline{e'}(\vec{r})}.
\end{equation}

\end_inset

原则上，该式中的内积都可以精确算出（被积函数都是多项式），因此该变换可以被视为是精确的（即 
\begin_inset Formula $\underline{e^{h}}$
\end_inset

 的上标 
\begin_inset Formula $h$
\end_inset

 可以省略）。将其代入式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:function_projection"

\end_inset

 即得 
\begin_inset Formula $\underline{U}$
\end_inset

 在 
\begin_inset Formula $\underline{e'}$
\end_inset

 上的投影：
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}U_{1}(\vec{r})\\
\vdots\\
U_{m}(\vec{r})
\end{bmatrix}}_{\underline{U}^{h}(\vec{r})}=\underbrace{\begin{bmatrix}\langle U_{1}\vert e_{1}\rangle_{V_{i}} & \cdots & \langle U_{1}\vert e_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle U_{m}\vert e_{1}\rangle_{V_{i}} & \cdots & \langle U_{m}\vert e_{n}\rangle_{V_{i}}
\end{bmatrix}\begin{bmatrix}\langle e_{1}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle e_{1}\vert e'_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle e_{n}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle e_{n}\vert e'_{n}\rangle_{V_{i}}
\end{bmatrix}}_{\langle\underline{U}\vert\underline{e'}\rangle_{V_{i}}}\underbrace{\begin{bmatrix}e'_{1}(\vec{r})\\
\vdots\\
e'_{n}(\vec{r})
\end{bmatrix}}_{\underline{e'}(\vec{r})}.
\end{equation}

\end_inset

由此得矩阵函数 
\begin_inset Formula $\underline{U}(\vec{r})$
\end_inset

 在两组正交归一基底上的投影系数之间的变换法则：
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}\langle U_{1}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle U_{1}\vert e'_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle U_{m}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle U_{m}\vert e'_{n}\rangle_{V_{i}}
\end{bmatrix}}_{\langle\underline{U}\vert\underline{e'}\rangle_{V_{i}}}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
=\underbrace{\begin{bmatrix}\langle U_{1}\vert e_{1}\rangle_{V_{i}} & \cdots & \langle U_{1}\vert e_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle U_{m}\vert e_{1}\rangle_{V_{i}} & \cdots & \langle U_{m}\vert e_{n}\rangle_{V_{i}}
\end{bmatrix}}_{\langle\underline{U}\vert\underline{e}\rangle_{V_{i}}}\underbrace{\begin{bmatrix}\langle e_{1}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle e_{1}\vert e'_{n}\rangle_{V_{i}}\\
\vdots & \ddots & \vdots\\
\langle e_{n}\vert e'_{1}\rangle_{V_{i}} & \cdots & \langle e_{n}\vert e'_{n}\rangle_{V_{i}}
\end{bmatrix}}_{\langle\underline{e}\vert\underline{e'}\rangle_{V_{i}}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
数值积分器
\begin_inset CommandInset label
LatexCommand label
name "subsec:quadrature"

\end_inset


\end_layout

\begin_layout Standard
当多项式空间 
\begin_inset Formula $\mathbb{P}^{<p}(V_{i})$
\end_inset

 选定后，基于正交基函数的多项式近似，即式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:function_projection"

\end_inset

 的精度就取决于
\begin_inset Formula 
\begin{equation}
\langle u_{j}\vert e_{k}\rangle=\int_{V_{i}}u_{j}(\vec{r})\,e_{k}(\vec{r}),\qquad\begin{cases}
j=1,2,\dots,m,\\
k=1,2,\dots,n,
\end{cases}
\end{equation}

\end_inset

的计算精度。如果 
\begin_inset Formula $u_{j}(\vec{r})$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上为不超过 
\begin_inset Formula $q$
\end_inset

 次的多项式，那么 
\begin_inset Formula $u_{j}e_{k}$
\end_inset

 为 
\begin_inset Formula $V_{i}$
\end_inset

 上不超过 
\begin_inset Formula $p+q$
\end_inset

 次的多项式，如果此时 
\begin_inset Formula $V_{i}$
\end_inset

 上的数值积分器有足够高的代数精度，那么有可能给出（浮点数意义下）精确的积分值。
\end_layout

\begin_layout Standard
在体单元 
\begin_inset Formula $V_{i}$
\end_inset

 上构造数值积分器，可以借用常规有限元法中的等参变换：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}x(\xi,\eta,\zeta)\\
y(\xi,\eta,\zeta)\\
z(\xi,\eta,\zeta)
\end{bmatrix}=\sum_{\mu}\begin{bmatrix}x_{\mu}\\
y_{\mu}\\
z_{\mu}
\end{bmatrix}N_{\mu}(\xi,\eta,\zeta),\label{eq:isoparametric}
\end{equation}

\end_inset

其中 
\begin_inset Formula $(x,y,z)$
\end_inset

 为全局坐标，
\begin_inset Formula $(\xi,\eta,\zeta)$
\end_inset

 为局部（参数）坐标；
\begin_inset Formula $N_{\mu}$
\end_inset

 为满足
\begin_inset Formula 
\begin{equation}
\begin{cases}
N_{\mu}(\xi_{\nu},\eta_{\nu},\zeta_{\nu})=\mathrm{\delta}_{\mu\nu}, & \forall(\mu,\nu),\\
\sum_{\mu}N_{\mu}(\xi,\eta,\zeta)=1, & \forall(\xi,\eta,\zeta),
\end{cases}
\end{equation}

\end_inset

的形函数，他们都是局部坐标 
\begin_inset Formula $(\xi,\eta,\zeta)$
\end_inset

 的多项式，且总数等于 
\begin_inset Formula $V_{i}$
\end_inset

 的结点总数。式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:isoparametric"

\end_inset

 定义了一种坐标变换，相应的雅可比矩阵
\begin_inset Formula 
\begin{equation}
\underline{J}=\begin{bmatrix}\partial x/\partial\xi & \partial x/\partial\eta & \partial x/\partial\zeta\\
\partial y/\partial\xi & \partial y/\partial\eta & \partial y/\partial\zeta\\
\partial z/\partial\xi & \partial z/\partial\eta & \partial z/\partial\zeta
\end{bmatrix}=\sum_{\mu}\begin{bmatrix}x_{\mu}\\
y_{\mu}\\
z_{\mu}
\end{bmatrix}\begin{bmatrix}\dfrac{\partial N_{\mu}}{\partial\xi} & \dfrac{\partial N_{\mu}}{\partial\eta} & \dfrac{\partial N_{\mu}}{\partial\zeta}\end{bmatrix},
\end{equation}

\end_inset

中的每一个偏导数亦为局部坐标 
\begin_inset Formula $(\xi,\eta,\zeta)$
\end_inset

 的多项式。因此，如果 
\begin_inset Formula $f(x,y,z)$
\end_inset

 是全局坐标 
\begin_inset Formula $(x,y,z)$
\end_inset

 的多项式，那么积分恒等式
\begin_inset Formula 
\begin{equation}
\begin{aligned}\int_{V_{i}}f(x,y,z) & =\iiint_{V_{i}}f(x,y,z)\dd{x}\dd{y}\dd{z}\\
 & =\iiint_{V_{i}}f(x(\xi,\eta,\zeta),y(\xi,\eta,\zeta),z(\xi,\eta,\zeta))\det\underline{J}\dd{\xi}\dd{\eta}\dd{\zeta}
\end{aligned}
\label{eq:volume_integral}
\end{equation}

\end_inset

最后一行的被积函数
\begin_inset Formula 
\begin{equation}
f(x(\xi,\eta,\zeta),y(\xi,\eta,\zeta),z(\xi,\eta,\zeta))\det\underline{J}\eqqcolon F(\xi,\eta,\zeta)
\end{equation}

\end_inset

亦为局部坐标 
\begin_inset Formula $(\xi,\eta,\zeta)$
\end_inset

 的多项式。原则上，只要数值积分器的代数精度足够高，就能精确算出其积分值。下面给出一种构造具有 
\begin_inset Formula $r$
\end_inset

 阶代数精度的 
\begin_inset Formula $q$
\end_inset

 点高斯型求积公式的通用方法。
\end_layout

\begin_layout Standard
所谓 
\begin_inset Formula $q$
\end_inset

 点高斯型求积公式，是指将式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:volume_integral"

\end_inset

 中的积分用如下的加权求和式近似：
\begin_inset Formula 
\begin{equation}
\iiint_{V_{i}}F(\xi,\eta,\zeta)\dd{\xi}\dd{\eta}\dd{\zeta}\approx\sum_{k=1}^{q}w_{k}\,F(\xi_{k},\eta_{k},\zeta_{k}),\label{eq:gaussian-quadrature}
\end{equation}

\end_inset

其中 
\begin_inset Formula $(\xi_{k},\eta_{k},\zeta_{k})$
\end_inset

 为第 
\begin_inset Formula $k$
\end_inset

 个积分点的参数坐标，
\begin_inset Formula $w_{k}$
\end_inset

 为该项对应的权重。如果该式对所有不超过 
\begin_inset Formula $r$
\end_inset

 次的单项式 
\begin_inset Formula $\xi^{a}\eta^{b}\zeta^{c}$
\end_inset

 都能给出精确的积分值，那么称其具有 
\begin_inset Formula $r$
\end_inset

 阶代数精度。假设体单元 
\begin_inset Formula $V_{i}$
\end_inset

 足够简单，以至于在参数坐标 
\begin_inset Formula $(\xi,\eta,\zeta)$
\end_inset

 下可以将体积分改写为三重积分：
\begin_inset Formula 
\begin{equation}
\iiint_{V_{i}}F(\xi,\eta,\zeta)\dd{\xi}\dd{\eta}\dd{\zeta}=\int_{\xi_{1}}^{\xi_{2}}\dd{\xi}\int_{\gamma(\eta)}^{\delta(\eta)}\dd{\eta}\int_{\alpha(\xi,\eta)}^{\beta(\xi,\eta)}\dd{\zeta}F(\xi,\eta,\zeta),\label{eq:triple-integral}
\end{equation}

\end_inset

其中 
\begin_inset Formula $\alpha,\beta,\gamma,\delta$
\end_inset

 均为 
\begin_inset Formula $\xi,\eta$
\end_inset

 的多项式。在上述假设下，式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:triple-integral"

\end_inset

 中的三重积分总是可以解析地算出。不失一般性，用记号
\begin_inset Formula 
\begin{equation}
I(a,b,c)\coloneqq\int_{\xi_{1}}^{\xi_{2}}\dd{\xi}\int_{\gamma(\eta)}^{\delta(\eta)}\dd{\eta}\int_{\alpha(\xi,\eta)}^{\beta(\xi,\eta)}\dd{\zeta}\xi^{a}\eta^{b}\zeta^{c}
\end{equation}

\end_inset

表示单项式 
\begin_inset Formula $\xi^{a}\eta^{b}\zeta^{c}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上积分的解析表达式。于是，求积公式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:gaussian-quadrature"

\end_inset

 具有 
\begin_inset Formula $r$
\end_inset

 阶代数精度，就可以表示为
\begin_inset Formula 
\begin{equation}
I(a,b,c)=\sum_{k=1}^{q}w_{k}\xi_{k}^{a}\eta_{k}^{b}\zeta_{k}^{c},\qquad\vert a+b+c\vert\le r.\label{eq:rth-order-gaussian}
\end{equation}

\end_inset

这是一组关于 
\begin_inset Formula $\left\{ w_{k},\xi_{k},\eta_{k},\zeta_{k}\right\} _{k=1}^{q}$
\end_inset

 共 
\begin_inset Formula $4q$
\end_inset

 个未知数的非线性代数方程组。要使其有解，需满足
\begin_inset Formula 
\begin{equation}
4q\le\binom{r+3}{3}=\frac{(r+3)(r+2)(r+1)}{6},
\end{equation}

\end_inset

不等式右端为方程的个数。方程组 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rth-order-gaussian"

\end_inset

 一般没有解析解，通常需要将其转化为以
\begin_inset Formula 
\begin{equation}
\left.\begin{array}{c}
w_{k}>0\\
\xi_{1}<\xi_{k}<\xi_{2}\\
\gamma(\eta_{k})<\eta_{k}<\delta(\eta_{k})\\
\alpha(\xi_{k},\eta_{k})<\zeta_{k}<\beta(\xi_{k},\eta_{k})
\end{array}\right\} ,\qquad k=1,2,\dots,q,
\end{equation}

\end_inset

为约束条件的最小值问题，例如：
\begin_inset Formula 
\begin{equation}
\min\sum_{a+b+c\le r}\left|I(a,b,c)-\sum_{k=1}^{q}w_{k}\xi_{k}^{a}\eta_{k}^{b}\zeta_{k}^{c}\right|,
\end{equation}

\end_inset

 或
\begin_inset Formula 
\begin{equation}
\min\sum_{a+b+c\le r}\left(I(a,b,c)-\sum_{k=1}^{q}w_{k}\xi_{k}^{a}\eta_{k}^{b}\zeta_{k}^{c}\right)^{2}.
\end{equation}

\end_inset

通用的优化算法一般会给出多组极小值解，而非单一的最小值解。但上述目标函数都是非负的，其最小值只能为零。因此，用优化方法寻找方程组 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rth-order-gaussian"

\end_inset

 的解，只应保留那些使得目标函数取值为零的极小值解。
\begin_inset Note Note
status open

\begin_layout Plain Layout
附录：三角形、四面体积分公式
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
有限元方程
\end_layout

\begin_layout Standard
以上各小节已经给出了寻找给定函数在给定非结构网格上的分段多项式近似的一般方法。在实际应用中，更有价值的是寻找满足给定微分方程及定解条件的未知函数，在给定非结构网
格上的分段多项式近似。本小节就来推导求解双曲型方程定解问题的间断伽辽金有限元法，该方法的并行实现（详见 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:parallel"

\end_inset

 小节）正是本文的主要工作内容。
\end_layout

\begin_layout Standard
定义在区域 
\begin_inset Formula $\varOmega$
\end_inset

 上、含 
\begin_inset Formula $N$
\end_inset

 个未知量的双曲型偏微分方程组
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{U}$"
description "表示双曲型方程组中的未知量列矩阵"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{\\vec{F}}$"
description "表示双曲型方程组中的以列矩阵为分量的通量向量"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{H}$"
description "表示双曲型方程组中的源项列矩阵"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\partial_{t}\underline{U}+\nabla\cdot\underline{\vec{F}}=\underline{H}\label{eq:PDE}
\end{equation}

\end_inset

等价于微分–积分方程
\begin_inset Formula 
\begin{equation}
\int_{V}\left(\partial_{t}\underline{U}+\nabla\cdot\underline{\vec{F}}\right)\psi=\int_{V}\psi\,\underline{H}
\end{equation}

\end_inset

在 
\begin_inset Formula $\forall V\subset\varOmega$
\end_inset

 上对任意充分光滑的函数 
\begin_inset Formula $\psi\colon\varOmega\to\mathbb{R}$
\end_inset

 都成立。经过一次分部积分并利用高斯散度定理可得
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{F}^{\\nu}$"
description "表示法向通量列矩阵"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{V}\left(\psi\,\partial_{t}\underline{U}-\underline{\vec{F}}\cdot\nabla\psi\right)+\oint_{\partial V}\psi\,\underbrace{\vec{\nu}\cdot\underline{\vec{F}}}_{\underline{F}^{\nu}}=\int_{V}\psi\,\underline{H},\label{eq:weak-form}
\end{equation}

\end_inset

该式对 
\begin_inset Formula $\underline{\vec{F}}$
\end_inset

 的光滑性要求低于式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:PDE"

\end_inset

，因此被称作弱形式。
\end_layout

\begin_layout Standard
取两组以 
\begin_inset Formula $V$
\end_inset

 为支集、在 
\begin_inset Formula $V$
\end_inset

 内充分光滑的函数 
\begin_inset Formula $\left\{ \phi_{k}\right\} _{k=1}^{K}$
\end_inset

 与 
\begin_inset Formula $\left\{ \psi_{l}\right\} _{l=1}^{L}$
\end_inset

 作为基，则 
\begin_inset Formula $\underline{U}$
\end_inset

 与 
\begin_inset Formula $\psi$
\end_inset

 可以分别近似为
\begin_inset Formula 
\begin{equation}
\underline{U}(\vec{r},t)\approx\underline{U}^{h}(\vec{r},t)=\sum_{k=1}^{K}\underline{\hat{U}}_{k}(t)\,\phi_{k}(\vec{r})\qquad\psi(\vec{r})\approx\psi^{h}(\vec{r})=\sum_{l=1}^{L}\hat{\psi}_{l}\,\psi_{l}(\vec{r})
\end{equation}

\end_inset

其中 
\begin_inset Formula $\left\{ \underline{\hat{U}}_{k}\right\} _{k=1}^{K}$
\end_inset

 为待定系数（列）矩阵，
\begin_inset Formula $\left\{ \hat{\psi}_{l}\right\} _{l=1}^{L}$
\end_inset

 为任意常数。将 
\begin_inset Formula $\underline{U}^{h}$
\end_inset

 与 
\begin_inset Formula $\psi^{h}$
\end_inset

 代入弱形式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:weak-form"

\end_inset

 可得
\begin_inset Formula 
\begin{equation}
\int_{V}\psi\,\partial_{t}\underline{U}\approx\int_{V}\psi^{h}\,\partial_{t}\underline{U}^{h}=\sum_{l}\hat{\psi}_{l}\left[\sum_{k}\langle\psi_{l}\vert\phi_{k}\rangle_{V}\dv{\underline{\hat{U}}_{k}}{t}\right],\label{eq:changing-rate}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{V}\underline{\vec{F}}\cdot\nabla\psi\approx\int_{V}\mathopen{\underline{\vec{F}}}\left(\underline{U}^{h}\right)\cdot\nabla\psi^{h}=\sum_{l}\hat{\psi}_{l}\left[\int_{V}\mathopen{\underline{\vec{F}}}\left(\underline{U}^{h}\right)\cdot\nabla\psi_{l}\right],\label{eq:internal-flux}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\oint_{\partial V}\psi\,\underline{F}^{\nu}\approx\oint_{\partial V}\psi^{h}\,\mathopen{\underline{F}^{\nu}}\left(\underline{U}^{h}\right)=\sum_{l}\hat{\psi}_{l}\left[\oint_{\partial V}\psi_{l}\,\mathopen{\underline{F}^{\nu}}\left(\underline{U}^{h}\right)\right],\label{eq:boundary-flux}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{V}\underline{H}\,\psi\approx\int_{V}\psi^{h}\,\mathopen{\underline{H}}\left(\underline{U}^{h}\right)=\sum_{l}\hat{\psi}_{l}\left[\int_{V}\psi_{l}\,\mathopen{\underline{H}}\left(\underline{U}^{h}\right)\right],\label{eq:source-term}
\end{equation}

\end_inset

其中 
\begin_inset Formula $\mathopen{\underline{F}^{\nu}}\left(\underline{U}^{h}\right)$
\end_inset

 为法向通量 
\begin_inset Formula $\underline{F}^{\nu}\coloneqq\vec{\nu}\cdot\underline{\vec{F}}$
\end_inset

 的近似值，通常取某种精确或近似黎曼解。式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:changing-rate"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:source-term"

\end_inset

 的右端都具有 
\begin_inset Formula $\sum_{l}\hat{\psi}_{l}\left[\cdots\right]$
\end_inset

 的形式，将它们代回式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:weak-form"

\end_inset

，合并同类项可得 
\begin_inset Formula $\sum_{l}\hat{\psi}_{l}\,\underline{X}_{l}$
\end_inset

 等于零（矩阵）。
\end_layout

\begin_layout Standard
考虑到 
\begin_inset Formula $\left\{ \hat{\psi}_{l}\right\} _{l=1}^{L}$
\end_inset

 的任意性，这里的每一个 
\begin_inset Formula $\underline{X}_{l}$
\end_inset

 都必须为零（矩阵），由此导出 
\begin_inset Formula $L$
\end_inset

 个方程：
\begin_inset Formula 
\begin{equation}
\sum_{k}\dv{\underline{\hat{U}}_{k}}{t}\langle\phi_{k}\vert\psi_{l}\rangle_{V}-\int_{V}\left(\nabla\psi_{l}\right)\cdot\mathopen{\underline{\vec{F}}}\left(\underline{U}^{h}\right)+\oint_{\partial V}\psi_{l}\,\mathopen{\underline{F}^{\nu}}\left(\underline{U}^{h}\right)=\int_{V}\psi_{l}\,\mathopen{\underline{H}}\left(\underline{U}^{h}\right).
\end{equation}

\end_inset

将它们排成 
\begin_inset Formula $L$
\end_inset

 列，可以整理为矩阵方程：
\begin_inset Formula 
\begin{equation}
\dv{\underline{\hat{U}}}{t}\,\underline{A}_{V}=\underline{R}_{V}-\underline{R}_{\partial V},
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}(t)\coloneqq\begin{bmatrix}\underline{\hat{U}}_{1}(t) & \cdots & \underline{\hat{U}}_{K}(t)\end{bmatrix}
\end{equation}

\end_inset

为 
\begin_inset Formula $N\times K$
\end_inset

 待定函数矩阵；
\begin_inset Formula 
\begin{equation}
\underline{A}_{V}\coloneqq\begin{bmatrix}\langle\phi_{1}\vert\psi_{1}\rangle_{V} & \cdots & \langle\phi_{1}\vert\psi_{L}\rangle_{V}\\
\vdots & \ddots & \vdots\\
\langle\phi_{K}\vert\psi_{1}\rangle_{V} & \cdots & \langle\phi_{K}\vert\psi_{L}\rangle_{V}
\end{bmatrix}\label{eq:coeff_matrix}
\end{equation}

\end_inset

为 
\begin_inset Formula $K\times L$
\end_inset

 常系数矩阵；
\begin_inset Formula 
\begin{equation}
\underline{R}_{V}\coloneqq\int_{V}\mathopen{\underline{\vec{F}}}\left(\underline{U}^{h}\right)\cdot\begin{bmatrix}\nabla\psi_{1} & \cdots & \nabla\psi_{L}\end{bmatrix}+\int_{V}\begin{bmatrix}\psi_{1} & \cdots & \psi_{L}\end{bmatrix}\mathopen{\underline{H}}\left(\underline{U}^{h}\right)
\end{equation}

\end_inset

为 
\begin_inset Formula $N\times L$
\end_inset

 矩阵，表示体积分残差
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{R}_{V}$"
description "表示 $V$ 上的体积分残差"
literal "true"

\end_inset

；
\begin_inset Formula 
\begin{equation}
\underline{R}_{\partial V}\coloneqq\oint_{\partial V}\begin{bmatrix}\psi_{1} & \cdots & \psi_{L}\end{bmatrix}\,\mathopen{\underline{F}^{\nu}}\left(\underline{U}^{h}\right)
\end{equation}

\end_inset

为 
\begin_inset Formula $N\times L$
\end_inset

 矩阵，表示面积分残差
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{R}_{\\partial V}$"
description "表示 $V$ 上的面积分残差"
literal "true"

\end_inset

。令 
\begin_inset Formula $V$
\end_inset

 取遍所有单元，即得最一般有限元方程：
\begin_inset Formula 
\begin{equation}
\dv{\underline{\hat{U}}}{t}\,\underline{A}_{V_{i}}=\underline{R}_{V_{i}}-\underline{R}_{\partial V_{i}},\qquad\forall V_{i}\in V_{G(\varOmega)}.\label{eq:FEM}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
间断伽辽金
\end_layout

\begin_layout Standard
上一小节只要求 
\begin_inset Formula $\left\{ \phi_{k}\right\} _{k=1}^{K}$
\end_inset

 与 
\begin_inset Formula $\left\{ \psi_{l}\right\} _{l=1}^{L}$
\end_inset

 这两组基函数同时以单元 
\begin_inset Formula $V_{i}$
\end_inset

 为支集，并且在 
\begin_inset Formula $V_{i}$
\end_inset

 上充分光滑。根据基函数取法的不同，可以将有限元法作如下分类：
\end_layout

\begin_layout Itemize
若相邻单元的基函数在边界上连续，则称此有限元法为“连续的 (scontinuous)”，否则称之为“间断的 (discontinuous)”。
\end_layout

\begin_layout Itemize
若 
\begin_inset Formula $K=L$
\end_inset

 且 
\begin_inset Formula $\phi_{k}\stackrel{\forall k}{=}\psi_{k}$
\end_inset

，则称此有限元法为“伽辽金 (Galerkin)”型有限元，否则称之为“彼得罗夫–伽辽金 (Petrov–Galerkin)”型有限元。
\end_layout

\begin_layout Standard
英文文献通常将“间断伽辽金”简记作 DG (discontinuous Galerkin)。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "DG"
symbol "DG"
description "discontinuous Galerkin"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
在 DG 有限元法中，式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:coeff_matrix"

\end_inset

 是 
\begin_inset Formula $K\times K$
\end_inset

 的满阵，每次解线性方程组都需要 
\begin_inset Formula $\order{K^{3}}$
\end_inset

 次浮点运算；即使缓存了 
\begin_inset Formula $\underline{A}_{V_{i}}^{-1}$
\end_inset

，每次计算向量–矩阵乘积 
\begin_inset Formula $\left(\underline{R}_{V_{i}}-\underline{R}_{\partial V_{i}}\right)\underline{A}_{V_{i}}^{-1}$
\end_inset

 仍需要 
\begin_inset Formula $\order{N^{2}}$
\end_inset

 次浮点运算。适当选取基函数可以显著提升性能：若 
\begin_inset Formula $\left\{ \phi_{k}\right\} _{k=1}^{K}$
\end_inset

 选取为 
\begin_inset Formula $V_{i}$
\end_inset

 上的正交基，即
\begin_inset Formula 
\begin{equation}
\ip{\phi_{k}}{\phi_{l}}\coloneqq\int_{V_{i}}\phi_{k}\,\phi_{l}=\ip{\phi_{k}}{\phi_{k}}\mathrm{\delta}_{kl},\qquad\forall k,\forall l,
\end{equation}

\end_inset

则 
\begin_inset Formula $\underline{A}_{V_{i}}$
\end_inset

 退化为对角阵，每次解线性方程组或计算向量–矩阵乘积只需要 
\begin_inset Formula $\order{K}$
\end_inset

 次浮点运算；若进一步将 
\begin_inset Formula $\left\{ \phi_{k}\right\} _{k=1}^{K}$
\end_inset

 取为归一化的正交基，即
\begin_inset Formula 
\begin{equation}
\ip{\phi_{k}}{\phi_{l}}\coloneqq\int_{V_{i}}\phi_{k}\,\phi_{l}=\mathrm{\delta}_{kl}\qquad\forall k,\forall l,
\end{equation}

\end_inset

则 
\begin_inset Formula $\underline{A}_{V_{i}}$
\end_inset

 退化退化为单位阵，可以从式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:FEM"

\end_inset

 中省去。前文（
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:orthonormal"

\end_inset

 小节）已经介绍了一种在单元 
\begin_inset Formula $V_{i}$
\end_inset

 上构造正交归一基函数的方法。当时引入该方法是为了寻找给定（已知）函数在 
\begin_inset Formula $V_{i}$
\end_inset

 上的最优多项式近似。这里体现了构造正交归一基函数的另一个好处。
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
值得……看似增加计算量……
\end_layout

\end_inset


\end_layout

\begin_layout Standard
本文采用上述正交归一基函数构造方法，因此式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:FEM"

\end_inset

 可以简化为
\begin_inset Formula 
\begin{equation}
\dv{\underline{\hat{U}}}{t}=\underline{R}_{V_{i}}-\underline{R}_{\partial V_{i}},\qquad\forall V_{i}\in V_{G(\varOmega)},\label{eq:orthonormal_DG}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}(t)\coloneqq\begin{bmatrix}\underline{\hat{U}}_{1}(t) & \cdots & \underline{\hat{U}}_{K}(t)\end{bmatrix}
\end{equation}

\end_inset

为 
\begin_inset Formula $N\times K$
\end_inset

 待定函数矩阵；
\begin_inset Formula 
\begin{equation}
\underline{R}_{V_{i}}\coloneqq\int_{V_{i}}\mathopen{\underline{\vec{F}}}\left(\underline{U}^{h}\right)\cdot\begin{bmatrix}\nabla\phi_{1} & \cdots & \nabla\phi_{K}\end{bmatrix}+\int_{V_{i}}\begin{bmatrix}\phi_{1} & \cdots & \phi_{K}\end{bmatrix}\mathopen{\underline{H}}\left(\underline{U}^{h}\right)
\end{equation}

\end_inset

为 
\begin_inset Formula $N\times L$
\end_inset

 矩阵，表示体积分残差；
\begin_inset Formula 
\begin{equation}
\underline{R}_{\partial V_{i}}\coloneqq\oint_{\partial V_{i}}\begin{bmatrix}\phi_{1} & \cdots & \phi_{L}\end{bmatrix}\,\mathopen{\underline{F}^{\nu}}\left(\underline{U}^{h}\right)\label{eq:boundary_residual}
\end{equation}

\end_inset

为 
\begin_inset Formula $N\times L$
\end_inset

 矩阵，表示面积分残差。式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:orthonormal_DG"

\end_inset

 是一个常微分方程组，它的求解方法将在 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:RK"

\end_inset

 节给出。
\end_layout

\begin_layout Section
保持强稳定性的 RK 时间推进格式
\begin_inset CommandInset label
LatexCommand label
name "sec:RK"

\end_inset


\end_layout

\begin_layout Standard
《
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:DG"
plural "false"
caps "false"
noprefix "false"

\end_inset

》节最后给出的式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:orthonormal_DG"

\end_inset

 是一个待求解的常微分方程组，其中右端项依赖于待定未知量，不妨将其记作
\begin_inset Formula 
\begin{equation}
\frac{\dd}{\dd t}\underline{\hat{U}}=\underline{\hat{R}},\qquad\underline{\hat{R}}\coloneqq\underline{R}(\underline{\hat{U}}).
\end{equation}

\end_inset

其左侧的时间导数原则上可以做有限差分近似；考虑到时间变量 
\begin_inset Formula $t$
\end_inset

 是单调递增的，时间格式应当具有向前“推进 (marching)”的特点：
\end_layout

\begin_layout Itemize
变量 
\begin_inset Formula $\underline{\hat{U}}$
\end_inset

 在下一时间步 
\begin_inset Formula $t_{n+1}$
\end_inset

 的值 
\begin_inset Formula $\underline{\hat{U}}^{n+1}$
\end_inset

 由变量在当前及之前各时间步的值计算而得。
\end_layout

\begin_layout Itemize
如果计算 
\begin_inset Formula $\underline{\hat{U}}^{n+1}$
\end_inset

 只需用到当前时间步 
\begin_inset Formula $t_{n}$
\end_inset

 的值 
\begin_inset Formula $\underline{\hat{U}}^{n}$
\end_inset

，则称其为单步格式，否则称之为多步格式。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{\\hat{U}}^{n}$"
description "表示 $\\underline{\\hat{U}}$ 第 $n$ 时间步的值"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{\\hat{R}}^{n}$"
description "表示 $\\underline{R}(\\underline{\\hat{U}})$ 在第 $n$ 时间步的值"
literal "true"

\end_inset


\end_layout

\begin_layout Itemize
如果计算 
\begin_inset Formula $\underline{\hat{U}}^{n+1}$
\end_inset

 时，右端项不依赖于 
\begin_inset Formula $\underline{\hat{U}}^{n+1}$
\end_inset

，则称其为显示推进格式，否则称之为隐式推进格式。
\end_layout

\begin_deeper
\begin_layout Itemize
显示推进格式可以直接代入公式计算，编程实现更简单，但对时间步长的要求相对苛刻。
\end_layout

\begin_layout Itemize
隐式推进格式需要求解关于 
\begin_inset Formula $\underline{\hat{U}}^{n+1}$
\end_inset

 的代数方程组，编程实现更复杂，但对时间步长的要求相对宽松。
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsection
一阶格式
\end_layout

\begin_layout Standard
采用一阶向前差分近似时间导数：
\begin_inset Formula 
\begin{equation}
\frac{\underline{\hat{U}}^{n+1}-\underline{\hat{U}}^{n}}{h_{t}}\approx\frac{\dd}{\dd t}\underline{\hat{U}}^{n}=\underline{\hat{R}}^{n},
\end{equation}

\end_inset

就得到显式欧拉格式：
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$h_t$"
description "表示时间步长"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}^{n+1}=\underline{\hat{U}}^{n}+h_{t}\underline{\hat{R}}^{n}.\label{eq:Euler}
\end{equation}

\end_inset

它是最简单的显式推进格式。
\end_layout

\begin_layout Standard
采用一阶向后差分近似时间导数：
\begin_inset Formula 
\begin{equation}
\frac{\underline{\hat{U}}^{n+1}-\underline{\hat{U}}^{n}}{h_{t}}\approx\frac{\dd}{\dd t}\underline{\hat{U}}^{n+1}=\underline{\hat{R}}^{n+1},
\end{equation}

\end_inset

就得到隐式欧拉格式：
\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}^{n+1}=\underline{\hat{U}}^{n}+h_{t}\underline{\hat{R}}^{n+1}.
\end{equation}

\end_inset

它是最简单的隐式推进格式。
\end_layout

\begin_layout Standard
以上两种欧拉格式都只有一阶时间精度。
\end_layout

\begin_layout Subsection
高阶格式
\end_layout

\begin_layout Standard
显式 Runge–Kutta (RK) 格式
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "RK"
description "Runge–Kutta"
literal "true"

\end_inset

是一族高阶推进格式，最一般的形式为
\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}^{n+i/m}=\sum_{k=0}^{i-1}\left(\alpha_{i,k}\underline{\hat{U}}^{n+k/m}+\beta_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}\right),\qquad i=1,\dots,m\label{eq:RKm}
\end{equation}

\end_inset

其中 
\begin_inset Formula $\sum_{k=0}^{i-1}\alpha_{i,k}=1$
\end_inset

 对所有 
\begin_inset Formula $i$
\end_inset

 都成立。本文选用以下版本：
\end_layout

\begin_layout Description
一阶 同显式欧拉格式，即
\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}^{n+1}=\underline{\hat{U}}^{n}+h_{t}\underline{\hat{R}}^{n};\label{eq:RK1}
\end{equation}

\end_inset


\end_layout

\begin_layout Description
二阶 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\underline{\hat{U}}^{n+1/2} & =\underline{\hat{U}}^{n}+h_{t}\underline{\hat{R}}^{n},\\
\underline{\hat{U}}^{n+1}\equiv\underline{\hat{U}}^{n+2/2} & =\frac{1}{2}\underline{\hat{U}}^{n}+\frac{1}{2}\left(\underline{\hat{U}}^{n+1/2}+h_{t}\underline{\hat{R}}^{n+1/2}\right);
\end{aligned}
\label{eq:RK2}
\end{equation}

\end_inset


\end_layout

\begin_layout Description
三阶 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\underline{\hat{U}}^{n+1/3} & =\underline{\hat{U}}^{n}+h_{t}\underline{\hat{R}}^{n},\\
\underline{\hat{U}}^{n+2/3} & =\frac{3}{4}\underline{\hat{U}}^{n}+\frac{1}{4}\left(\underline{\hat{U}}^{n+1/3}+h_{t}\underline{\hat{R}}^{n+1/3}\right),\\
\underline{\hat{U}}^{n+1}\equiv\underline{\hat{U}}^{n+3/3} & =\frac{1}{3}\underline{\hat{U}}^{n}+\frac{2}{3}\left(\underline{\hat{U}}^{n+2/3}+h_{t}\underline{\hat{R}}^{n+2/3}\right).
\end{aligned}
\label{eq:RK3}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsection
强稳定性
\end_layout

\begin_layout Standard
设 
\begin_inset Formula $\Vert\cdots\Vert$
\end_inset

 是某种矩阵范数。若存在非负常数 
\begin_inset Formula $C$
\end_inset

 使得
\begin_inset Formula 
\begin{equation}
\Vert\underline{\hat{U}}^{n}\Vert\le C\Vert\underline{\hat{U}}^{0}\Vert,\qquad\forall n\in\mathbb{N},
\end{equation}

\end_inset

则称该格式具有稳定性。若上述 
\begin_inset Formula $C\le1$
\end_inset

，则称该格式具有强稳定性。可以证明：当时间步长足够小时，显式欧拉格式具有强稳定性。若高阶格式可以保持这种强稳定性，则称其为“保持强稳定性的 (strong
 stability preserving, SSP)”格式。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "SSP"
description "strong stability preserving"
literal "true"

\end_inset


\end_layout

\begin_layout Lemma
若式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RKm"

\end_inset

 中的所有 
\begin_inset Formula $\alpha_{i,k}$
\end_inset

 和 
\begin_inset Formula $\beta_{i,k}$
\end_inset

 都非负，且满足
\begin_inset Formula 
\begin{equation}
h_{t}\le ch_{t}^{\mathrm{E.E.}},\qquad c=\min_{i,k}\frac{\alpha_{i,k}}{\beta_{i,k}},
\end{equation}

\end_inset

则其为 SSP 格式。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$h_{t}^{\\mathrm{E.E.}}$"
description "表示显示欧拉格式的时间步长"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Proof
满足上述条件时，每个中间步的 
\begin_inset Formula $\underline{\hat{U}}^{n+i/m}$
\end_inset

 都可以分解为若干显式欧拉格式的凸组合：
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left\Vert \underline{\hat{U}}^{n+i/m}\right\Vert  & =\left\Vert \sum_{k=0}^{i-1}\alpha_{i,k}\left(\underline{\hat{U}}^{n+k/m}+\frac{\beta_{i,k}}{\alpha_{i,k}}h_{t}\underline{\hat{R}}^{n+k/m}\right)\right\Vert \\
 & \le\sum_{k=0}^{i-1}\alpha_{i,k}\left\Vert \underline{\hat{U}}^{n+k/m}+\frac{\beta_{i,k}}{\alpha_{i,k}}h_{t}\underline{\hat{R}}^{n+k/m}\right\Vert 
\end{aligned}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\frac{\beta_{i,k}}{\alpha_{i,k}}h_{t}\le\frac{\beta_{i,k}}{\alpha_{i,k}}ch_{t}^{\mathrm{E.E.}}\le\frac{\beta_{i,k}}{\alpha_{i,k}}\frac{\alpha_{i,k}}{\beta_{i,k}}h_{t}^{\mathrm{E.E.}}=h_{t}^{\mathrm{E.E.}},\qquad\forall(i,k),
\end{equation}

\end_inset

满足显式欧拉格式的强稳定性条件，因此有
\begin_inset Formula 
\begin{equation}
\left\Vert \underline{\hat{U}}^{n+k/m}+\frac{\beta_{i,k}}{\alpha_{i,k}}h_{t}\underline{\hat{R}}^{n+k/m}\right\Vert \le\left\Vert \underline{\hat{U}}^{n+k/m}\right\Vert ,\qquad\forall k=0,1,\dots,i-1.
\end{equation}

\end_inset

从而有
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left\Vert \underline{\hat{U}}^{n+i/m}\right\Vert  & \le\sum_{k=0}^{i-1}\alpha_{i,k}\left\Vert \underline{\hat{U}}^{n+k/m}+\frac{\beta_{i,k}}{\alpha_{i,k}}h_{t}\underline{\hat{R}}^{n+k/m}\right\Vert \\
 & \le\sum_{k=0}^{i-1}\alpha_{i,k}\left\Vert \underline{\hat{U}}^{n+k/m}\right\Vert .
\end{aligned}
\end{equation}

\end_inset

据此有
\begin_inset Formula 
\begin{equation}
\left\Vert \underline{\hat{U}}^{n+1/m}\right\Vert \le\sum_{k=0}^{0}\alpha_{1,0}\left\Vert \underline{\hat{U}}^{n+0/m}\right\Vert =\left\Vert \underline{U}^{n}\right\Vert ,
\end{equation}

\end_inset

从而可以递归地证明
\begin_inset Formula 
\begin{equation}
\left\Vert \underline{\hat{U}}^{n+i/m}\right\Vert \le\sum_{k=0}^{i-1}\alpha_{i,k}\left\Vert \underline{\hat{U}}^{n+k/m}\right\Vert \le\sum_{k=0}^{i-1}\alpha_{i,k}\left\Vert \underline{\hat{U}}^{n}\right\Vert =\left\Vert \underline{\hat{U}}^{n}\right\Vert .
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Lemma
一般的显式 RK 格式
\begin_inset Formula 
\begin{equation}
\underline{\hat{U}}^{n+i/m}=\underline{\hat{U}}^{n}+\sum_{k=0}^{i-1}\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m},\qquad i=1,2,\dots,m,
\end{equation}

\end_inset

可以改写为式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RKm"

\end_inset

 的形式，其中 
\begin_inset Formula $\sum_{k=0}^{i-1}\alpha_{i,k}=1$
\end_inset

 且
\begin_inset Formula 
\begin{equation}
\alpha_{i,k}\ge0,\qquad\beta_{i,k}=\begin{cases}
\gamma_{i,k}-\sum_{l=k+1}^{i-1}\alpha_{i,l}\gamma_{l,k}, & k=0,1,\dots,i-2;\\
\gamma_{i,k} & k=i-1.
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Proof
令 
\begin_inset Formula $\sum_{k=0}^{i-1}\alpha_{i,k}=1$
\end_inset

 且
\begin_inset Formula 
\begin{equation}
\alpha_{i,k}\ge0,\qquad k=0,1,\dots,i-1.
\end{equation}

\end_inset

则
\begin_inset Formula 
\begin{equation}
\begin{aligned}\underline{\hat{U}}^{n+i/m} & =\underline{\hat{U}}^{n}+\sum_{k=0}^{i-1}\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}=\underbrace{\left(\sum_{k=0}^{i-1}\alpha_{i,k}\right)}_{=1}\underline{\hat{U}}^{n}+\sum_{k=0}^{i-1}\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}\\
 & =\alpha_{i,0}\underline{U}^{n}+\sum_{k=1}^{i-1}\alpha_{i,k}\underbrace{\left(\underline{\hat{U}}^{n+k/m}-\sum_{l=0}^{k-1}\gamma_{k,l}h_{t}\underline{\hat{R}}^{n+l/m}\right)}_{=\underline{U}^{n}}+\sum_{k=0}^{i-1}\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}\\
 & =\underbrace{\left(\alpha_{i,0}\underline{\hat{U}}^{n+0/m}+\sum_{k=1}^{i-1}\alpha_{i,k}\underline{\hat{U}}^{n+k/m}\right)}_{\sum_{k=0}^{i-1}\alpha_{i,k}\underline{U}^{n+k/m}}\\
 & +\sum_{k=0}^{i-1}\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}-\sum_{k=1}^{i-1}\sum_{l=0}^{k-1}\alpha_{i,k}\gamma_{k,l}h_{t}\underline{\hat{R}}^{n+l/m},
\end{aligned}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\begin{aligned}\sum_{k=1}^{i-1}\sum_{l=0}^{k-1}\alpha_{i,k}\gamma_{k,l}h_{t}\underline{\hat{R}}^{n+l/m} & =\sum_{l=0}^{i-2}\sum_{k=l+1}^{i-1}\alpha_{i,k}\gamma_{k,l}h_{t}\underline{\hat{R}}^{n+l/m}=\sum_{k=0}^{i-2}\sum_{l=k+1}^{i-1}\alpha_{i,l}\gamma_{l,k}h_{t}\underline{\hat{R}}^{n+k/m}.\end{aligned}
\end{equation}

\end_inset

因此
\begin_inset Formula 
\begin{equation}
\begin{aligned}\underline{\hat{U}}^{n+i/m} & =\sum_{k=0}^{i-1}\alpha_{i,k}\underline{\hat{U}}^{n+k/m}-\sum_{k=0}^{i-2}\sum_{l=k+1}^{i-1}\alpha_{i,l}\gamma_{l,k}h_{t}\underline{\hat{R}}^{n+k/m}+\sum_{k=0}^{i-1}\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}\\
 & =\sum_{k=0}^{i-2}\left(\alpha_{i,k}\underline{\hat{U}}^{n+k/m}+\left(\gamma_{i,k}-\sum_{l=k+1}^{i-1}\alpha_{i,l}\gamma_{l,k}\right)h_{t}\underline{\hat{R}}^{n+k/m}\right)\\
 & +\sum_{k=i-1}^{i-1}\left(\alpha_{i,k}\underline{\hat{U}}^{n+k/m}+\gamma_{i,k}h_{t}\underline{\hat{R}}^{n+k/m}\right).
\end{aligned}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
强稳定保持的概念以及上述引理，是由 Shu 等提出并发展的
\begin_inset CommandInset citation
LatexCommand citet
key "Gottlieb_1998,Gottlieb_2001"
literal "false"

\end_inset

。原始文献中的推导过程较为简略，这里尽量补全了被省去的步骤。
\end_layout

\begin_layout Standard
并非所有 RK 格式都能保持强稳定性。例如：文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Hirsch_2007"
literal "false"

\end_inset

 给出的四阶 RK 格式
\begin_inset Formula 
\begin{equation}
\begin{aligned}\underline{\hat{U}}^{n+1/4} & =\underline{\hat{U}}^{n}+\frac{h_{t}}{2}\underline{\hat{R}}^{n},\\
\underline{\hat{U}}^{n+2/4} & =\underline{\hat{U}}^{n}+\frac{h_{t}}{2}\underline{\hat{R}}^{n+1/4},\\
\underline{\hat{U}}^{n+3/4} & =\underline{\hat{U}}^{n}+h_{t}\underline{\hat{R}}^{n+2/4},\\
\underline{\hat{U}}^{n+1}\equiv\underline{\hat{U}}^{n+4/4} & =\underline{\hat{U}}^{n}+\frac{h_{t}}{6}\left(\underline{\hat{R}}^{n}+2\underline{\hat{R}}^{n+1/4}+2\underline{\hat{R}}^{n+2/4}+\underline{\hat{R}}^{n+3/4}\right),
\end{aligned}
\end{equation}

\end_inset

改写为式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RKm"

\end_inset

 的形式后
\begin_inset Note Note
status open

\begin_layout Plain Layout
给出具体形式
\end_layout

\end_inset

，并非所有 
\begin_inset Formula $\alpha_{i,k}$
\end_inset

 与 
\begin_inset Formula $\beta_{i,k}$
\end_inset

 都非负，因此不是 SSP 格式。
\begin_inset Note Note
status open

\begin_layout Plain Layout
给出反例
\end_layout

\end_inset


\end_layout

\begin_layout Standard
本文选用式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RK1"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RK3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 作为时间推进格式，正是因为它们是 SSP 格式。为明确区分时间离散与空间离散的阶数，本文把用 
\begin_inset Formula $p$
\end_inset

 阶 (SSP) RK 格式做时间推进、用 
\begin_inset Formula $q$
\end_inset

 阶 DG 有限元法做空间离散的具体格式称为“RK
\begin_inset Formula $p$
\end_inset

/DG
\begin_inset Formula $q$
\end_inset

 格式”，并称基于该格式的求解器、近似解为“RK
\begin_inset Formula $p$
\end_inset

/DG
\begin_inset Formula $q$
\end_inset

 求解器、近似解”；称构造这些格式的方法为“RKDG 方法”。若时空精度皆为 
\begin_inset Formula $p$
\end_inset

，则“RK
\begin_inset Formula $p$
\end_inset

/DG
\begin_inset Formula $q$
\end_inset

”（格式、求解器、近似解）也可简称为“
\begin_inset Formula $p$
\end_inset

 阶 RKDG”（格式、求解器、近似解）。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "RKDG"
description "Runge--Kutta discontinuous Galerkin"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "RK$p$/DG$q$"
description "$p$th order Runge–Kutta and $q$th order discontinuous Galerkin"
literal "true"

\end_inset


\end_layout

\begin_layout Section
模拟桨叶对流场扰动的非定常动量源
\begin_inset CommandInset label
LatexCommand label
name "sec:UMS"

\end_inset


\end_layout

\begin_layout Standard
前文已经给出了用 RKDG 方法 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:orthonormal_DG"

\end_inset

 来求解含源项的双曲型方程组 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:PDE"

\end_inset

 的一般过程。在该方法中，源项只出现在体积分中，具体形式为
\begin_inset Formula 
\begin{equation}
\int_{V_{i}}\begin{bmatrix}\phi_{1} & \cdots & \phi_{K}\end{bmatrix}\mathopen{\underline{H}}\left(\underline{U}^{h}\right).
\end{equation}

\end_inset

本文不考虑质量源与能量源，故该式实际需要计算的是计算基函数 
\begin_inset Formula $\phi_{k}$
\end_inset

 与动量源 
\begin_inset Formula $\vec{b}$
\end_inset

 的乘积在 
\begin_inset Formula $V_{i}$
\end_inset

 上体积分：
\begin_inset Formula 
\begin{equation}
\int_{V_{i}}\phi_{k}(\vec{r})\,\vec{b}(\vec{r}).
\end{equation}

\end_inset

本节给出将体现旋翼气动效应的一种“非定常动量源 (unsteady momentum source, UMS)”模型
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "unsteady momentum source"
description "UMS"
literal "true"

\end_inset

嵌入既有的 RKDG 格式，从而获得 UMS–RKDG 格式的具体过程。
\end_layout

\begin_layout Subsection
外力密度
\end_layout

\begin_layout Standard
直升机旋翼的桨叶具有较大的展弦比，其对空气的作用力可以近似为集中于桨叶轴线。为避免混淆，本文以 
\begin_inset Formula $\vec{b}_{\mathrm{V}}$
\end_inset

 表示外力的体密度
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\vec{b}_{\\mathrm{V}}$"
description "表示单位体积气体所受到的外力"
literal "true"

\end_inset

，以 
\begin_inset Formula $\vec{b}_{\mathrm{L}}$
\end_inset

 表示外力的线密度
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\vec{b}_{\\mathrm{L}}$"
description "表示单位长度气体所受到的外力"
literal "true"

\end_inset

：
\end_layout

\begin_layout Itemize
含动量源的三维欧拉方程可以写成
\begin_inset Formula 
\begin{equation}
\partial_{t}\begin{bmatrix}\rho\\
\rho\vec{u}\\
\rho e_{0}
\end{bmatrix}+\nabla\cdot\begin{bmatrix}\rho\vec{u}\\
\rho\vec{u}\otimes\vec{u}\\
\rho h_{0}\vec{u}
\end{bmatrix}=\begin{bmatrix}0\\
\vec{b}_{\mathrm{V}}-\nabla p\\
0
\end{bmatrix},
\end{equation}

\end_inset

其中，
\begin_inset Formula $\vec{b}_{\mathrm{V}}$
\end_inset

 为单位体积气体所受到的外力，即 
\begin_inset Formula $\vec{b}_{\mathrm{V}}(\vec{r})$
\end_inset

 表示气体所受外力在 
\begin_inset Formula $\vec{r}$
\end_inset

 处的体密度。
\end_layout

\begin_layout Itemize
展向弧长 
\begin_inset Formula $s$
\end_inset

 处的微翼段 
\begin_inset Formula $[s,s+\dd{s})$
\end_inset

 所受到的气动力为
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$s$"
description "表示桨叶弦长参数"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{bmatrix}L\dd{s}\\
D\dd{s}
\end{bmatrix}=\frac{1}{2}\rho(u^{2}+w^{2})\begin{bmatrix}C_{L}(\alpha)\\
C_{D}(\alpha)
\end{bmatrix}c\dd{s},
\end{equation}

\end_inset

其中，
\begin_inset Formula $L$
\end_inset

 与 
\begin_inset Formula $D$
\end_inset

 分别为升力与阻力的线密度
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$C_L$"
description "表示翼型升力系数"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$C_D$"
description "表示翼型阻力系数"
literal "true"

\end_inset

。根据牛顿第三定律，该气动力的反作用力，就是微翼段对气体的作用力，故
\begin_inset Formula 
\begin{equation}
\vec{b}_{\mathrm{L}}(\vec{r}(s))=-\begin{bmatrix}\vec{e}_{L}(s) & \vec{e}_{D}(s)\end{bmatrix}\begin{bmatrix}L(s)\\
D(s)
\end{bmatrix}
\end{equation}

\end_inset

表示气体所受外力在展向弧长 
\begin_inset Formula $s$
\end_inset

 处的线密度。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsection
沿桨叶展向积分
\end_layout

\begin_layout Standard
设
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\overrightarrow{PQ}$"
description "表示点 $P$ 到点 $Q$ 的有向线段"
literal "true"

\end_inset

线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 与顶点为 
\begin_inset Formula $ABCD$
\end_inset

 的四面体单元 
\begin_inset Formula $V_{i}$
\end_inset

 的公共部分为线段 
\begin_inset Formula $\overrightarrow{RS}$
\end_inset

，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PQ"

\end_inset

 (a) 所示。这里允许 
\begin_inset Formula $P=R$
\end_inset

 或 
\begin_inset Formula $Q=S$
\end_inset

，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PQ"

\end_inset

 (b) (c) 所示。
\begin_inset Formula $\overrightarrow{RS}$
\end_inset

 的求法在下一小节给出。
\end_layout

\begin_layout Standard
基函数 
\begin_inset Formula $\phi_{k}(\vec{r})$
\end_inset

 定义在单元 
\begin_inset Formula $V_{i}$
\end_inset

 上，则其与外力体密度的乘积 
\begin_inset Formula $\phi_{k}\,\vec{b}_{\mathrm{V}}$
\end_inset

 在单元 
\begin_inset Formula $V_{i}$
\end_inset

 上的体积分，可以转化为其与外力线密度的乘积 
\begin_inset Formula $\phi_{k}\,\vec{b}_{\mathrm{L}}$
\end_inset

 在线段 
\begin_inset Formula $\overrightarrow{RS}$
\end_inset

 上的线积分：
\begin_inset Formula 
\begin{equation}
\int_{V_{i}}\phi_{k}(\vec{r})\,\vec{b}_{\mathrm{V}}(\vec{r})=\int_{\overrightarrow{RS}}\phi_{k}(\vec{r})\,\vec{b}_{\mathrm{L}}(\vec{r}).\label{eq:body_force}
\end{equation}

\end_inset

线段 
\begin_inset Formula $\overrightarrow{RS}$
\end_inset

 是可参数化的曲线，故后者可借助曲线参数 
\begin_inset Formula $\xi$
\end_inset

 化为定积分：
\begin_inset Formula 
\begin{equation}
\int_{\overrightarrow{RS}}\phi_{k}(\vec{r})\,\vec{b}_{\mathrm{L}}(\vec{r})=\int_{\xi_{R}}^{\xi_{S}}\phi_{k}(\vec{r}(\xi))\,\vec{b}_{\mathrm{L}}(\vec{r}(\xi))\left\Vert \frac{\partial\vec{r}}{\partial\xi}\right\Vert \dd{\xi},
\end{equation}

\end_inset

后者可以用标准的高斯求积公式计算。
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/PQ.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PQ"

\end_inset

线段穿过四面体单元的几种常见情形
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
桨叶与体单元求交
\end_layout

\begin_layout Standard
求线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 与四面体 
\begin_inset Formula $ABCD$
\end_inset

 的公共部分，可以归结为求线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 的公共点。设
\begin_inset Formula 
\begin{equation}
\overrightarrow{PQ}=\lambda_{A}\overrightarrow{PA}+\lambda_{B}\overrightarrow{PB}+\lambda_{C}\overrightarrow{PC},
\end{equation}

\end_inset

即
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}(PQ)_{x}\\
(PQ)_{y}\\
(PQ)_{z}
\end{bmatrix}=\begin{bmatrix}(PA)_{x} & (PB)_{x} & (PC)_{x}\\
(PA)_{y} & (PB)_{y} & (PC)_{y}\\
(PA)_{z} & (PB)_{z} & (PC)_{z}
\end{bmatrix}\begin{bmatrix}\lambda_{A}\\
\lambda_{B}\\
\lambda_{C}
\end{bmatrix}\label{eq:segment_triangle_intersection}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
若点 
\begin_inset Formula $P$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 不共面，即
\begin_inset Formula 
\begin{equation}
\det\begin{bmatrix}(PA)_{x} & (PB)_{x} & (PC)_{x}\\
(PA)_{y} & (PB)_{y} & (PC)_{y}\\
(PA)_{z} & (PB)_{z} & (PC)_{z}
\end{bmatrix}\ne0,
\end{equation}

\end_inset

则关于 
\begin_inset Formula $\lambda_{A},\lambda_{B},\lambda_{C}$
\end_inset

 的方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:segment_triangle_intersection"

\end_inset

 有唯一解。
\end_layout

\begin_deeper
\begin_layout Itemize
若 
\begin_inset Formula $\lambda_{A},\lambda_{B},\lambda_{C}$
\end_inset

 均为正数，则直线 
\begin_inset Formula $PQ$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 有唯一的交点 
\begin_inset Formula $R$
\end_inset

，且位于 
\begin_inset Formula $\triangle ABC$
\end_inset

 内部：
\begin_inset Formula 
\begin{equation}
\overrightarrow{PR}=\frac{\overrightarrow{PQ}}{\lambda_{A}+\lambda_{B}+\lambda_{C}}
\end{equation}

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
若还有 
\begin_inset Formula $\lambda_{A}+\lambda_{B}+\lambda_{C}>1$
\end_inset

，则点 
\begin_inset Formula $R$
\end_inset

 为线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 的交点，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PQ"

\end_inset

 (a) 所示。
\end_layout

\begin_layout Itemize
否则，点 
\begin_inset Formula $R$
\end_inset

 位于线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 的延长线上，不是线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 的交点。
\end_layout

\end_deeper
\begin_layout Itemize
否则，线段 
\begin_inset Formula $\overrightarrow{PQ}$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 所属平面有唯一的交点，但不在 
\begin_inset Formula $\triangle ABC$
\end_inset

 内。
\end_layout

\end_deeper
\begin_layout Itemize
否则，判断点 
\begin_inset Formula $Q$
\end_inset

 是否与 
\begin_inset Formula $\triangle ABC$
\end_inset

 共面。
\end_layout

\begin_deeper
\begin_layout Itemize
若点 
\begin_inset Formula $Q$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 不共面，则点 
\begin_inset Formula $P$
\end_inset

 是直线 
\begin_inset Formula $PQ$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 所属平面的唯一交点。
\end_layout

\begin_layout Itemize
否则，直线 
\begin_inset Formula $PQ$
\end_inset

 与 
\begin_inset Formula $\triangle ABC$
\end_inset

 共面，但可能与 
\begin_inset Formula $\triangle ABC$
\end_inset

 没有公共点，需进一步讨论。
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Section
间断、数值振荡与 WENO 重构技术
\begin_inset CommandInset label
LatexCommand label
name "sec:WENO"

\end_inset


\end_layout

\begin_layout Standard
双曲型方程（组）的广义解允许出现间断，按物理性质可以分为三类：
\end_layout

\begin_layout Description
激波 可以用厚度为零的控制体表示；物理量在其两侧的值有跳跃，因此是一种强间断；熵的值在其两侧有跳跃。一维激波的特征线呈汇聚状，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock"

\end_inset

 所示。
\end_layout

\begin_layout Description
膨胀波 可以用有限厚度的控制体表示；物理量在其内部光滑，在其边界两侧的值连续，但导数值有跳跃，因此是一种弱间断；熵的值在其两侧相等。一维膨胀波的特征线呈发散状，
如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:expansion"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。
\end_layout

\begin_layout Description
接触间断 上述两种间断的临界情形：既可以看作熵变为零的激波，又可以看作厚度为零的膨胀波。一维接触间断的特征线相互平行，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:contact"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/shock.pdf
	lyxscale 50
	width 100theight%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock"

\end_inset

一维激波的特征线呈汇聚状
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/expansion.pdf
	lyxscale 50
	width 100theight%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:expansion"

\end_inset

一维膨胀波的特征线呈发散状
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/contact.pdf
	lyxscale 50
	width 100theight%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:contact"

\end_inset

一维接触间断的特征线相互平行
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
直升机处于高速前飞状态时，主旋翼前行桨叶端部的相对气流速度有可能超过当地声速，从而形成激波。直升机处于低速前飞或悬停状态时，主旋翼桨尖处的相对气流速度属于高亚声
速，通常不会形成激波。无论是以上哪种情形，桨叶上下表面之间都存在可观的压强差。在 UMS–RKDG 近似解中，这是一种无法回避的间断，因为桨叶轴线一般会穿过
 RKDG 格式所用的体单元。
\end_layout

\begin_layout Standard
间断解的存在给高阶格式的设计带来了麻烦，这其中最致命的问题是存在于间断附近、幅值不随网格加密而衰减的“数值振荡 (numerical oscillation)”
。关于数值振荡的成因，学界存在多种观点，并有针对性地提出了多种压制策略：偏物理的解释有格式黏性不足、数值色散误差等观点，相应的策略包括人工黏性、群速度控制；偏数
学的解释有格式单调性、吉布斯现象等，相应的策略有滤波器、限制器、高阶重构等。实际上，这些观点及策略在某种程度上是等价的。本文选用吉布斯现象
\begin_inset CommandInset citation
LatexCommand cite
key "Gottlieb_1997"
literal "false"

\end_inset

来解释数值振荡的成因，它是指：用有限项连续函数的线性组合 
\begin_inset Formula $u^{h}$
\end_inset

 对间断函数 
\begin_inset Formula $u$
\end_inset

 做近似，则连续函数 
\begin_inset Formula $u^{h}$
\end_inset

 在间断函数 
\begin_inset Formula $u$
\end_inset

 的间断处会发生数值振荡。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Gibbs"

\end_inset

 展示了吉布斯现象的图象，以及数值振荡幅值不随网格加密而衰减的事实。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/linear_scalar/h_vary.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Gibbs"

\end_inset

间断函数的 DG3 近似在间断附近发生数值振荡
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
高阶格式都必须以某种方式压制数值振荡。对于二阶有限差分格式，可以选用 Sweby 型限制器
\begin_inset CommandInset citation
LatexCommand cite
key "Sweby_1984"
literal "false"

\end_inset

；van Leer
\begin_inset CommandInset citation
LatexCommand citep
key "Van_Leer_1977,Van_Leer_1977a,van_Leer_1979,van_Leer_2021"
literal "false"

\end_inset

 提出的 MUSCL (monotonic upstream-centered scheme for conservation laws)，被谨慎使用时可以达到
三阶精度。这些方法一般不能直接应用于间断有限元格式，并且会在光滑极值点处降阶。
\end_layout

\begin_layout Standard
为了克服前一缺点（不适用于间断有限元），Cockburn
\begin_inset CommandInset citation
LatexCommand citep
key "Cockburn_1990,Cockburn_1998"
literal "false"

\end_inset

 提出了适用于高维问题的广义斜率限制器。这些 minmod 型限制器，结合具有 TVD 性质（或更一般的 SSP 性质）的 RK 格式，能够使高阶
 DG 近似解不含非物理振荡，但往往会降低光滑区域极值点处的精度阶数。
\end_layout

\begin_layout Standard
为了克服后一缺点（在光滑极值点处降阶），Harten 等
\begin_inset CommandInset citation
LatexCommand cite
key "Harten_1997"
literal "false"

\end_inset

在有限差分法框架内提出了“基本无振荡 (essentially non-oscillatory, ENO)”格式
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "ENO"
symbol "ENO"
description "essentially non-oscillatory"
literal "true"

\end_inset

，其核心思想是：
\end_layout

\begin_layout Itemize
为每个结点指定多个“候选模板 (candidate stencil)”。
\end_layout

\begin_layout Itemize
在每个候选模板上分别构造一个“候选多项式 (candidate polynomial)”。
\end_layout

\begin_layout Itemize
取“光滑程度 (smoothness)”最高的那一个作为近似解。
\end_layout

\begin_layout Standard
在近似解充分光滑的区域，各候选多项式的光滑程度通常也很接近，只保留其中一个显然是对计算资源的一种浪费。为了充分利用所有已知信息，
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "WENO"
description "weighted essentially non-oscillatory"
literal "true"

\end_inset

“加权基本无振荡 (Weighted ENO, WENO)”重构技术
\begin_inset CommandInset citation
LatexCommand cite
key "Jiang_1996"
literal "false"

\end_inset

将 ENO 格式的最后一步替换为：
\end_layout

\begin_layout Itemize
取所有候选多项式的非线性加权平均作为近似解。
\end_layout

\begin_layout Standard
各种 WENO 重构技术的区别，正是体现在非线性权重的设计上。 ENO 格式与 WENO 重构技术虽不能完全消除数值振荡，但可以让数值振荡的幅值随网格加密而衰减
，同时还能够避免近似解的精度在光滑极值点附近降阶，因此特别适合于既含间断（激波、接触间断、膨胀波）、又含复杂流动结构（湍流、涡系）的问题。
\end_layout

\begin_layout Standard
此后，WENO 重构技术被引入到高阶有限体积格式
\begin_inset CommandInset citation
LatexCommand citep
key "Hu_1999"
literal "false"

\end_inset

中，从而适用于非结构网格。类似的想法后来被移植到 RKDG 格式中
\begin_inset CommandInset citation
LatexCommand citep
key "Qiu_2005,Zhu_2008"
literal "false"

\end_inset

，但代价是牺牲了 RKDG 格式的紧致性。适用于 RKDG 格式且保持其紧致特性的 WENO 重构技术
\begin_inset CommandInset citation
LatexCommand citep
key "Zhong_2013,Zhu_2013,Mazaheri_2019"
literal "true"

\end_inset

，大约在 2013 年前后才开始出现，并且通常只给出二维版本的实现。本节剩余部分将基于文献-
\begin_inset CommandInset citation
LatexCommand citet
key "Zhong_2013,Zhu_2013"
literal "true"

\end_inset

 提出的二维 RKDG 格式的紧致型 WENO 限制器，提出一种适用于三维 RKDG 及 UMS–RKDG 格式的紧致型 WENO 限制器。
\end_layout

\begin_layout Subsection
适用于高阶有限差分法的标量重构
\end_layout

\begin_layout Standard
为求解一维标量守恒律
\begin_inset Formula 
\begin{equation}
\frac{\partial u}{\partial t}+\frac{\partial f(u)}{\partial x}=0,\qquad a(u)=\frac{\partial f(u)}{\partial u},
\end{equation}

\end_inset

在等距网格上引入守恒型差分格式
\begin_inset Formula 
\begin{equation}
\left(\partial_{x}f\right)_{i}\equiv\eval{\pdv{f}{x}}_{i}\approx\frac{f_{i+1/2}-f_{i-1/2}}{h},
\end{equation}

\end_inset

其中 
\begin_inset Formula $f_{i\pm1/2}$
\end_inset

 为下面将要构造的数值通量
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$f_{i+1/2}$"
description "表示 $ x_{i+1/2} $ 处的数值通量"
literal "true"

\end_inset

。不失一般性，这里只考虑 
\begin_inset Formula $a(u_{i})>0$
\end_inset

 的情形；对于 
\begin_inset Formula $a(u_{i})<0$
\end_inset

 的情形，只需将下标中紧跟在 
\begin_inset Formula $i$
\end_inset

 后面的 
\begin_inset Formula $\pm$
\end_inset

 互换，例如 
\begin_inset Formula $f_{i+1}$
\end_inset

 换为 
\begin_inset Formula $f_{i-1}$
\end_inset

，以此类推。在构造 
\begin_inset Formula $f_{i+1/2}$
\end_inset

 时，含有五个点的大模板（用下标偏移量表示）
\begin_inset Formula 
\begin{equation}
S=\begin{bmatrix}-2 & -1 & 0 & +1 & +2\end{bmatrix}
\end{equation}

\end_inset

被分解为三个各含三个点且部分重叠的小模板：
\begin_inset Formula 
\begin{equation}
S_{1}=\begin{bmatrix}-2 & -1 & 0\end{bmatrix},\qquad S_{2}=\begin{bmatrix}-1 & 0 & +1\end{bmatrix},\qquad S_{3}=\begin{bmatrix}0 & +1 & +2\end{bmatrix}.
\end{equation}

\end_inset

由此可以构造出三种对 
\begin_inset Formula $\left(\partial_{x}f\right)_{i}$
\end_inset

 的三阶近似，相应的数值通量分别为
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$f^{[k]}_{i+1/2}$"
description "表示在第 $k$ 号小模板上获得的 $ x_{i+1/2} $ 处的数值通量"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{bmatrix}f_{i+1/2}^{[1]}\\
f_{i+1/2}^{[2]}\\
f_{i+1/2}^{[3]}
\end{bmatrix}=\frac{1}{6}\begin{bmatrix}2 & -7 & 11\\
 & -1 & 5 & 2\\
 &  & 2 & 5 & -1
\end{bmatrix}\begin{bmatrix}f_{i-2}\\
f_{i-1}\\
f_{i}\\
f_{i+1}\\
f_{i+2}
\end{bmatrix}.
\end{equation}

\end_inset

对三者取加权平均即得大模板上的数值通量：
\begin_inset Formula 
\begin{equation}
f_{i+1/2}=\begin{bmatrix}w_{1} & w_{2} & w_{3}\end{bmatrix}\begin{bmatrix}f_{i+1/2}^{[1]}\\
f_{i+1/2}^{[2]}\\
f_{i+1/2}^{[3]}
\end{bmatrix},
\end{equation}

\end_inset

其中 
\begin_inset Formula $\begin{bmatrix}w_{1} & w_{2} & w_{3}\end{bmatrix}$
\end_inset

 是根据 
\begin_inset Formula $f$
\end_inset

 在 
\begin_inset Formula $\begin{bmatrix}S_{1} & S_{2} & S_{3}\end{bmatrix}$
\end_inset

 上的光滑程度构造的非线性权重
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$w_k$"
description "表示第 $k$ 号小模板的非线性权重"
literal "true"

\end_inset

：
\end_layout

\begin_layout Itemize
在充分光滑的区域，上述 
\begin_inset Formula $f_{i+1/2}$
\end_inset

 应当逼近（五点）大模板上的（五阶）理想格式：
\begin_inset Formula 
\begin{equation}
f_{i+1/2}^{S}=\frac{\begin{bmatrix}2 & -13 & 47 & 27 & -3\end{bmatrix}}{60}\begin{bmatrix}f_{i-2}\\
f_{i-1}\\
f_{i}\\
f_{i+1}\\
f_{i+2}
\end{bmatrix}.
\end{equation}

\end_inset

这可以通过取理想权重来实现
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$w_k^{\\star}$"
description "表示第 $k$ 号小模板的理想权重"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}w_{1} & w_{2} & w_{3}\end{bmatrix}=\begin{bmatrix}w_{1}^{\star} & w_{2}^{\star} & w_{3}^{\star}\end{bmatrix}\coloneqq\frac{\begin{bmatrix}1 & 6 & 3\end{bmatrix}}{10}.
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
在非光滑区域，被间断穿过的小模板即坏模板 (troubled stencil) 上的权重应当接近 
\begin_inset Formula $0$
\end_inset

，但所有小模板的权重之和依然为 
\begin_inset Formula $1$
\end_inset

。
\end_layout

\begin_layout Standard
文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Jiang_1996"
literal "false"

\end_inset

 给出了一种满足上述性质的方案：
\end_layout

\begin_layout Enumerate
在小模板 
\begin_inset Formula $S_{k}$
\end_inset

 上构造二次多项式 
\begin_inset Formula $Q_{i}^{[k]}$
\end_inset

 作为在 
\begin_inset Formula $x_{i}$
\end_inset

 附近对 
\begin_inset Formula $f$
\end_inset

 的近似
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$Q^{[k]}_{i}$"
description "表示在第 $k$ 号小模板构造的二次多项式近似"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
Q_{i}^{[k]}(x)=f_{i}+\eval{\pdv{f}{x}}_{i}^{[k]}(x-x_{i})+\eval{\pdv[2]{f}{x}}_{i}^{[k]}\frac{(x-x_{i})^{2}}{2},
\end{equation}

\end_inset

其中 
\begin_inset Formula $\left(\partial_{x}f\right)_{i}^{[k]}$
\end_inset

 与 
\begin_inset Formula $\left(\partial_{x}^{2}f\right)_{i}^{[k]}$
\end_inset

 分别表示由 
\begin_inset Formula $\left\{ f_{i+s}:s\in S_{k}\right\} $
\end_inset

 给出的一阶与二阶差商，即 
\begin_inset Formula $\partial_{x}f$
\end_inset

 与 
\begin_inset Formula $\partial_{x}^{2}f$
\end_inset

 在点 
\begin_inset Formula $x_{i}$
\end_inset

 处的近似值：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\left(\partial_{x}f\right)_{i}^{[1]}\\
\left(\partial_{x}f\right)_{i}^{[2]}\\
\left(\partial_{x}f\right)_{i}^{[3]}
\end{bmatrix}=\frac{1}{2h}\begin{bmatrix}1 & -4 & 3\\
 & -1 & 0 & 1\\
 &  & 3 & -4 & 1
\end{bmatrix}\begin{bmatrix}f_{i-2}\\
f_{i-1}\\
f_{i}\\
f_{i+1}\\
f_{i+2}
\end{bmatrix},
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\left(\partial_{x}^{2}f\right)_{i}^{[1]}\\
\left(\partial_{x}^{2}f\right)_{i}^{[2]}\\
\left(\partial_{x}^{2}f\right)_{i}^{[3]}
\end{bmatrix}=\frac{1}{h^{2}}\begin{bmatrix}1 & -2 & 1\\
 & 1 & -2 & 1\\
 &  & 1 & -2 & 1
\end{bmatrix}\begin{bmatrix}f_{i-2}\\
f_{i-1}\\
f_{i}\\
f_{i+1}\\
f_{i+2}
\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
计算二次多项式 
\begin_inset Formula $Q_{i}^{[k]}$
\end_inset

 在控制体 
\begin_inset Formula $(x_{i-1/2},x_{i+1/2})$
\end_inset

 上的光滑程度
\begin_inset Formula 
\begin{equation}
\beta_{i}^{[k]}\coloneqq\int_{x_{i-1/2}}^{x_{i+1/2}}\sum_{p=1}^{2}\left(\dv[p]{Q_{i}^{[k]}}{x}\right)^{2}h^{2p-1}\dd{x}=\left(\eval{\pdv{f}{x}}_{i}^{[k]}h\right)^{2}+\frac{13}{12}\left(\eval{\pdv[2]{f}{x}}_{i}^{[k]}h^{2}\right)^{2}.
\end{equation}

\end_inset

在光滑区域，它们都趋于同一个二阶小量 
\begin_inset Formula $\beta_{i}^{\star}$
\end_inset

，且两两之差为六阶小量：
\begin_inset Formula 
\begin{equation}
\beta_{i}^{[k]}=\beta_{i}^{\star}+\order{h^{6}},\qquad\beta_{i}^{\star}\coloneqq\left(\eval{\pdv{f}{x}}_{i}h\right)^{2}+\frac{13}{12}\left(\eval{\pdv[2]{f}{x}}_{i}h^{2}\right)^{2}.
\end{equation}

\end_inset

在非光滑区域，坏模板上的 
\begin_inset Formula $Q_{i}^{[k]}$
\end_inset

 偏离 
\begin_inset Formula $f$
\end_inset

 在 
\begin_inset Formula $x_{i}$
\end_inset

 处的特例展开式较多，因此
\begin_inset Formula 
\begin{equation}
\beta_{i}^{[k]}=\order{1}\gg\order{h^{2}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
计算非线性权重
\begin_inset Formula 
\begin{equation}
w_{k}=\frac{w_{k}^{\beta}}{w_{3}^{\beta}+w_{2}^{\beta}+w_{3}^{\beta}},\qquad w_{k}^{\beta}=\frac{w_{k}^{\star}}{\left(10^{-6}+\beta_{i}^{[k]}\right)^{2}}.
\end{equation}

\end_inset

在光滑区域，上述非线性权重接近理想权重：
\begin_inset Formula 
\begin{equation}
w_{k}=w_{k}^{\star}+\order{h^{4}}\impliedby w_{k}^{\beta}=\frac{w_{k}^{\star}}{(\beta_{i}^{\star})^{2}+\order{h^{8}}}.
\end{equation}

\end_inset

故大模板上的 
\begin_inset Formula $f_{i+1/2}$
\end_inset

 具有五阶精度；在非光滑区域，坏模板的实际权重（与其他小模板的权重相比）接近 
\begin_inset Formula $0$
\end_inset

，但大模板上的 
\begin_inset Formula $f_{i+1/2}$
\end_inset

 依然具有三阶精度。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Subsection
适用于间断伽辽金方法的标量重构
\end_layout

\begin_layout Standard
下面介绍由 Zhong
\begin_inset CommandInset citation
LatexCommand cite
key "Zhong_2013"
literal "false"

\end_inset

 提出（适用于结构网格）、并由 Zhu
\begin_inset CommandInset citation
LatexCommand cite
key "Zhu_2013"
literal "false"

\end_inset

 推广（适用于非结构网格）的适用于间断伽辽金法的 WENO 重构方法。原文给出的是二维版本，本文将其推广到三维。
\end_layout

\begin_layout Standard
为方便叙述，将分片光滑的标量函数 
\begin_inset Formula $u$
\end_inset

 在体单元 
\begin_inset Formula $V_{i}$
\end_inset

 上的限制简记为
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$u_{i}$"
description "表示标量函数 $u$ 在体单元 $V_{i}$ 上的限制"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
u_{i}(\vec{r})\coloneqq u\vert_{V_{i}}(\vec{r}),\qquad\vec{r}\in V_{i},
\end{equation}

\end_inset

并将体单元 
\begin_inset Formula $V_{i}$
\end_inset

 及与之邻接的那些体单元的下标集（即局部模板）记为
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$K_{i}$"
description "表示体单元 $V_{i}$ 及与之邻接的那些体单元的下标集（即局部模板）"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
K_{i}\coloneqq\left\{ k:\partial V_{i}\cap\partial V_{k}\ne\varnothing\right\} .
\end{equation}

\end_inset

这里的“邻接”是指单元之间有公共边界，即几何区域相邻（三维单元至少有三个公共结点），而非单元编号相邻。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
设 
\begin_inset Formula $u$
\end_inset

 为分段光滑的标量函数，通常为标量守恒律 
\begin_inset Formula $\partial_{t}u+\nabla\cdot\vec{f}=0$
\end_inset

 的多项式近似解，也可以是双曲型方程组的某个特征变量。对每个邻接单元，即 
\begin_inset Formula $\forall k\in K_{i}$
\end_inset

：
\end_layout

\begin_layout Itemize
将 
\begin_inset Formula $u_{k}$
\end_inset

 延拓到 
\begin_inset Formula $V_{i}$
\end_inset

 上，并对函数值作适当平移，
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$u_{k\\to i}$"
description "表示将标量函数 $u_{k}$ 延拓到 $V_{i}$ 上，并对函数值作适当平移（使其在 $V_{i}$ 上的均值等于 $u_{i}$ 在 $V_{i}$ 上的均值）所得的函数"
literal "true"

\end_inset

使所得的 
\begin_inset Formula $u_{k\to i}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的均值等于 
\begin_inset Formula $u_{i}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的均值：
\begin_inset Formula 
\begin{equation}
u_{k\to i}(\vec{r})\coloneqq u_{k}(\vec{r})-\langle u_{k}\rangle_{i}+\langle u_{i}\rangle_{i},\qquad\vec{r}\in V_{i},
\end{equation}

\end_inset

其中 
\begin_inset Formula $\langle u_{k}\rangle_{i}$
\end_inset

 表示函数 
\begin_inset Formula $u_{k}$
\end_inset

 在单元 
\begin_inset Formula $V_{i}$
\end_inset

 上的均值
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\langle u_{k}\\rangle_{i}$"
description "表示标量函数 $u_{k}$ 在单元 $V_{i}$ 上的均值"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\langle u_{k}\rangle_{i}\coloneqq\frac{\int_{V_{i}}u_{k}(\vec{r})}{\vert V_{i}\vert},\qquad\vert V_{i}\vert\coloneqq\int_{V_{i}}1.
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
为 
\begin_inset Formula $u_{k\to i}$
\end_inset

 分配理想权重：
\begin_inset Formula 
\begin{equation}
w_{k\to i}^{\star}=\begin{cases}
0.001, & k\ne i,\\
1-\sum_{k\in K_{i}\setminus\left\{ i\right\} }w_{k\to i}^{\star}, & k=i,
\end{cases}
\end{equation}

\end_inset

数值试验表明：较大的 
\begin_inset Formula $w_{i\to i}^{\star}$
\end_inset

 有利于在光滑处保持精度，较小的 
\begin_inset Formula $w_{i\to i}^{\star}$
\end_inset

 有利于在间断处压制振荡。
\end_layout

\begin_layout Itemize
计算 
\begin_inset Formula $u_{k\to i}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的光滑程度
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\beta_{k\\to i}$"
description "表示标量函数函数 $u_{k\\to i}$ 在 $V_{i}$ 上的光滑程度"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\beta_{k\to i}=\sum_{\vert\alpha\vert=1}^{p}\frac{\vert V_{i}\vert^{2\vert\alpha\vert/3-1}}{(\vert\alpha\vert!)^{2}}\int_{V_{i}}\left(\frac{\partial^{\vert\alpha\vert}u_{k\to i}}{\partial x^{\alpha_{x}}\partial y^{\alpha_{y}}\partial z^{\alpha_{z}}}\right)^{2},\qquad\vert\alpha\vert\coloneqq\alpha_{x}+\alpha_{y}+\alpha_{z},
\end{equation}

\end_inset

其中系数 
\begin_inset Formula $\vert V_{i}\vert^{2\vert\alpha\vert/3-1}/(\vert\alpha\vert!)^{2}$
\end_inset

 的分子用于无量纲化，分母用于避免高阶导数的占比过多。文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Zhu_2013"
literal "false"

\end_inset

 中，此分子为 
\begin_inset Formula $\vert V_{i}\vert^{\vert\alpha\vert-1}$
\end_inset

，其实是二维版本 
\begin_inset Formula $\vert V_{i}\vert^{2\vert\alpha\vert/2-1}$
\end_inset

。
\end_layout

\begin_layout Itemize
计算非线性权重：
\begin_inset Formula 
\begin{equation}
w_{k\to i}=\frac{w_{k\to i}^{\beta}}{\sum_{k\in K_{i}}w_{k\to i}^{\beta}},\qquad w_{k\to i}^{\beta}\coloneqq\frac{w_{k\to i}^{\star}}{\left(10^{-6}+\beta_{k\to i}\right)^{2}},
\end{equation}

\end_inset

其中 
\begin_inset Formula $10^{-6}$
\end_inset

 用于避免分母为零。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
按上述非线性权重对 
\begin_inset Formula $\left\{ u_{k\to i}:k\in K_{i}\right\} $
\end_inset

 作平均，
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$u_{i}^{\\mathrm{new}}$"
description "表示 $u_{i}$ 经过 WENO 重构所得的新函数"
literal "true"

\end_inset

以所得的新函数 
\begin_inset Formula $u_{i}^{\mathrm{new}}$
\end_inset

 取代旧函数 
\begin_inset Formula $u_{i}$
\end_inset

：
\begin_inset Formula 
\begin{equation}
u_{i}^{\mathrm{new}}(\vec{r})\coloneqq\sum_{k\in K_{i}}w_{k\to i}\,u_{k\to i}(\vec{r}),\qquad\vec{x}\in V_{i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
借助（向量）函数的投影表示法
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}f_{1}(x,y)\\
\vdots\\
f_{K}(x,y)
\end{bmatrix}_{K\times1}=\underline{A}_{K\times N}\begin{bmatrix}1\\
x-x_{0}\\
y-y_{0}\\
(x-x_{0})(x-x_{0})\\
(x-x_{0})(y-y_{0})\\
(y-y_{0})(y-y_{0})
\end{bmatrix}_{N\times1}
\end{equation}

\end_inset

可以将其偏导数表示为
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}\dfrac{\partial}{\partial x}\begin{bmatrix}f_{1}\\
\vdots\\
f_{K}
\end{bmatrix} & \dfrac{\partial}{\partial y}\begin{bmatrix}f_{1}\\
\vdots\\
f_{K}
\end{bmatrix} & \dfrac{\partial^{2}}{\partial x^{2}}\begin{bmatrix}f_{1}\\
\vdots\\
f_{K}
\end{bmatrix} & \dfrac{\partial^{2}}{\partial x\partial y}\begin{bmatrix}f_{1}\\
\vdots\\
f_{K}
\end{bmatrix} & \dfrac{\partial^{2}}{\partial y^{2}}\begin{bmatrix}f_{1}\\
\vdots\\
f_{K}
\end{bmatrix}\end{bmatrix}}_{K\times(N-1)}=\underline{A}_{K\times N}\underbrace{\begin{bmatrix}0\\
1\\
0 & 1\\
2(x-x_{0}) & 0 & 2\\
0 & 0 & 0 & 1\\
0 & 2(y-y_{0}) & 0 & 0 & 2
\end{bmatrix}}_{N\times(N-1)}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
适用于间断伽辽金方法的特征重构
\end_layout

\begin_layout Standard
设多项式列阵 
\begin_inset Formula $\underline{U}$
\end_inset

 为双曲型方程组
\begin_inset Formula 
\begin{equation}
\partial_{t}\underline{U}+\nabla\cdot\underline{\vec{F}}=\underline{H}\label{eq:hyperbolic_system}
\end{equation}

\end_inset

的广义解，将其在单元 
\begin_inset Formula $V_{i}$
\end_inset

 上的限制记为
\begin_inset Formula 
\begin{equation}
\underline{U}_{i}(\vec{r},t)\coloneqq\underline{U}\vert_{V_{i}}(\vec{r},t),\qquad\vec{r}\in V_{i}.
\end{equation}

\end_inset

用 
\begin_inset Formula $\underline{U}_{i}^{h}$
\end_inset

 表示其近似解
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{U}^{h}_{i}$"
description "表示双曲型方程组在单元 $V_i$ 上的近似解"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{U}^{h}$"
description "表示矩阵函数 $\\underline{U}$ 在尺度为 $h$ 的网格上的多项式近似"
literal "true"

\end_inset

。
\end_layout

\begin_layout Standard
遍历 
\begin_inset Formula $V_{i}$
\end_inset

 的邻居，即 
\begin_inset Formula $\forall k\in K_{i}\setminus\left\{ i\right\} $
\end_inset

，将各邻接单元上的 
\begin_inset Formula $\underline{U}_{k}^{h}$
\end_inset

 延拓到 
\begin_inset Formula $V_{i}$
\end_inset

 上，并对函数值作适当平移，使所得的 
\begin_inset Formula $\underline{U}_{k\to i}^{h}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的平均值等于 
\begin_inset Formula $\underline{U}_{i}^{h}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的平均值
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{U}^{h}_{k\\to i}$"
description "表示将矩阵函数 $\\underline{U}^{h}_{k}$ 延拓到 $V_{i}$ 上，并对函数值作适当平移（使其在 $V_{i}$ 上的均值等于 $\\underline{U}^{h}_{i}$ 在 $V_{i}$ 上的均值）所得的函数"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{U}_{k\to i}^{h}(\vec{r},t)\coloneqq\underline{U}_{k}^{h}(\vec{r},t)-\langle\underline{U}_{k}^{h}\rangle_{i}+\langle\underline{U}_{i}^{h}\rangle_{i},\qquad\vec{r}\in V_{i}.
\end{equation}

\end_inset

不难证明：
\begin_inset Formula $\underline{U}_{i}^{h}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的平均值是重构不变量，即
\begin_inset Formula 
\begin{equation}
\langle\underline{U}_{k\to i}^{h}\rangle_{i}=\langle\underline{U}_{i}^{h}\rangle_{i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
再次遍历 
\begin_inset Formula $V_{i}$
\end_inset

 的邻居，即 
\begin_inset Formula $\forall k\in K_{i}\setminus\left\{ i\right\} $
\end_inset

，对方程组 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hyperbolic_system"

\end_inset

 沿公共边界 
\begin_inset Formula $\partial V_{i}\cap\partial V_{k}$
\end_inset

 的
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\vec{\\nu}_{k}$"
description "表示体单元 $V_{i}$ 与 $V_{k}$ 的公共边界 $\\partial V_{i}\\cap\\partial V_{k}$ 上的单位法向量"
literal "true"

\end_inset

法向量 
\begin_inset Formula $\vec{\nu}_{k}$
\end_inset

 的法向分裂形式
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{F}^{\\nu_{k}}$"
description "表示  $\\underline{\\vec{F}}$ 在 $\\vec{\\nu}_{k}$ 上投影所得的法向通量"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{A}^{\\nu_{k}}$"
description "表示  $\\underline{F}^{\\nu_{k}}$ 关于 $\\underline{U}$ 的雅可比矩阵"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\partial_{t}\underline{U}+\partial_{\nu_{k}}\underline{F}^{\nu_{k}}=\underline{H},\qquad\underline{F}^{\nu_{k}}\coloneqq\vec{\nu}_{k}\cdot\vec{\underline{F}},\qquad\underline{A}^{\nu_{k}}\coloneqq\partial\underline{F}^{\nu_{k}}/\partial\underline{U},
\end{equation}

\end_inset

实施如下特征重构：
\end_layout

\begin_layout Itemize
用重构不变量 
\begin_inset Formula $\langle\underline{U}_{i}^{h}\rangle_{i}$
\end_inset

，即 
\begin_inset Formula $\underline{U}_{i}^{h}$
\end_inset

 在 
\begin_inset Formula $V_{i}$
\end_inset

 上的均值，计算 
\begin_inset Formula $\underline{A}^{\nu_{k}}(\underline{U}_{i})$
\end_inset

 所得的近似值
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{A}_{i\\vert k}$"
description "表示用 $\\underline{U}^{h}_{i}$ 在 $V_{i}$ 上的均值计算 $\\underline{A}^{\\nu_{k}}(\\underline{U}_{i})$ 所得的近似值"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{A}^{\nu_{k}}(\underline{U})\approx\underline{A}^{\nu_{k}}\qty(\langle\underline{U}_{i}^{h}\rangle_{i})\eqqcolon\underline{A}_{i\vert k}.
\end{equation}

\end_inset

下标里的 
\begin_inset Formula $i\vert k$
\end_inset

 表示它是在 
\begin_inset Formula $V_{k}$
\end_inset

 的帮助下得到的属于 
\begin_inset Formula $V_{i}$
\end_inset

 的结果（下同）。
\end_layout

\begin_layout Itemize
对所得的 
\begin_inset Formula $\underline{A}_{i\vert k}$
\end_inset

 做特征分解
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{R}_{i\\vert k}$"
description "表示 $\\underline{A}_{i\\vert k}$ 的右特征矩阵"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{L}_{i\\vert k}$"
description "表示 $\\underline{A}_{i\\vert k}$ 的左特征矩阵"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{A}_{i\vert k}\,\underline{R}_{i\vert k}=\underline{R}_{i\vert k}\,\underline{\varLambda}_{i\vert k},\qquad\underline{L}_{i\vert k}\coloneqq(\underline{R}_{i\vert k})^{-1}.\label{eq:eigen-decomposition}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
用左特征矩阵 
\begin_inset Formula $\underline{L}_{i\vert k}$
\end_inset

 定义特征变量
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{W}_{i\\vert k}$"
description "表示利用 $\\underline{L}_{i\\vert k}$ 构造的特征变量"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{W}_{i\vert k}\coloneqq\underline{L}_{i\vert k}\,\underline{U}.
\end{equation}

\end_inset

将 
\begin_inset Formula $\underline{U}_{k\to i}^{h}$
\end_inset

 代入右端，得到 
\begin_inset Formula $\underline{W}_{i\vert k}$
\end_inset

 的近似值，记为 
\begin_inset Formula $\underline{W}_{i\vert k}^{h}$
\end_inset

。该近似值可能含有数值振荡。
\end_layout

\begin_layout Itemize
将 
\begin_inset Formula $\underline{W}_{i\vert k}$
\end_inset

 的每一行视为独立变量，对其调用标量重构算法，用 
\begin_inset Formula $\underline{W}_{i\vert k}^{h,\mathrm{new}}$
\end_inset

 表示重构后的、基本无振荡的特征变量近似值。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{W}_{i\\vert k}^{h,\\mathrm{new}}$"
description "表示 $\\underline{W}^h_{i\\vert k}$ 经过 WENO 重构所得的新函数"
literal "true"

\end_inset


\end_layout

\begin_layout Itemize
用右特征矩阵 
\begin_inset Formula $\underline{R}_{i\vert k}$
\end_inset

 将其变换回守恒变量：
\begin_inset Formula 
\begin{equation}
\underline{U}_{i\vert k}^{h,\mathrm{new}}\coloneqq\underline{R}_{i\vert k}\,\underline{W}_{i\vert k}^{h,\mathrm{new}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
最后按单元 
\begin_inset Formula $V_{k}$
\end_inset

 的体积对 
\begin_inset Formula $\underline{U}_{i\vert k}^{h,\mathrm{new}}$
\end_inset

 作加权平均：
\begin_inset Formula 
\begin{equation}
\underline{U}_{i}^{h,\mathrm{new}}\coloneqq\frac{\sum_{k\in K_{i}\setminus\left\{ i\right\} }\vert V_{k}\vert\,\underline{U}_{i\vert k}^{h,\mathrm{new}}}{\sum_{k\in K_{i}\setminus\left\{ i\right\} }\vert V_{k}\vert}
\end{equation}

\end_inset

以此作为 
\begin_inset Formula $\underline{U}_{i}$
\end_inset

 的新近似解。
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{U}^{h,\\mathrm{new}}_{i}$"
description "表示 $\\underline{U}^h_{i}$ 经过 WENO 重构所得的新函数"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
上述过程在每个公共边界 
\begin_inset Formula $\partial V_{i}\cap\partial V_{k}$
\end_inset

 上只做一次法向投影，实际上是假设了单位法向量 
\begin_inset Formula $\vec{\nu}_{k}$
\end_inset

 沿该边界不变，即单元边界属于某个平面。在三维问题中，四面体单元通常可以保证不属于任何平面的单元边界只出现在流场边界上，而六面体单元（即使最低阶的八结点单元）的
单元边界一般而言是非平面的。
\end_layout

\begin_layout Subsection
三维欧拉方程的特征分解
\end_layout

\begin_layout Standard
以上特征重构方法原则上适用于任意双曲型方程。对于本文最关心的三维欧拉方程，式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:eigen-decomposition"

\end_inset

 所示特征分解可以通过符号运算提前做好。本节给出该结果的推导过程。
\end_layout

\begin_layout Standard
三维欧拉方程的法向分裂形式
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\rho$"
description "表示气体密度"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$p$"
description "表示气体压强"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$e_0$"
description "表示气体比总能"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$h_0$"
description "表示气体比总焓"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\vec{u}$"
description "表示气体速度"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial t}\begin{bmatrix}\rho\\
\rho\vec{u}\\
\rho e_{0}
\end{bmatrix}+\frac{\partial}{\partial\nu}\begin{bmatrix}\rho u_{\nu}\\
\rho u_{\nu}\vec{u}+p\vec{\nu}\\
\rho u_{\nu}h_{0}
\end{bmatrix}=\begin{bmatrix}0\\
\vec{0}\\
0
\end{bmatrix}
\end{equation}

\end_inset

在全局 
\begin_inset Formula $(x,y,z)$
\end_inset

 坐标系与局部 
\begin_inset Formula $(\nu,\sigma,\pi)$
\end_inset

 坐标系下的展开式分别为
\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial t}\begin{bmatrix}\rho\\
\rho u_{x}\\
\rho u_{y}\\
\rho u_{z}\\
\rho e_{0}
\end{bmatrix}+\frac{\partial}{\partial\nu}\begin{bmatrix}\rho u_{\nu}\\
\rho u_{\nu}u_{x}+p\nu_{x}\\
\rho u_{\nu}u_{y}+p\nu_{y}\\
\rho u_{\nu}u_{z}+p\nu_{z}\\
\rho u_{\nu}h_{0}
\end{bmatrix}=\begin{bmatrix}0\\
0\\
0\\
0\\
0
\end{bmatrix},
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial t}\begin{bmatrix}\rho\\
\rho u_{\nu}\\
\rho u_{\sigma}\\
\rho u_{\pi}\\
\rho e_{0}
\end{bmatrix}+\frac{\partial}{\partial\nu}\begin{bmatrix}\rho u_{\nu}\\
\rho u_{\nu}u_{\nu}+p\\
\rho u_{\nu}u_{\sigma}\\
\rho u_{\nu}u_{\pi}\\
\rho u_{\nu}h_{0}
\end{bmatrix}=\begin{bmatrix}0\\
0\\
0\\
0\\
0
\end{bmatrix}.
\end{equation}

\end_inset

后者的特征值及右特征矩阵
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{R'}$"
description "表示 $\\underline{A}^{\\nu}$ 的右特征矩阵在法向坐标系中的表达式"
literal "true"

\end_inset

分别为
\begin_inset Formula 
\begin{equation}
\underline{\varLambda'}=\begin{bmatrix}u_{\nu}-a\\
 & u_{\nu}\\
 &  & u_{\nu}\\
 &  &  & u_{\nu}\\
 &  &  &  & u_{\nu}+a
\end{bmatrix},
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\underline{R'}=\begin{bmatrix}1 & 1 & 0 & 0 & 1\\
u_{\nu}-a & u_{\nu} & 0 & 0 & u_{\nu}+a\\
u_{\sigma} & u_{\sigma} & 1 & 0 & u_{\sigma}\\
u_{\pi} & u_{\pi} & 0 & 1 & u_{\pi}\\
h_{0}-u_{\nu}a & \frac{u_{\nu}^{2}+u_{\sigma}^{2}+u_{\pi}^{2}}{2} & u_{\sigma} & u_{\pi} & h_{0}+u_{\nu}a
\end{bmatrix}.
\end{equation}

\end_inset

利用符号运算可得左特征矩阵
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{L'}$"
description "表示 $\\underline{A}^{\\nu}$ 的左特征矩阵在法向坐标系中的表达式"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{L'}=(\underline{R'})^{-1}=\begin{bmatrix}\frac{1}{2}\left(B_{2}+u_{\nu}/a\right) & \frac{-1}{2}\left(B_{1}u_{\nu}+1/a\right) & \frac{-1}{2}B_{1}u_{\sigma} & \frac{-1}{2}B_{1}u_{\pi} & \frac{1}{2}B_{1}\\
1-B_{2} & B_{1}u_{\nu} & B_{1}u_{\sigma} & B_{1}u_{\pi} & -B_{1}\\
-u_{\sigma} & 0 & 1 & 0 & 0\\
-u_{\pi} & 0 & 0 & 1 & 0\\
\frac{1}{2}\left(B_{2}-u_{\nu}/a\right) & \frac{-1}{2}\left(B_{1}u_{\nu}-1/a\right) & \frac{-1}{2}B_{1}u_{\sigma} & \frac{-1}{2}B_{1}u_{\pi} & \frac{1}{2}B_{1}
\end{bmatrix},
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
B_{1}\coloneqq\frac{\gamma^{-}}{a^{2}},\qquad B_{2}\coloneqq B_{1}\frac{u_{\nu}^{2}+u_{\sigma}^{2}+u_{\pi}^{2}}{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
利用变量替换关系
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}\rho\\
\rho u_{x}\\
\rho u_{y}\\
\rho u_{z}\\
\rho e_{0}
\end{bmatrix}}_{\underline{U}}=\begin{bmatrix}\rho\\
\rho u_{\nu}\nu_{x}+\rho u_{\sigma}\sigma_{x}+\rho u_{\pi}\pi_{x}\\
\rho u_{\nu}\nu_{y}+\rho u_{\sigma}\sigma_{y}+\rho u_{\pi}\pi_{y}\\
\rho u_{\nu}\nu_{z}+\rho u_{\sigma}\sigma_{z}+\rho u_{\pi}\pi_{z}\\
\rho e_{0}
\end{bmatrix}=\underbrace{\begin{bmatrix}1\\
 & \nu_{x} & \sigma_{x} & \pi_{x}\\
 & \nu_{y} & \sigma_{y} & \pi_{y}\\
 & \nu_{z} & \sigma_{z} & \pi_{z}\\
 &  &  &  & 1
\end{bmatrix}}_{\underline{J}_{\underline{U}\to\underline{U'}}}\underbrace{\begin{bmatrix}\rho\\
\rho u_{\nu}\\
\rho u_{\sigma}\\
\rho u_{\pi}\\
\rho e_{0}
\end{bmatrix}}_{\underline{U'}}
\end{equation}

\end_inset

可得右特征矩阵在全局 
\begin_inset Formula $(x,y,z)$
\end_inset

 坐标系下的表达式
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{R}$"
description "表示 $\\underline{A}^{\\nu}$ 的右特征矩阵在全局坐标系中的表达式"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{R}=\underline{J}_{\underline{U}\to\underline{U'}}\,\underline{R'}=\begin{bmatrix}1 & 1 & 0 & 0 & 1\\
u_{x}-a\nu_{x} & u_{x} & \sigma_{x} & \pi_{x} & u_{x}+a\nu_{x}\\
u_{y}-a\nu_{y} & u_{y} & \sigma_{y} & \pi_{y} & u_{y}+a\nu_{y}\\
u_{z}-a\nu_{z} & u_{z} & \sigma_{z} & \pi_{z} & u_{z}+a\nu_{z}\\
h_{0}-u_{\nu}a & \frac{u_{x}^{2}+u_{y}^{2}+u_{z}^{2}}{2} & u_{\sigma} & u_{\pi} & h_{0}+u_{\nu}a
\end{bmatrix},
\end{equation}

\end_inset

这里用
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}u_{\nu}\\
u_{\sigma}\\
u_{\pi}
\end{bmatrix}=\begin{bmatrix}\nu_{x} & \sigma_{x} & \pi_{x}\\
\nu_{y} & \sigma_{y} & \pi_{y}\\
\nu_{z} & \sigma_{z} & \pi_{z}
\end{bmatrix}^{-1}\begin{bmatrix}u_{x}\\
u_{y}\\
u_{z}
\end{bmatrix}
\end{equation}

\end_inset

对速度分量做了替换。
\end_layout

\begin_layout Standard
同理，可得左特征矩阵在全局 
\begin_inset Formula $(x,y,z)$
\end_inset

 坐标系下的表达式
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\underline{L}$"
description "表示 $\\underline{A}^{\\nu}$ 的左特征矩阵在全局坐标系中的表达式"
literal "true"

\end_inset

：
\begin_inset Formula 
\begin{equation}
\underline{L}=\underline{L'}\,\underline{J}_{\underline{U}\to\underline{U'}}^{-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
=\begin{bmatrix}\frac{1}{2}\left(B_{2}+u_{\nu}/a\right) & \frac{-1}{2}\left(B_{1}u_{\nu}+1/a\right) & \frac{-1}{2}B_{1}u_{\sigma} & \frac{-1}{2}B_{1}u_{\pi} & \frac{1}{2}B_{1}\\
1-B_{2} & B_{1}u_{\nu} & B_{1}u_{\sigma} & B_{1}u_{\pi} & -B_{1}\\
-u_{\sigma} & 0 & 1 & 0 & 0\\
-u_{\pi} & 0 & 0 & 1 & 0\\
\frac{1}{2}\left(B_{2}-u_{\nu}/a\right) & \frac{-1}{2}\left(B_{1}u_{\nu}-1/a\right) & \frac{-1}{2}B_{1}u_{\sigma} & \frac{-1}{2}B_{1}u_{\pi} & \frac{1}{2}B_{1}
\end{bmatrix}\begin{bmatrix}1\\
 & \nu_{x} & \nu_{y} & \nu_{z}\\
 & \sigma_{x} & \sigma_{y} & \sigma_{z}\\
 & \pi_{x} & \pi_{y} & \pi_{z}\\
 &  &  &  & 1
\end{bmatrix}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
=\begin{bmatrix}\frac{1}{2}\left(B_{2}+u_{\nu}/a\right) & \frac{-1}{2}\left(B_{1}u_{x}+\nu_{x}/a\right) & \frac{-1}{2}\left(B_{1}u_{y}+\nu_{y}/a\right) & \frac{-1}{2}\left(B_{1}u_{z}+\nu_{z}/a\right) & \frac{1}{2}B_{1}\\
1-B_{2} & B_{1}u_{x} & B_{1}u_{y} & B_{1}u_{z} & -B_{1}\\
-u_{\sigma} & \sigma_{x} & \sigma_{y} & \sigma_{z} & 0\\
-u_{\pi} & \pi_{x} & \pi_{y} & \pi_{z} & 0\\
\frac{1}{2}\left(B_{2}-u_{\nu}/a\right) & \frac{-1}{2}\left(B_{1}u_{x}-\nu_{x}/a\right) & \frac{-1}{2}\left(B_{1}u_{y}-\nu_{y}/a\right) & \frac{-1}{2}\left(B_{1}u_{z}-\nu_{z}/a\right) & \frac{1}{2}B_{1}
\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Section
本章小结
\end_layout

\begin_layout Standard
本章提出了一种适用于舰载直升机流场的高阶计算方法。该方法
\end_layout

\begin_layout Itemize
以三维非结构网格上的 DG 格式做空间离散，能够处理具有复杂几何外形的边界；
\end_layout

\begin_layout Itemize
以保持强稳定性的 RK 格式做时间推进，能够像显式欧拉格式那样以保持数值解的强稳定性；
\end_layout

\begin_layout Itemize
以非定常动量源模型 (UMS) 表示桨叶对流场的扰动，避免了旋翼 CFD 对动态网格技术的依赖；
\end_layout

\begin_layout Itemize
以紧致型 WENO 重构技术压制 RKDG 及 UMS–RKDG 高阶近似解在间断附近的数值振荡。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Chapter
高阶格式在非结构网格上的精度验证
\begin_inset CommandInset label
LatexCommand label
name "chap:验证"

\end_inset


\end_layout

\begin_layout Standard
本章首先基于一组具有解析解、数值精确解或高精度数值解的一维或二维标准算例，在三维非结构网格上验证第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:算法"
plural "false"
caps "false"
noprefix "false"

\end_inset

章所提高阶计算方法的正确性，以及提高阶数对减小误差所起的积极作用。在此基础上，基于一组没有解析解、数值精确解及高精度数值解的三维工程算例，以物理上可靠的一阶近似
解为参照，验证三阶近似解的正确性。
\end_layout

\begin_layout Section
基于线性平流问题解析解的定量验证
\end_layout

\begin_layout Standard
本小节求解如下线性波动方程
\begin_inset Formula 
\begin{equation}
\partial_{t}\underline{U}+\underline{A}^{x}\,\partial_{x}\underline{U}+\underline{A}^{y}\,\partial_{y}\underline{U}+\underline{A}^{z}\,\partial_{z}\underline{U}=\underline{0}\label{eq:linear_system}
\end{equation}

\end_inset

的初边值问题。这组问题的解析解可以由文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Toro_2009"
literal "false"

\end_inset

 介绍的方法获得，因而很适合被用于数值求解器性能的定量评估。本节所有问题都是在三维区间 
\begin_inset Formula $[0,4]\times[0,1]\times[0,0.5]$
\end_inset

 内求解的，且所有平行于 
\begin_inset Formula $x$
\end_inset

 轴的边界均以“法向导数为零”为边界条件，即
\begin_inset Formula 
\begin{equation}
\frac{\partial U}{\partial\nu}=0,\qquad(y-0)(y-1)(z-0)(z-0.5)=0.
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
线性单波平流问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[线性单波平流]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:线性单波平流"

\end_inset

在方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:linear_system"

\end_inset

 中，令
\begin_inset Formula 
\begin{equation}
\underline{U}(x,y,z,t)=\begin{bmatrix}U(x,y,z,t)\end{bmatrix},\qquad\underline{A}^{x}=\begin{bmatrix}-10\end{bmatrix},\qquad\underline{A}^{y}=\underline{A}^{z}=\begin{bmatrix}0\end{bmatrix},
\end{equation}

\end_inset

即得线性单波方程
\begin_inset Formula 
\begin{equation}
\left(\partial_{t}-10\partial_{x}\right)U=0.
\end{equation}

\end_inset

求满足此方程与边界条件
\begin_inset Formula 
\begin{equation}
U(x=0,y,z,t)=-10\eqqcolon U_{L},\qquad U(x=4,y,z,t)=+10\eqqcolon U_{R},
\end{equation}

\end_inset

及初始条件
\begin_inset Formula 
\begin{equation}
U(x,y,z,t=0)=U_{L}
\end{equation}

\end_inset

的广义解。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
该问题的解析解为
\begin_inset Formula 
\begin{equation}
U^{\star}(x,y,z,t)=\begin{cases}
U_{L}, & x-4<-10t;\\
U_{R}, & x-4>-10t.
\end{cases}
\end{equation}

\end_inset

其物理意义为以速率 
\begin_inset Formula $10$
\end_inset

 沿 
\begin_inset Formula $-x$
\end_inset

 方向移动的平面波。初始时，长方体内部为均匀状态，但有一间断位于 
\begin_inset Formula $x=4$
\end_inset

 处。
\end_layout

\begin_layout Standard
为了直观地比较数值解的精度，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_p=3_h=2^-3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_p=3_h=2^-2"

\end_inset

 给出了若干求解器–网格 (
\begin_inset Formula $p$
\end_inset

–
\begin_inset Formula $h$
\end_inset

) 组合给出的同一时刻的数值解云图。这些图中的白色区域为函数值连续变化的过渡层，其厚度与数值解的误差呈正相关。通过比较图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_p=1_h=2^-5"

\end_inset

 所示的细 (
\begin_inset Formula $h\approx1/32$
\end_inset

) 网格上的低阶 (
\begin_inset Formula $p=1$
\end_inset

) 数值解，与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_p=3_h=2^-2"

\end_inset

 所示粗 (
\begin_inset Formula $h\approx1/4$
\end_inset

) 网格上的高阶 (
\begin_inset Formula $p=3$
\end_inset

) 数值解，可知二者的误差在同一量级。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_scalar/p=3_h=2^-3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_scalar_p=3_h=2^-3"

\end_inset

在只含 
\begin_inset Formula $h\approx2^{-3}$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_scalar/p=1_h=2^-4.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_scalar_p=1_h=2^-4"

\end_inset

在只含 
\begin_inset Formula $h\approx2^{-4}$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_scalar/p=1_h=2^-5.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_scalar_p=1_h=2^-5"

\end_inset

在只含 
\begin_inset Formula $h\approx2^{-5}$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_scalar/p=3_h=2^-2.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_scalar_p=3_h=2^-2"

\end_inset

在只含 
\begin_inset Formula $h\approx2^{-2}$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了进一步体现单元尺寸与求解器阶数对数值解精度的影响，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_h_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_p_vary"

\end_inset

 给出了沿纵向对称轴 (
\begin_inset Formula $y=0.5,\,z=0.25$
\end_inset

) 均匀分布的 1001 个采样点处的函数值。二者分别体现了加密网格（减小 
\begin_inset Formula $h$
\end_inset

）与增加阶数（增大 
\begin_inset Formula $p$
\end_inset

）对数值解精度的提高。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_scalar/h_vary.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_scalar_h_vary"

\end_inset

同一求解器在不同网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的近似解之间的比较
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_scalar/p_vary.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_scalar_p_vary"

\end_inset

不同求解器在同一网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的近似解之间的比较
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:linear_accuracy"

\end_inset

 列出了各种求解器–网格 (
\begin_inset Formula $p$
\end_inset

–
\begin_inset Formula $h$
\end_inset

) 组合的全局误差测量值。这里的“全局误差”定义为
\begin_inset Formula 
\begin{equation}
\varepsilon(t)=\sum_{i\in I_{V}}\int_{V_{i}}\left|U^{h}(x,y,z,t)-U^{\star}(x,y,z,t)\right|.\label{eq:global-error}
\end{equation}

\end_inset

表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:linear_accuracy"

\end_inset

 中的数据验证了前文定性观察得出的结论，即（1）细 (
\begin_inset Formula $h\approx1/32$
\end_inset

) 网格上的低阶 (
\begin_inset Formula $p=1$
\end_inset

) 数值解，与粗 (
\begin_inset Formula $h\approx1/4$
\end_inset

) 网格上的高阶 (
\begin_inset Formula $p=3$
\end_inset

) 数值解精度相当；（2）加密网格（减小 
\begin_inset Formula $h$
\end_inset

）或增加阶数（增大 
\begin_inset Formula $p$
\end_inset

）都能提高数值解精度。
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:linear_accuracy"

\end_inset

各种 
\begin_inset Formula $p$
\end_inset

–
\begin_inset Formula $h$
\end_inset

（求解器–网格）组合得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题近似解的全局误差
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
diagbox{$p$}{$
\backslash
varepsilon(0.2)$}{$h$}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-5}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.858
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.095
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.524
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.108
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.258
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.771
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.463
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.275
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.021
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.590
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.341
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:linear_cost"

\end_inset

 列出了各种求解器–网格 (
\begin_inset Formula $p$
\end_inset

–
\begin_inset Formula $h$
\end_inset

) 组合的运行时间。这里的“运行时间”含数据结构初始化及文件读写等操作，均为在主频为 2.7 GHz 的单核处理器上测得。需要说明的是，表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:linear_cost"

\end_inset

 中的数据夸大了低阶 RKDG 求解器的运行时间，这是因为就间断伽辽金有限元法而言，低阶 RKDG 求解器本可以采用与之相对应的低阶数值积分器。但为了公平地计算
式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:global-error"

\end_inset

 所定义的全局误差，本节所展示的各阶 RKDG 求解器使用了同一个高阶数值积分器，即在四面体单元上具有 6 阶代数精度的 24 点积分器。即便如此，由表
 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:linear_cost"

\end_inset

 所列数据依然可知：在数值解精度大致相当的情况下，高阶 (
\begin_inset Formula $p=3$
\end_inset

) 求解器在粗 (
\begin_inset Formula $h\approx1/4$
\end_inset

) 网格上所消耗的运行时间 (4.147 s) 远小于低阶 (
\begin_inset Formula $p=1$
\end_inset

) 求解器在细 (
\begin_inset Formula $h\approx1/32$
\end_inset

) 网格上的所消耗的运行时间 (306.293 s 或按 
\begin_inset Formula $1/24$
\end_inset

 换算后的 12.762 s)。
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:linear_cost"

\end_inset

各种 
\begin_inset Formula $p$
\end_inset

–
\begin_inset Formula $h$
\end_inset

（求解器–网格）组合求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性单波平流"

\end_inset

问题的运行时间
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
diagbox{$p$}{$T$ (s)}{$h$}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2^{-5}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.373
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.129
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.533
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
306.293
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.580
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.894
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
253.821
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4986.391
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.147
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
61.425
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
906.914
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
以上结果表明：高阶 RKDG 求解器具有较高的性价比。这里的“性”指全局精度，“价”指运行时间。
\end_layout

\begin_layout Subsection
线性双波平流问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[线性双波平流]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:线性双波平流"

\end_inset

在方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:linear_system"

\end_inset

 中，令
\begin_inset Formula 
\begin{equation}
\underline{U}(\vec{x},t)=\begin{bmatrix}U_{1}(x,y,z,t)\\
U_{2}(x,y,z,t)
\end{bmatrix},\qquad\underline{A}^{x}=\begin{bmatrix}6 & -2\\
-2 & 6
\end{bmatrix},\qquad\underline{A}^{y}=\underline{A}^{z}=\begin{bmatrix}0 & 0\\
0 & 0
\end{bmatrix},
\end{equation}

\end_inset

由此得线性双波方程组
\begin_inset Formula 
\begin{equation}
\begin{cases}
\partial_{t}U_{1}+6\partial_{x}U_{1}-2\partial_{x}U_{2}=0,\\
\partial_{t}U_{2}-2\partial_{x}U_{1}+6\partial_{x}U_{2}=0.
\end{cases}\label{eq:linear_double_wave}
\end{equation}

\end_inset

求满足此方程组与边界条件
\begin_inset Formula 
\begin{equation}
\underline{U}(x=0,y,z,t)=\begin{bmatrix}0\\
0
\end{bmatrix}\eqqcolon\underline{U}_{\mathrm{L}},\qquad\underline{U}(x=4,y,z,t)=\begin{bmatrix}12\\
-4
\end{bmatrix}\eqqcolon\underline{U}_{\mathrm{R}},
\end{equation}

\end_inset

及初始条件
\begin_inset Formula 
\begin{equation}
\underline{U}(x,y,z,t=0)=\underline{U}_{\mathrm{R}}
\end{equation}

\end_inset

的广义解。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
为获得其解析解，先对 
\begin_inset Formula $\underline{A}^{x}$
\end_inset

 作特征分解，得到
\begin_inset Formula 
\begin{equation}
\underbrace{\begin{bmatrix}6 & -2\\
-2 & 6
\end{bmatrix}}_{\underline{A}^{x}}=\underbrace{\begin{bmatrix}1 & 1\\
-1 & 1
\end{bmatrix}}_{\underline{R^{x}}}\underbrace{\begin{bmatrix}8\\
 & 4
\end{bmatrix}}_{\underline{\varLambda^{x}}}\underbrace{\begin{bmatrix}1/2 & -1/2\\
1/2 & 1/2
\end{bmatrix}}_{\underline{L^{x}}}.
\end{equation}

\end_inset

通过引入特征变量 
\begin_inset Formula $\underline{V}\coloneqq\underline{L^{x}}\,\underline{U}$
\end_inset

，即
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}V_{1}\\
V_{2}
\end{bmatrix}\coloneqq\begin{bmatrix}1/2 & -1/2\\
1/2 & 1/2
\end{bmatrix}\begin{bmatrix}U_{1}\\
U_{2}
\end{bmatrix}=\frac{1}{2}\begin{bmatrix}U_{1}-U_{2}\\
U_{1}+U_{2}
\end{bmatrix},
\end{equation}

\end_inset

可以将边界条件转化为
\begin_inset Formula 
\begin{equation}
\underline{V}_{\mathrm{L}}=\underline{L^{x}}\,\underline{U}_{\mathrm{L}}=\begin{bmatrix}0\\
0
\end{bmatrix},\qquad\underline{V}_{\mathrm{R}}=\underline{L^{x}}\,\underline{U}_{\mathrm{R}}=\begin{bmatrix}8\\
4
\end{bmatrix},
\end{equation}

\end_inset

并将方程组 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:linear_double_wave"

\end_inset

 解耦为
\begin_inset Formula 
\begin{equation}
\begin{cases}
\left(\partial_{t}+8\partial_{x}\right)V_{1}=0,\\
\left(\partial_{t}+4\partial_{x}\right)V_{2}=0.
\end{cases}
\end{equation}

\end_inset

由此得到两个独立的初边值问题，它们的解析解分别为
\begin_inset Formula 
\begin{equation}
V_{1}^{\star}(x,y,z,t)=\begin{cases}
0 & x<8t\\
8 & x>8t
\end{cases},\qquad V_{2}^{\star}(x,y,z,t)=\begin{cases}
0 & x<4t\\
4 & x>4t
\end{cases}.
\end{equation}

\end_inset

在此基础上，原问题 
\begin_inset CommandInset ref
LatexCommand ref
reference "prob:线性双波平流"

\end_inset

 的解可通过特征变量到守恒变量的反变换 
\begin_inset Formula $\underline{U^{\star}}=\underline{R^{x}}\,\underline{V^{\star}}$
\end_inset

 得到：
\begin_inset Formula 
\begin{equation}
\underline{U^{\star}}(\vec{x},t)=\begin{bmatrix}V_{2}^{\star}+V_{1}^{\star}\\
V_{2}^{\star}-V_{1}^{\star}
\end{bmatrix}=\begin{cases}
\underline{U}_{\mathrm{L}} & x/t<4\\
\underline{U}_{\mathrm{M}} & x/t\in(4,8)\\
\underline{U}_{\mathrm{R}} & x/t>8
\end{cases},\label{eq:linear_double_wave_solution}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\underline{U}_{\mathrm{L}}=\begin{bmatrix}0\\
0
\end{bmatrix},\qquad\underline{U}_{\mathrm{M}}=\begin{bmatrix}4\\
4
\end{bmatrix},\qquad\underline{U}_{\mathrm{R}}=\begin{bmatrix}12\\
-4
\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
此解析解可以被用来定量地评估数值求解器的性能。本小节使用图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_scalar_p=3_h=2^-3"

\end_inset

 所示的网格，测试了四种求解器–限制器组合，所得结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_double_wave_contour"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_double_wave_sample"

\end_inset

 所示，其中图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_double_wave_sample"

\end_inset

 依然为沿纵向对称轴均匀分布的 1001 个采样点处的函数值。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_system/u_1_contour.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_system/u_2_contour.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_double_wave_contour"

\end_inset

在只含 
\begin_inset Formula $h\approx2^{-3}$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性双波平流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.3$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_system/u_1.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_system/u_2.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_double_wave_sample"

\end_inset

不同求解器–限制器组合在同一网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:线性双波平流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.3$
\end_inset

 时刻的近似解之间的比较
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了更清晰地展示各种求解器–限制器组合的效果，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_double_wave_error"
plural "false"
caps "false"
noprefix "false"

\end_inset

 比较了以上四种数值解的绝对误差。这里的“绝对误差”定义为
\begin_inset Formula 
\begin{equation}
\varepsilon(x)=\left(\left|U_{1}^{h}-U_{1}^{\star}\right|+\left|U_{2}^{h}-U_{2}^{\star}\right|\right)_{y=0.5,\,z=0.25,\,t=0.3}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/linear_system/error.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:linear_double_wave_error"

\end_inset

图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:linear_double_wave_sample"

\end_inset

 所示近似解的绝对误差之比较
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
由以上结果可知：
\family typewriter
LazyWeno
\family default
 及 
\family typewriter
EigenWeno
\family default
 这两种限制器都能有效地压制非物理振荡，且后者压制振荡的效果优于前者。基于此结论，本文剩余部分的所有算例都将全部采用 
\family typewriter
EigenWeno
\family default
 限制器，并且所有算例均为描述无黏可压缩流动的三维欧拉方程
\begin_inset Formula 
\begin{equation}
\partial_{t}\begin{bmatrix}\rho\\
\rho u_{x}\\
\rho u_{y}\\
\rho u_{z}\\
\rho e_{0}
\end{bmatrix}+\partial_{x}\begin{bmatrix}\rho u_{x}\\
\rho u_{x}u_{x}+p\\
\rho u_{y}u_{x}\\
\rho u_{z}u_{x}\\
\rho h_{0}u_{x}
\end{bmatrix}+\partial_{y}\begin{bmatrix}\rho u_{y}\\
\rho u_{x}u_{y}\\
\rho u_{y}u_{y}+p\\
\rho u_{z}u_{y}\\
\rho h_{0}u_{y}
\end{bmatrix}+\partial_{z}\begin{bmatrix}\rho u_{z}\\
\rho u_{x}u_{z}\\
\rho u_{y}u_{z}\\
\rho u_{z}u_{z}+p\\
\rho h_{0}u_{z}
\end{bmatrix}=\begin{bmatrix}0\\
0\\
0\\
0\\
0
\end{bmatrix}\label{eq:euler_system}
\end{equation}

\end_inset

与某些初始条件及边界条件所构成的初边值问题。
\end_layout

\begin_layout Section
基于一维流场数值精确解的定量验证
\end_layout

\begin_layout Standard
激波管问题是欧拉方程的黎曼问题。其精确解含有激波、膨胀波、接触间断中的一种或多种，有时还会形成真空；又因其流场边界几何外形简单，初始条件、边界条件非常容易设置，
自其被提出以来便被用作考核欧拉方程数值解的标准算例。
\end_layout

\begin_layout Standard
它们通常被简化为一维问题，但本文将其用于验证三维欧拉方程求解器的正确性，因此需要在三维空间内重新给出其定义。本小节的所有问题都在三维区间 
\begin_inset Formula $[0.0,5.0]\times[0.0,1.0]\times[0.0,0.5]$
\end_inset

 内求解，且平行于 
\begin_inset Formula $x$
\end_inset

 轴的边界均设为固体壁面。尽管这些问题没有封闭形式的解析解，但基于文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Toro_2009"
literal "false"

\end_inset

 介绍的方法，辅之以精度充分高的非线性代数方程求解器，仍然可以得到精度任意高的近似解。这种近似解的精度可以充分高，以至于其与实数范围内的精确解具有相同的（有限位
）浮点数表示。若无特别说明，本文剩余部分提到的“精确解”都是指“浮点数范围内的精确解”或“计算机上的精确解”。
\end_layout

\begin_layout Subsection
Sod 激波管问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[Sod 激波管]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:Sod-激波管"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0.0,1.0]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及边界条件
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}=\begin{cases}
\begin{bmatrix}1 & 0 & 0 & 0 & 1\end{bmatrix}, & x=0,\\
\begin{bmatrix}\frac{1}{8} & 0 & 0 & 0 & \frac{1}{10}\end{bmatrix}, & x=5,
\end{cases}
\end{equation}

\end_inset

与初始条件
\end_layout

\begin_layout Problem
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{cases}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=0}, & x<2.5,\\
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=5}, & x>2.5,
\end{cases}
\end{equation}

\end_inset

的广义解。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_hexa"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出了在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的该问题的 RK3/DG3 近似解。由此图中的四个间断（两个导数值间断、两个函数值间断）处的光滑过渡可知：高阶格式在间断附近引起
的数值振荡得到了有效压制。这种光滑过渡在图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_hexa_p_vary"

\end_inset

 中更为明显。此图沿纵向对称轴 (
\begin_inset Formula $y=0.5,\,z=0.25$
\end_inset

) 均匀选取了 1001 个采样点，依次画出了 RK1/DG1、RK2/DG2、RK3/DG3 近似解在这些采样点处的密度值。由图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_hexa_p_vary"

\end_inset

 还可知：在相同的网格上，求解器的阶数越高，数值解的精度也越高。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/sod/contour.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:sod_hexa"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z,t=1.0)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/sod/result.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:sod_hexa_p_vary"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解之间的比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=1.0)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了验证上述结论的网格无关性，我们在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上再次求解了 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题，所得结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_tetra"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_tetra_p_vary"

\end_inset

 所示。将它们与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_hexa"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_hexa_p_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 比较，不难发现：无论采用何种单元，只要网格足够精细，
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解均能收敛到精确解。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/sod/contour_tetra.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:sod_tetra"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z,t=1.0)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/sod/result_tetra.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:sod_tetra_p_vary"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解之间的比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=1.0)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了更公平地比较不同阶数的求解器，作者开展了一组数值试验，将低阶 RKDG 求解器在细网格上的性能与高阶 RKDG 求解器在粗网格上的性能进行了对比。图
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sod_error"

\end_inset

、表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:sod_cost"

\end_inset

 给出了三组试验的结果。由该图、表可知：（1）RK1/DG1 近似解的全局误差、运行时间、存储空间均最大，性价比最低；（2）RK3/DG3 与
 RK3/DG3 近似解的全局误差、运行时间大致相当，但 RK2/DG2 近似解所需的存储空间较大，故其性价比低于 RK3/DG3 近似解；（3）求解器精度每提
高一阶，单元尺寸与时间步长可增加一倍，体单元数与时间步数的乘积可以减小为原来的 
\begin_inset Formula $1/16$
\end_inset

。因此，只要 
\begin_inset Formula $p+1$
\end_inset

 阶 RKDG 求解器分摊到每个体单元上的单步计算量不超过 
\begin_inset Formula $p$
\end_inset

 阶 RKDG 求解器的 
\begin_inset Formula $16$
\end_inset

 倍，就具有更高的性价比。这里的“性”指全局精度，“价”指运行时间及存储空间。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/sod/h_vary_tetra.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:sod_error"

\end_inset

不同求解器–网格 (
\begin_inset Formula $h$
\end_inset

–
\begin_inset Formula $p$
\end_inset

) 组合对 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的计算精度之比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=1.0)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:sod_cost"

\end_inset

不同 
\begin_inset Formula $p$
\end_inset

–
\begin_inset Formula $h$
\end_inset

（求解器–网格）组合对 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的计算成本之比较
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
体单元数
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
时间步数
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
运行时间 (s)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
存储空间 (MB)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2469675
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1492.16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1230
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/18
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
117045
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
279.119
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
213
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19815
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
250
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
201.034
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
89
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
需要说明的是，不同于表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:linear_cost"

\end_inset

，表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:sod_cost"

\end_inset

 中的数据没有夸大低阶 RKDG 求解器的运行时间，这是因为这里的 RK1/DG1、RK2/DG2 求解器采用了与之相对应的低阶数值积分器。具体地说，这里的
 RK1/DG1 求解器采用了 
\begin_inset Formula $1$
\end_inset

 点四面体积分器与 
\begin_inset Formula $1$
\end_inset

 点三角形积分器，RK2/DG2 求解器采用了 
\begin_inset Formula $4$
\end_inset

 点四面体积分器与 
\begin_inset Formula $3$
\end_inset

 点三角形积分器，RK3/DG3 求解器采用了 
\begin_inset Formula $14$
\end_inset

 点四面体积分器与 
\begin_inset Formula $6$
\end_inset

 点三角形积分器。因此，本节关于性价比的结论比线性单波方程一节得到的类似结论更加可靠，也更具有实际意义。
\end_layout

\begin_layout Subsection
Lax 激波管问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[Lax 激波管]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:Lax-激波管"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0.0,0.6]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及边界条件
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}=\begin{cases}
\begin{bmatrix}0.445 & 0.698 & 0.000 & 0.000 & 3.528\end{bmatrix}, & x=0,\\
\begin{bmatrix}0.500 & 0.000 & 0.000 & 0.000 & 0.571\end{bmatrix}, & x=5,
\end{cases}
\end{equation}

\end_inset

与初始条件
\end_layout

\begin_layout Problem
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{cases}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=0}, & x<2.5,\\
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=5}, & x>2.5,
\end{cases}
\end{equation}

\end_inset

的广义解。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
与 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题类似，该问题的精确解也含有激波、接触间断、膨胀波这三种间断。相对而言，该问题的求解难度更大，这是因为其精确解的各个分量均含有超出其初始值范围的部分，并且接触
间断与激波的跳跃幅度远大于 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题中的值（无论是相对值还是绝对值）。
\end_layout

\begin_layout Standard
与 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题类似，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lax_hexa"

\end_inset

 给出了在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lax_hexa_p_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 沿纵向对称轴 (
\begin_inset Formula $y=0.5,\,z=0.25$
\end_inset

) 均匀选取了 1001 个采样点，依次画出了 RK1/DG1、RK2/DG2、RK3/DG3 近似解在这些采样点处的密度值。由这两幅图不难再次得出结论：（1）
高阶格式在间断附近引起的数值振荡得到了有效压制；（2）在相同的网格上，求解器的阶数越高，数值解的精度也越高。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/lax/contour.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:lax_hexa"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z,t=0.5)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/lax/result.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:lax_hexa_p_vary"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解之间的比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=0.5)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了验证计算结果及上述结论的网格无关性，我们在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上再次求解了 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题，所得结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lax_tetra"
plural "false"
caps "false"
noprefix "false"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lax_tetra_p_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。将它们与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lax_hexa"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lax_hexa_p_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 比较，不难发现：无论采用何种单元，只要网格足够精细，
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解均能收敛到精确解。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/lax/contour_tetra.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:lax_tetra"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z,t=0.5)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/lax/result_tetra.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:lax_tetra_p_vary"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上得到的 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解之间的比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=0.5)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
真空管问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[真空管]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:真空管"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0.0,0.4]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及边界条件
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}=\begin{cases}
\begin{bmatrix}1.0 & -4.0 & 0.0 & 0.0 & 0.4\end{bmatrix}, & x=0,\\
\begin{bmatrix}1.0 & +4.0 & 0.0 & 0.0 & 0.4\end{bmatrix}, & x=5,
\end{cases}
\end{equation}

\end_inset

与初始条件
\end_layout

\begin_layout Problem
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{cases}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=0}, & x<2.5,\\
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=5}, & x>2.5,
\end{cases}
\end{equation}

\end_inset

的广义解。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
该问题只含膨胀波这种导数值间断，不含激波、接触间断这类函数值间断，因此对限制器的要求比 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Sod-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题及 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:Lax-激波管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题更低。然而，该问题的精确解中含有一段连续的真空区域，这是求解前两个问题的过程中没有遇到过的现象。文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Toro_2009"
literal "true"

\end_inset

 的 4.6 节对真空区域的处理开展了充分的讨论。本文根据其建议，按如下方式确定真空区域的状态：真空区域（在下标中用 
\begin_inset Formula $*$
\end_inset

 表示）内没有气体分子，因此密度 
\begin_inset Formula $\rho$
\end_inset

 及压强 
\begin_inset Formula $p$
\end_inset

 可以设为 
\begin_inset Formula $0$
\end_inset

，但速率 
\begin_inset Formula $u$
\end_inset

 是未定义的；另一方面，真空区域的边界恰好是膨胀波的波尾，因此其上的速率值可以由穿过膨胀波的黎曼不变量求得，即
\begin_inset Formula 
\begin{equation}
u_{*L}=u_{L}+\frac{2a_{L}}{\gamma-1},\qquad u_{*R}=u_{R}-\frac{2a_{R}}{\gamma-1}.
\end{equation}

\end_inset

在这里，下标中的 
\begin_inset Formula $L$
\end_inset

 与 
\begin_inset Formula $R$
\end_inset

 分别表示左、右，符号 
\begin_inset Formula $a=\sqrt{\gamma p/\rho}$
\end_inset

 表示当地声速。
\end_layout

\begin_layout Standard
根据前两个问题类似，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:vacuum_hexa"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出了在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:真空管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:vacuum_hexa_p_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 沿纵向对称轴 (
\begin_inset Formula $y=0.5,\,z=0.25$
\end_inset

) 均匀选取了 1001 个采样点，依次画出了 RK1/DG1、RK2/DG2、RK3/DG3 近似解在这些采样点处的密度值。结果再次验证了的有效性和阶数与精度
的正相关。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/vacuum/contour.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:vacuum_hexa"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:真空管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z,t=0.4)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/vacuum/result.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:vacuum_hexa_p_vary"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的六面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:真空管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解之间的比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=0.4)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
与之前两个问题类似，我们在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上再次求解了
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:真空管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题，所得结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:vacuum_tetra"
plural "false"
caps "false"
noprefix "false"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:vacuum_tetra_p_vary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。数值解的网格无关性再次得到了验证。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/vacuum/contour_tetra.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:vacuum_tetra"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:真空管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z,t=0.4)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/shock_tubes/vacuum/result_tetra.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:vacuum_tetra_p_vary"

\end_inset

在只含 
\begin_inset Formula $h\approx0.1$
\end_inset

 的四面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:真空管"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的各阶 RKDG 近似解之间的比较（按 
\begin_inset Formula $\rho(x,y=0.5,z=0.25,t=0.4)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
基于二维流场高精度近似解的定性验证
\end_layout

\begin_layout Subsection
双马赫反射问题
\end_layout

\begin_layout Standard
该问题模拟一道 
\begin_inset Formula $10$
\end_inset

 马赫的激波迎头撞击一个 
\begin_inset Formula $\ang{60}$
\end_inset

 楔形障碍物的流动图象，边界条件及初始条件如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_sketch"

\end_inset

 所示，其中 
\begin_inset Formula $\delta=1/6$
\end_inset

，黑色细实线表示固体壁面，红色粗实线表示初始激波。
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/double_mach/sketch.pdf
	lyxscale 50
	width 100theight%
	height 33theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_sketch"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"

\end_inset

问题的边界条件及初始条件示意图
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
以文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Woodward_1984"
literal "true"

\end_inset

 为代表，该问题通常以二维形式出现。与激波管问题类似，我们在三维空间内重新给出其定义。
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[双马赫反射]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:双马赫反射"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0.0,0.2]$
\end_inset

 及图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_sketch"
plural "false"
caps "false"
noprefix "false"

\end_inset

 中虚线所围计算区域（厚度 
\begin_inset Formula $Z$
\end_inset

 为任意有限值）内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及如下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{cases}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{A}, & \sqrt{3}(x-x_{0})<y,\\
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{B}, & \sqrt{3}(x-x_{0})>y,
\end{cases}\label{eq:double_mach_ic}
\end{equation}

\end_inset

其中
\begin_inset Formula 
\begin{equation}
\begin{aligned}\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{A} & =\begin{bmatrix}8.0 & 4.125\sqrt{3} & -4.125 & 0.0 & 116.5\end{bmatrix},\\
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{B} & =\begin{bmatrix}1.4 & 0.0 & 0.0 & 0.0 & 1.0\end{bmatrix},
\end{aligned}
\end{equation}

\end_inset

分别为波后 (After the wave) 与波前 (Before the wave) 状态。
\end_layout

\begin_layout Problem
边界条件如下：
\end_layout

\begin_deeper
\begin_layout Itemize
左端 (
\begin_inset Formula $x=0$
\end_inset

) 为超声速入口，状态设为 
\begin_inset Formula $\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{A}$
\end_inset

；
\end_layout

\begin_layout Itemize
右端 (
\begin_inset Formula $x=4$
\end_inset

) 及底部前段 (
\begin_inset Formula $y=0$
\end_inset

 且 
\begin_inset Formula $x<\delta$
\end_inset

) 为超声速出口（无需设置状态）；
\end_layout

\begin_layout Itemize
底部后段 (
\begin_inset Formula $y=0$
\end_inset

 且 
\begin_inset Formula $x<\delta$
\end_inset

) 为固体壁面；
\end_layout

\begin_layout Itemize
顶部 (
\begin_inset Formula $y=1$
\end_inset

) 状态随时间变化，并且与初始条件 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:double_mach_ic"
plural "false"
caps "false"
noprefix "false"

\end_inset

 兼容：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}=\begin{cases}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{A}, & x-(\delta+4.125\sqrt{3}t)<\sqrt{1/3},\\
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{B}, & x-(\delta+4.125\sqrt{3}t)>\sqrt{1/3}.
\end{cases}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
该问题的解具有自相似性，因此只需要画出某一时刻的计算结果。为了方便对比，这里仿照文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Woodward_1984,Zhong_2013,Zhu_2013"
literal "true"

\end_inset

 的习惯，画出 
\begin_inset Formula $t=0.2$
\end_inset

 时刻、二维区间 
\begin_inset Formula $[0,3]\times[0,1]$
\end_inset

 与 
\begin_inset Formula $z=Z/2$
\end_inset

 平面交集内的密度分布。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=1_h=5e-3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=3_h=5e-3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 依次为
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在只含 
\begin_inset Formula $h\approx1/200$
\end_inset

 的六面体单元的非结构网格上的 RK1/DG1、RK2/DG2、RK3/DG3 近似解。三者给出的流场结构大致相同，都含有一道弓形激波与两组马赫反射；但只有高阶
近似解才能捕捉到右下角的复杂涡系。这种差别再次体现了高阶 RKDG 求解器分辨流动细节的优越性。
\end_layout

\begin_layout Standard
为了定性验证以上结果的正确性，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=3_zhong"

\end_inset

 给出了文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Zhong_2013"
literal "false"

\end_inset

 在 
\begin_inset Formula $h=1/240$
\end_inset

 的二维结构网格上得到的二维 RK3/DG3 近似解。将其与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=3_h=5e-3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 即本文在 
\begin_inset Formula $h\approx1/200$
\end_inset

 的三维非结构网格上得到的三维 RK3/DG3 近似解对比，不难发现：二者给出的流场结构几乎完全一致，这说明本文所实现的三维 RK3/DG3 求解器能够在三维非
结构网格上正确地捕捉复杂的二维流场结构。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/double_mach/p=1_h=5e-3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_p=1_h=5e-3"

\end_inset

在只含 
\begin_inset Formula $h\approx1/200$
\end_inset

 的六面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK1/DG1 近似解（按 
\begin_inset Formula $\rho(x,y,z=Z/2,t=0.2)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/double_mach/p=2_h=5e-3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_p=2_h=5e-3"

\end_inset

在只含 
\begin_inset Formula $h\approx1/200$
\end_inset

 的六面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK2/DG2 近似解（按 
\begin_inset Formula $\rho(x,y,z=Z/2,t=0.2)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/double_mach/p=3_h=5e-3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_p=3_h=5e-3"

\end_inset

在只含 
\begin_inset Formula $h\approx1/200$
\end_inset

 的六面体单元的非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,z=Z/2,t=0.2)$
\end_inset

 作图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/double_mach/zhong.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_p=3_zhong"

\end_inset

在只含 
\begin_inset Formula $h=1/240$
\end_inset

 的四边形单元的二维结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y,t=0.2)$
\end_inset

 作等值线图）
\begin_inset CommandInset citation
LatexCommand cite
key "Zhong_2013"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
前向台阶问题
\end_layout

\begin_layout Standard
该问题是另一个用于校验无黏可压缩气流数值解的经典二维问题。该问题的边界条件与初始条件比双马赫反射问题的简单，但其解不具有自相似性，所涉及的物理现象更加复杂，因此
对求解器的性能要求更为苛刻。与双马赫反射问题类似，我们在三维空间内重新给出其定义。
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[前向台阶]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:前向台阶"

\end_inset

考虑一个由三维区间 
\begin_inset Formula $[0,3]\times[0,1]\times[0,Z]$
\end_inset

 表示的风洞，其底部设有一始于 
\begin_inset Formula $x=0.6$
\end_inset

 处、高度为 
\begin_inset Formula $0.2$
\end_inset

 的水平台阶。左端 (
\begin_inset Formula $x=0$
\end_inset

) 为超声速入口，右端 (
\begin_inset Formula $x=3$
\end_inset

) 为超声速出口，其余边界均设为固体壁面。在上述计算区域与时间范围 
\begin_inset Formula $t\in[0.0,4.0]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及初始条件
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.4 & 3.0 & 0.0 & 0.0 & 1.0\end{bmatrix}
\end{equation}

\end_inset

与边界条件
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=0}=\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}
\end{equation}

\end_inset

的广义解。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_domain"

\end_inset

 给出了一种可用于求解该问题的只含有 
\begin_inset Formula $h=1/20$
\end_inset

 的六面体单元的伪结构网格。这里的“伪结构”指其可以用结构网格的数据结构来表示，但本小节的所有算例仍将其以非结构网格的数据结构来表示。需要说明的是，该网格仅用于
展示网格拓扑，其精细程度不足以捕捉图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=02e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=40e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示的复杂流动结构。实际上，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=02e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=40e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 使用了 
\begin_inset Formula $h=1/200$
\end_inset

 的精细网格。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/mesh.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_domain"

\end_inset

用于求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的只含 
\begin_inset Formula $h=1/20$
\end_inset

 的六面体单元的伪结构网格
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
由于该问题的解在上述时间范围内剧烈变化，最理想的呈现计算结果的方式应当是动画。本节仿照文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Woodward_1984"
literal "true"

\end_inset

 的做法，将数值解在若干时刻的状态分别以图片的形式给出。
\end_layout

\begin_layout Standard
流场始于 
\begin_inset Formula $3$
\end_inset

 马赫的均匀状态（未画出）。
\end_layout

\begin_layout Standard
计时开始后，超声速气流撞击在台阶上，形成一道弓形激波，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=02e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=04e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。与此同时，在台阶上表面前端的拐角处 (
\begin_inset Formula $x=0.6$
\end_inset

, 
\begin_inset Formula $y=0.2$
\end_inset

) 还形成了一道膨胀波，拐角附近的气流状态接近真空。因此该算例对求解器捕捉激波和处理真空的能力都提出了很高的要求。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=02e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=02e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=04e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=04e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.4$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
大约在 
\begin_inset Formula $t=0.6$
\end_inset

 时刻，该弓形激波与风洞顶部发生碰撞并发生反射，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=06e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。该反射为常规反射，反射波向风洞底部运动，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=08e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=10e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=06e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=06e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.6$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=08e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=08e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的问题 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

 在 
\begin_inset Formula $t=0.8$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=10e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=10e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
大约在 
\begin_inset Formula $t=1.2$
\end_inset

 时刻，反射波与台阶顶部发生碰撞并再次反射，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=12e-1"

\end_inset

 所示。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=12e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=12e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.2$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
大约在 
\begin_inset Formula $t=2.0$
\end_inset

 时刻，该二级反射依然为常规反射，但风洞顶部的初级反射已发展为马赫反射，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=20e-1"

\end_inset

 所示。垂直于壁面的马赫杆，入射波、反射波、马赫杆汇聚处的三岔点，以及自三岔点向后拖出的剪切层，正是马赫反射的标志性特征。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=20e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=20e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=2.0$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
此后一段时间，马赫杆逐渐拉长，二级反射波逐渐靠近风洞顶部，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=24e-1"

\end_inset

 所示。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=24e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=24e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=2.4$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
大约在 
\begin_inset Formula $t=2.8$
\end_inset

 时刻，二级反射波与风洞顶部发生碰撞并形成三级反射，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=28e-1"

\end_inset

 所示。不难想象，如果风洞的长度足够长，且计算的时间范围也足够大，那么这种反射的级数还有可能继续增加。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=28e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=28e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=2.8$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
自 
\begin_inset Formula $t=2.8$
\end_inset

 时刻起，到 
\begin_inset Formula $t=4.0$
\end_inset

 时刻止，一个显著发展的流动特征是三叉点后的波纹状剪切层涡系，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=28e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=3_t=40e-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Woodward_1984"
literal "true"

\end_inset

 认为，这种波纹的形成是数值误差引起的扰动被剪切层的开尔文–亥姆霍兹不稳定性捕获的结果。虽然该涡系的形成有非物理的原因，但对其细节的分辨能力已经成为了评价求解器
性能的一个定性指标，更低阶的求解器或更粗糙的网格都很难捕获该流动特征。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=32e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=32e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=3.2$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=40e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=40e-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=4.0$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/forward_step/p=3_t=40e-1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=3_t=40e-1-1"

\end_inset

在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=4.0$
\end_inset

 时刻的 RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了定性验证以上结果的正确性，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_step_p=5_qiu"

\end_inset

 给出了文献-
\begin_inset CommandInset citation
LatexCommand citet
key "Giri_2019"
literal "false"

\end_inset

 在三级自适应加密（最粗处 
\begin_inset Formula $h\approx1/32$
\end_inset

，最细处 
\begin_inset Formula $h\approx1/256$
\end_inset

）的三角形网格上得到的二维 RK3/DG5 近似解，它是该问题目前已发表的最高精度的近似解。将其与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=3_h=5e-3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 即本文在 
\begin_inset Formula $h=1/200$
\end_inset

 的伪结构网格上得到的三维 RK3/DG3 近似解对比，不难发现：二者给出的流场结构非常相似，这说明本文所实现的三维 RK3/DG3 求解器能够在三维伪结构网格
上正确地捕捉复杂的二维流场结构。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward_step/qiu.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_step_p=5_qiu"

\end_inset

在三级自适应加密的二维非结构网格上得到的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:前向台阶"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG5 高精度近似解（按 
\begin_inset Formula $\rho(x,y,t=4)$
\end_inset

 作图）
\begin_inset CommandInset citation
LatexCommand cite
key "Giri_2019"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
本章小结
\end_layout

\begin_layout Standard
本章基于大量算例，对第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:算法"
plural "false"
caps "false"
noprefix "false"

\end_inset

章所提高阶计算方法进行了充分的验证。计算结果表明：高阶 RKDG 近似解的数值耗散较低，能够在相对较粗的非结构网格上捕获复杂的流动细节，比细网格上的低阶近似解具
有更高的性价比。
\end_layout

\begin_layout Chapter
三维流场的并行计算及并行性能测评
\begin_inset CommandInset label
LatexCommand label
name "chap:并行"

\end_inset


\end_layout

\begin_layout Standard
带有紧致 WENO 限制器的 RKDG 格式自提出以来，很少有三维工程应用的报道。一个重要原因是每个单元所消耗的计算资源，随着精度阶数或空间维度的增加而迅速增长
。幸运的是，显式 RKDG 格式和紧致 WENO 限制器的大多数计算都可以在本地进行，并且不需要求解全局代数方程组。基于这些事实，基于区域分解的分布式并行计算可
以很自然地用来加速计算。目前（2022 年初），对于带有紧致 WENO 限制器的 RKDG 格式，还没有公开发表的并行实现。但有一些其他 DG
 格式的并行化案例被公开发表过：
\end_layout

\begin_layout Itemize
Biswas 等
\begin_inset CommandInset citation
LatexCommand cite
key "Biswas_1994"
literal "false"

\end_inset

 在均匀结构网格上，测量了其一维、二维线性标量问题 DG 求解器的并行性能。他们获得了接近理想情形的并行效率：纯求解时间（无 I/O）超过 99%，总运行时间至
少 89%。
\end_layout

\begin_layout Itemize
Bey 等
\begin_inset CommandInset citation
LatexCommand cite
key "Bey_1995"
literal "false"

\end_inset

 在均匀（结构）和 
\begin_inset Formula $hp$
\end_inset

-自适应（非结构）网格上，测试了其线性守恒律 DG 求解器的性能。当内部单元的数量远超边界单元的数量时，他们获得了几乎最优的并行效率。
\end_layout

\begin_layout Itemize
Chalmers 等
\begin_inset CommandInset citation
LatexCommand cite
key "Chalmers_2019"
literal "false"

\end_inset

使用 MPI/OpenMP 混合并行，实现了二维 Navier–Stokes 方程 DG 格式的并行化，并在只有四边形单元的均匀网格上实现了良好的可扩展性。
\end_layout

\begin_layout Standard
它们都没有给出其 DG 求解器在三维非结构网格上的并行性能。
\end_layout

\begin_layout Standard
为了让第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:算法"
plural "false"
caps "false"
noprefix "false"

\end_inset

章所述、第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:验证"

\end_inset

章所验证的高阶计算格式具有实用价值，本章将提出并实现一种分布式并行加速方案，并在实验室自建的 100 核机群上测量加速比及并行效率，以评估该方案的性能。
\end_layout

\begin_layout Section
分布式并行计算
\begin_inset CommandInset label
LatexCommand label
name "sec:parallel"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
并行计算机架构
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
非结构网格分块
\end_layout

\begin_layout Standard
CFD 所用的“网格 (mesh)”是一种特殊的“图 (graph)”。前者可以通过调用 
\shape smallcaps
Metis
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Karypis_1998"
literal "false"

\end_inset

 提供的 
\family typewriter
METIS_PartMeshDual(...)
\family default
 来实现分块，后者的分块可以通过调用 
\family typewriter
METIS_PartGraphKway(...)
\family default
 或 
\family typewriter
METIS_PartGraphRecursive(...)
\family default
 来完成。实际上，网格分块函数 
\family typewriter
METIS_PartMeshDual(...)
\family default
 的内部封装了对图分块函数的调用，只不过这里被分块的是网格的“对偶图 (dual graph)”。所谓网格的对偶图，是指以体单元为顶点、以体单元邻接关系为边的图
。
\shape smallcaps
Metis
\shape default
 提供了 
\family typewriter
METIS_MeshToDual(...)
\family default
，用于将非结构网格转化为其对偶图。
\end_layout

\begin_layout Standard
RKDG 格式中的面积分残差，即式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:boundary_residual"

\end_inset

，以及 WENO 重构过程中遍历邻接单元的操作，都对体单元访问其邻接单元的效率提出了很高的要求：各体单元应能在常数时间内访问其任意邻接单元。就非结构网格而言，这
意味着每个体单元都要预先存储其所有邻接单元的指针（或引用）。单元的邻接关系隐含在结点的连接关系里，因此大多数网格文件格式都不会显式记录该信息。
\end_layout

\begin_layout Standard
出于上述原因，本文不像传统的并行有限元方法那样直接对网格分块，而是先用 
\family typewriter
METIS_MeshToDual(...)
\family default
 将非结构网格转化为其对偶图，再用 
\family typewriter
METIS_PartGraphKway(...)
\family default
 或 
\family typewriter
METIS_PartGraphRecursive(...)
\family default
 对该对偶图实施分块。需要注意的是，用 C 语言编写的 
\family typewriter
METIS_MeshToDual(...)
\family default
 函数，将单元邻接信息存储在动态分配的数组里，并返回指向该数组头部的地址。为避免内存泄漏造成动态内存空间耗尽，该动态数组必须被调用栈里的某一个且只有一个调用者释
放。利用现代 C++ 标准库提供的智能指针接管该动态数组，能够有效地避免动态内存忘记释放或释放不止一次等内存故障
\begin_inset CommandInset citation
LatexCommand cite
key "Meyers_2014"
literal "false"

\end_inset

。
\end_layout

\begin_layout Subsection
进程间消息传递
\end_layout

\begin_layout Standard
获得网格分块后，每一块上的数据都应由一个进程加载。各进程串行地保存和更新本地数据，并在必要时与邻居交换公共边界上的数据。这是分布式并行计算的典型场景，它通过在多
个处理器核心上同时解决规模相等或接近的子问题来实现加速。与之相比，由多个线程共享同一内存空间的并行程序通常更易于编写，但存在扩展性瓶颈，通常只适用于安装有多核处
理器的单机并行计算。
\end_layout

\begin_layout Standard
为保持扩展性，本文选择分布式并行方案。为此，需要付出的代价是显式传递消息，以实现进程之间的数据交互。得益于学术界和工业界的共同努力，MPI 已经成为事实上的分布
式并行计算行业标准，被称为“并行计算的汇编语言”。
\end_layout

\begin_layout Standard
为了提高代码的可读性和可维护性，本文将涉及通信的操作封装在名为 
\family typewriter
ShareSomething(...)
\family default
 的一组函数中，它们拥有相同的代码结构：
\end_layout

\begin_layout Enumerate
为每个目的地，将要发送的数据放入发送缓冲区，并通过调用 
\family typewriter
MPI_Isend(...)
\family default
 函数注册发送请求。
\end_layout

\begin_layout Enumerate
为每个源进程，分配一个接收缓冲区用于接收数据，并通过调用 
\family typewriter
MPI_Irecv(...)
\family default
 函数注册一个接收请求。
\end_layout

\begin_layout Enumerate
执行无需通信即可完成的其他计算任务。
\end_layout

\begin_layout Enumerate
通过调用 
\family typewriter
MPI_Waitall(...)
\family default
 函数阻塞所有进程，直到其所有发送和接收请求完成。
\end_layout

\begin_layout Standard
其中，第 3 步是可选的，它允许计算与通信重叠，有助于提高并行效率；第 4 步是显式同步操作，除此之外还有一些隐式同步（例如：向同一个文件并行地写入数据），它们
是降低并行性能的直接因素，应尽量避免非必要的同步。
\end_layout

\begin_layout Section
双马赫反射问题的并行性能测评
\end_layout

\begin_layout Standard
本节对第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:验证"

\end_inset

章用于验证近似解精度的
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题做并行性能测评。该问题的初边值条件及近似解具有二维特征，因此在三维空间求解时，沿 
\begin_inset Formula $z$
\end_inset

 方向的网格数量可以很少（本文尝试过取一到三层，所得结果没有显著变化）。因此，对这种伪三维网格的分块，实际上等价于对二维网格的分块。这就造成各块边界上的单元数量
，近似为块内单元数量的 
\begin_inset Formula $\order{N^{1/2}}$
\end_inset

；而对真正的三维网格分块，各块边界上的单元数量，近似为块内单元数量的 
\begin_inset Formula $\order{N^{2/3}}$
\end_inset

。由此可以预测：本节所得并行效率将高于真正三维问题的并行效率。这一预测将被本章 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:YF17-parallel"

\end_inset

 及 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:rotor-parallel"

\end_inset

 小节的数据所证实。
\end_layout

\begin_layout Standard
虽然在求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题时使用了非结构网格，但其所含单元的尺寸大致相等，且计算区域具有简单的几何外形，因此很容易得到较为均匀的网格分块，从而实现静态负载均衡。为了提高求解器的普适性
，我们放弃了这种简单几何外形带来的便利，转而通过调用第三方库 
\shape smallcaps
Metis
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Karypis_1998"
literal "false"

\end_inset

 来实施网格分块。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_partition"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_balance"

\end_inset

 给出了将图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=1_h=5e-3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_p=3_h=5e-3"

\end_inset

 中的非结构网格分割为 100 块的（某次）分块结果，可见单元数量的波动小于 
\begin_inset Formula $3\%$
\end_inset

，大致呈均匀分布。考虑到非结构网格的均匀分块属于 NP-hard 问题，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_partition"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_balance"

\end_inset

 所示的分块效果已经相当令人满意。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/double_mach/partition.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_partition"

\end_inset

将
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所用非结构网格分割为 
\begin_inset Formula $100$
\end_inset

 块的分块结果
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/double_mach/balance.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_balance"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题网格分块结果（图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_partition"

\end_inset

）的单元分布情况
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
基于上述优质的分块工具，我们测量了 RK3/DG3 求解器的加速比及并行效率。表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:double_mach_cost"

\end_inset

 列出了该求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所消耗的时间，其中
\end_layout

\begin_layout Itemize
\begin_inset Formula $P$
\end_inset

 表示进程数量，亦即运行时所需的核心数量。
\end_layout

\begin_layout Itemize
\begin_inset Formula $T_{n}$
\end_inset

 表示完成第 
\begin_inset Formula $n$
\end_inset

 步所消耗的秒数。
\end_layout

\begin_layout Itemize
\begin_inset Formula $P\frac{T_{m+m}-T_{n}}{m}$
\end_inset

 为每一步所消耗的核心数与墙上时间的乘积，简称“核时”。该数据通常被高性能计算平台用作收费依据。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
由于并行读写操作会导致许多聚合通信，聚合通信的效率又依赖于网络质量，因此我们应当尽量减少并行读写的调用次数。在求解该问题时，我们每完成一百步计算才输出一帧结果。
因此，表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:double_mach_cost"

\end_inset

 的后两列之差体现了读写操作的代价，它等于分摊到每一个时间步上读写开销。不难发现：随着核心数量的增加，单步读写开销也在逐渐地增加。这是因为随着核心数量的增加，每
个进程的通信对象的数量以及端到端的距离都在不断增加。
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:double_mach_cost"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所消耗的时间
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $P\,\si{(core)}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{100}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{199}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{200}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\frac{T_{199}-T_{100}}{199-100}\,\si{(core\cdot s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\frac{T_{200}-T_{100}}{200-100}\,\si{(core\cdot s)}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17652.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
35324.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
35519.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
178.508
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
178.671
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
960.443
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1912.37
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1926.58
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.307
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
193.228
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
491.070
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
971.710
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
983.933
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
194.198
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
197.145
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
335.651
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
666.548
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
676.930
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200.544
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
204.767
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
251.548
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
494.541
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
504.951
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
196.358
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
202.722
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
202.789
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
397.641
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
408.126
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
196.820
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
205.337
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
由表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:double_mach_cost"

\end_inset

 中的数据，可以导出加速比 
\begin_inset Formula $S$
\end_inset

 与并行效率 
\begin_inset Formula $E$
\end_inset

，二者定义如下：
\begin_inset Formula 
\begin{equation}
S=\frac{T_{\text{serial}}}{T_{\text{parallel}}},\qquad E=\frac{S}{P}\times100\%.\label{eq:speedup}
\end{equation}

\end_inset

所得结果分别绘于图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_speedup"

\end_inset

 与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_efficiency"

\end_inset

。这两幅图更直观地体现了并行读写操作对并行程序扩展性的不利影响。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/double_mach/speedup.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_speedup"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所得的加速比
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/double_mach/efficiency.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_mach_efficiency"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所得的并行效率
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_efficiency"

\end_inset

 所示的并行效率在 
\begin_inset Formula $90\%$
\end_inset

 附近波动，这比文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Biswas_1994"
literal "false"

\end_inset

 中给出的 
\begin_inset Formula $99\%$
\end_inset

 略差。造成这种差距的主要原因，在于该文献中的算例都是基于一维、二维的结构网格，分块数量又恰好是 
\begin_inset Formula $2^{n}$
\end_inset

，因此经过 
\begin_inset Formula $n$
\end_inset

 次几何等分，就能得到完美的均匀分块。本节所有算例均基于三维非结构网格，因此图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_efficiency"

\end_inset

 中的并行效率更具有参考价值。
\end_layout

\begin_layout Section
三维流场的并行计算及性能测评
\end_layout

\begin_layout Standard
为了验证第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:算法"
plural "false"
caps "false"
noprefix "false"

\end_inset

章所提高阶计算方法对具有复杂边界的处理能力，本小节在如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_mesh"

\end_inset

 所示只含四面体单元的三维非结构网格上，求解轻量级原型战斗机 YF-17 的全机绕流问题。该网格机身一侧的外部空间离散为 528915 个四面体单元。单元尺寸变
换剧烈：近壁面单元大致与壁面曲率成反比，最小边长约为 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
SI{5}{cm}
\end_layout

\end_inset

；远场单元大致均匀，边长约为 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
SI{3.7}{m}
\end_layout

\end_inset

。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/mesh.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_mesh"

\end_inset

用于求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_亚声速绕流"

\end_inset

、
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的三维非结构网格（只显示边界上的三角形单元）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
具有复杂边界的亚声速流场
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[YF-17 亚声速绕流]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:YF-17_亚声速绕流"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0,10]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及以下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为 20 deg 迎角、0.3 马赫的亚声速气流：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.4 & 0.2819 & 0.0 & 0.1026 & 1.0\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Problem
边界条件如下
\end_layout

\begin_deeper
\begin_layout Itemize
机身、机翼表面及对称面 (
\begin_inset Formula $y=0$
\end_inset

) 均为固体壁面；
\end_layout

\begin_layout Itemize
远场为亚声速入口或出口，状态与初始条件相同；
\end_layout

\begin_layout Itemize
进气道入口为（外流场的）亚声速出口，状态与初始条件相同；
\end_layout

\begin_layout Itemize
尾喷管出口为（外流场的）超声速入口：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{\text{尾喷口}}=\begin{bmatrix}1.4 & 2.4 & 0.0 & 0.0 & 1.44\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_subsonic_p=1"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_subsonic_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 分别给出了基于 RK1/DG1、RK3/DG3 近似解的速度流线图。由二者对比可知，基于 RK3/DG3 近似解得到的流线比基于 RK1/DG1
 近似解得到的流线更光滑。这是因为 RK1/DG1 近似解在各单元内是常值，而 RK3/DG3 近似解在各单元内是二次多项式。这再次体现了提高求解器阶数对精度的
提升作用。
\end_layout

\begin_layout Standard
由流线形状可知：两种近似解都能够捕获从机翼翼尖、边条翼外缘拖出的涡。从机翼翼尖拖出的涡（简称“翼尖涡”）是由机翼上下表面之间的压力差产生的：当机翼产生正升力时，
下翼面的压力高于上翼面的压力；在这个压力差的作用下，机翼下方的空气围绕翼尖卷起并随着来流向后移动，从而形成翼尖涡。从边条翼外缘拖出的涡（简称“边条涡”）的产生机
制也与之类似。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/streamlines_p=1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_subsonic_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_亚声速绕流"

\end_inset

问题在 
\begin_inset Formula $t=10$
\end_inset

 时刻的 RK1/DG1 近似解（曲线为流线，按 
\begin_inset Formula $\rho(x,y,z,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/streamlines_p=3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_subsonic_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_亚声速绕流"

\end_inset

问题在 
\begin_inset Formula $t=10$
\end_inset

 时刻的 RK3/DG3 近似解（曲线为流线，按 
\begin_inset Formula $\rho(x,y,z,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了更直观地对比两种近似解的精度，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_subsonic_rho"

\end_inset

 将 RK3/DG3 近似解显示在左侧，将 RK1/DG1 近似解关于对称面 (
\begin_inset Formula $y=0$
\end_inset

) 的镜像显示在右侧。由此图可知：二者均能捕捉到清晰的翼尖涡涡核；边条涡的涡核只在 RK3/DG3 近似解中较为明显，而在 RK1/DG1 近似解中则显得非常模
糊。这一事实再次体现了在粗网格上使用高阶求解器的必要性。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/rho_subsonic.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_subsonic_rho"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_亚声速绕流"

\end_inset

问题的 RK3/DG3 近似解（左）与 RK1/DG1 近似解（右）之对比（按 
\begin_inset Formula $\rho(x=0.5,y,z,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
具有复杂边界的超声速流场
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[YF-17 超声速绕流]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:YF-17_超声速绕流"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0,10]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及以下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为 0 deg 迎角、2.0 马赫的超声速气流：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.4 & 2.0 & 0.0 & 0.0 & 1.0\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Problem
边界条件如下：
\end_layout

\begin_deeper
\begin_layout Itemize
机身、机翼表面及对称面 (
\begin_inset Formula $y=0$
\end_inset

) 均为固体壁面；
\end_layout

\begin_layout Itemize
远场为超声速入口或出口，前者状态与初始条件相同，后者状态无需预设；
\end_layout

\begin_layout Itemize
进气道入口为（外流场的）超声速出口，状态无需预设；尾喷管出口为（外流场的）超声速入口：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u & v & w & p\end{bmatrix}_{\text{尾喷口}}=\begin{bmatrix}1.4 & 2.4 & 0.0 & 0.0 & 1.44\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
与 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_亚声速绕流"

\end_inset

问题类似，这里采用 RK1/DG1、RK3/DG3 求解器分别求解该问题，所得结果分别如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_p=1"
plural "false"
caps "false"
noprefix "false"

\end_inset

、
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。与亚声速绕流不同，超声速绕流的一大特征是存在激波及膨胀波。
\end_layout

\begin_layout Standard
RK1/DG1 求解器等价于一阶有限体积求解器，能够自动捕捉激波而不产生数值振荡。因此，图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_p=1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 较为可靠地显示了激波及膨胀波的分布情况：激波（红色）在迎风面上产生，该处气流的相对速度大于当地声速，发生强烈压缩；膨胀波（蓝色）在背风面产生，固体壁面在该处收
缩，为超声速气流让出更多空间。
\end_layout

\begin_layout Standard
 RK3/DG3 求解器必须开启限制器（例如本文所使用的紧致 WENO 限制器），才能压制激波附近的数值振荡。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所显示的激波及膨胀波分布，与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_p=1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出的结果一致，但在光滑区域的每个单元内由常值近似提升为二次多项式近似。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/rho_p=1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_supersonic_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK1/DG1 近似解（按 
\begin_inset Formula $\rho(x,y=0,z,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/rho_p=3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_supersonic_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（按 
\begin_inset Formula $\rho(x,y=0,z,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
为了更直观地比较两种近似解的精度，俯视图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_top"

\end_inset

、仰视图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_supersonic_bottom"

\end_inset

 将 RK3/DG3 近似解显示在上半部分，将 RK1/DG1 近似解关于对称面 (
\begin_inset Formula $y=0$
\end_inset

) 的镜像显示在下半部分。这两幅图再次表明：开启了紧致 WENO 限制器的 RK1/DG3 求解器能够正确捕捉激波；至少在光滑区域，RK3/DG3
 求解器将每个单元内的常值近似提升为二次多项式近似。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/supersonic_top_view.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_supersonic_top"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（上）与 RK1/DG1 近似解（下）的俯视图对比（按 
\begin_inset Formula $\rho(x,y,z=0,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/supersonic_bottom_view.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_supersonic_bottom"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的 RK3/DG3 近似解（上）与 RK1/DG1 近似解（下）的仰视图对比（按 
\begin_inset Formula $\rho(x,y,z=0,t=10)$
\end_inset

 着色）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
并行性能测评
\begin_inset CommandInset label
LatexCommand label
name "subsec:YF17-parallel"

\end_inset


\end_layout

\begin_layout Standard
如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_mesh"

\end_inset

 所示，求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的网格是高度非结构、非均匀的，因此基于几何分割的简单分块方法难以实现负载均衡。如前所述，本文通过调用第三方库 
\shape smallcaps
Metis
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Karypis_1998"
literal "false"

\end_inset

 来实施网格分块，分块结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_partition"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。与
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的分块结果（图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_balance"

\end_inset

）相比，这里的单元分布更加均匀：单元数量的波动小于 
\begin_inset Formula $1\%$
\end_inset

，粗略估计并行效率可达
\begin_inset Formula 
\begin{equation}
\begin{aligned}E & =\frac{T_{\text{serial}}}{PT_{\text{parallel}}}\times100\%\approx\frac{\sum_{i}N_{i}}{P\cdot\max_{i}N_{i}}\times100\%\\
 & =\frac{528915}{100\times5332}\times100\%\approx99.2\%,
\end{aligned}
\label{eq:yf17_estimate}
\end{equation}

\end_inset

其中 
\begin_inset Formula $N_{i}$
\end_inset

 表示第 
\begin_inset Formula $i$
\end_inset

 块内的体单元数量。式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:yf17_estimate"

\end_inset

 只考虑了体单元上的计算所消耗的时间，因此是一种偏乐观的估计。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/partition.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_partition"

\end_inset

将 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所用非结构网格分割为 
\begin_inset Formula $100$
\end_inset

 块的分块结果
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/yf17/balance.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_balance"

\end_inset

图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_partition"

\end_inset

 所示分块结果的单元分布情况
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:yf17_cost"

\end_inset

 给出了 RK3/DG3 求解器以不同进程数量并行求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"

\end_inset

问题所消耗的时间，以及换算后得到的单步核时。基于此表，可以画出加速比与并行效率随进程数量的变换趋势，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_speedup"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_efficiency"

\end_inset

 所示。由图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_efficiency"

\end_inset

 可知，超声速绕流问题的实测并行效率只有约 
\begin_inset Formula $75\%$
\end_inset

（含读写操作）到 
\begin_inset Formula $80\%$
\end_inset

（不含读写操作），低于
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的对应结果（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_efficiency"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示）。造成这种下降的主要原因，在于边界单元分布不均（处理边界条件时，含边界单元较少的进程易处于闲置状态），以及进程间通信量的增加（通信与计算不完全重叠，邻居
较少的进程易处于闲置状态）。
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:yf17_cost"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所消耗的时间
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $P\,\si{(core)}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{100}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{399}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{400}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\frac{T_{399}-T_{100}}{399-100}\,\si{(core\cdot s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\frac{T_{400}-T_{100}}{400-100}\,\si{(core\cdot s)}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10511.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
42466.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
42593.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
106.873
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
106.939
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2389.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9740.13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9769.96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
122.925
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
123.012
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1246.37
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5086.62
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5101.95
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
128.436
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
128.519
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
839.554
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3420.17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3430.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
129.462
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
129.560
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
645.737
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2632.32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2640.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
132.882
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
132.989
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
325.269
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1310.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1319.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
131.833
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
132.595
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
222.890
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
923.043
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
931.754
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
140.499
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
141.773
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
168.862
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
672.439
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
681.445
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
134.736
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
136.689
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
137.787
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
543.081
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
552.682
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
135.550
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
138.298
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/speedup.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_speedup"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所得的加速比
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/yf17/efficiency.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:yf17_efficiency"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所得的并行效率
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
旋翼流场的并行计算及性能测评
\begin_inset CommandInset label
LatexCommand label
name "sec:rotor_in_tunnel"

\end_inset


\end_layout

\begin_layout Standard
本节用图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_mesh"

\end_inset

 所示的网格，模拟孤立旋翼在低速风洞中的吹风试验。风洞外形由三维区间 
\begin_inset Formula $[\SI{-3}{m},\SI{9}{m}]\times[\SI{-3}{m},\SI{3}{m}]\times[\SI{-3}{m},\SI{3}{m}]$
\end_inset

 表示，在其内部嵌套一个较小的三维区间 
\begin_inset Formula $[\SI{-2}{m},\SI{8}{m}]\times[\SI{-2}{m},\SI{2}{m}]\times[\SI{-2}{m},\SI{2}{m}]$
\end_inset

，用以表示旋翼及其尾迹附近网格需要加密的区域。旋翼桨盘中心固定于坐标原点处，桨根及桨尖到该中心点的距离分别为 
\begin_inset Formula $\SI{0.1}{m}$
\end_inset

 与 
\begin_inset Formula $\SI{1.0}{m}$
\end_inset

，因此桨盘直径为 
\begin_inset Formula $\SI{2.0}{m}$
\end_inset

。旋翼转轴允许指向任意方向，转速为每秒 
\begin_inset Formula $40$
\end_inset

 转，桨尖速率约为 
\begin_inset Formula $0.74$
\end_inset

 马赫（声速取 
\begin_inset Formula $\SI{340}{m/s}$
\end_inset

）。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_mesh"

\end_inset

 中的球形区域（即半径为 
\begin_inset Formula $\SI{1.0}{m}$
\end_inset

 的球体）表示桨叶可能扫过的区域，原则上可以在该区域内进一步加密网格，但本节算例并没有对其做特殊处理。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/rotor_in_tunnel/mesh.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_mesh"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

、
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"

\end_inset

问题所用网格的示意图
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
桨叶选用单一翼型、弦长为 
\begin_inset Formula $\SI{0.1}{m}$
\end_inset

 的矩形平直桨叶，预扭角为 
\begin_inset Formula $\ang{10}$
\end_inset

；翼型选用 UH-60A 直升机主旋翼的 SC-1095 翼型，其升力系数、阻力系数曲线分别如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_c_lift"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_c_drag"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，用于作图的数据引自文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Howlett_1981"
literal "false"

\end_inset

。对于更一般的翼型，可以通过吹风试验或数值模拟来获得类似的曲线。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/airfoil/lift.pdf
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_c_lift"

\end_inset

SC-1095 翼型的升力系数曲线
\begin_inset CommandInset citation
LatexCommand cite
key "Howlett_1981"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/airfoil/drag.pdf
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_c_drag"

\end_inset

SC-1095 翼型的阻力系数曲线
\begin_inset CommandInset citation
LatexCommand cite
key "Howlett_1981"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
以上几何参数以及本节剩余部分给出的定解条件，是对真实旋翼风洞试验的较为激进的简化。进行这种简化主要是为了方便后续计算或试验研究复现本节剩余部分给出的算例。实际上
，对于更一般的风洞截面形状，获得如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_mesh"

\end_inset

 所示的只含四面体单元的非结构网格，对于网格生成模块而言没有额外的难度；对于更一般的桨叶外形，如非线性的弦长、预扭分布，本文所实现的求解器也已支持对其进行高效处
理。
\end_layout

\begin_layout Subsection
孤立旋翼爬升问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[孤立旋翼爬升]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:孤立旋翼爬升"

\end_inset

令旋翼转轴指向风洞左侧，即以 
\begin_inset Formula $(-1,0,0)$
\end_inset

 为方向矢量。在时间范围 
\begin_inset Formula $t\in[0,1]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及以下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为均匀低速气流：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.29 & 1.0 & 0.0 & 0.0 & 101325.0\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Problem
边界条件如下：
\end_layout

\begin_deeper
\begin_layout Itemize
风洞上、下、前、后四面均为固体壁面；
\end_layout

\begin_layout Itemize
风洞左端为亚声速入口，状态与初始条件兼容：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=-3}=\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0};
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
风洞右端为亚声速出口，只给定背景压强：
\begin_inset Formula 
\begin{equation}
\eval{p}_{x=9}=101325.0.
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
为了体现高阶求解器在粗网格上的优势，这里采用只含 
\begin_inset Formula $h\approx0.25$
\end_inset

 的四面体单元的粗网格求解该问题。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_t=2e-1_p=3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_t=10e-1_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 分别给出了 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在若干时刻的 RK1/DG1、 RK3/DG3 近似解。这里给出精度较低的 RK1/DG1 近似解，是因为 RK1/DG1 求解器无需限制器，其给出的结果在
物理上较为可靠，可以用来定性地验证高阶近似解的正确性。由于缺少试验数据，本文的所有含旋翼的算例都将采用这种方式来验证。
\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_t=2e-1_p=3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_t=10e-1_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 采取了相同的作图方式：在 
\begin_inset Formula $y=0$
\end_inset

 平面上画出密度分布；在 
\begin_inset Formula $z=0$
\end_inset

 平面上画出速度方向，并以箭头根部密度着色；偏左侧的一对同心圆表示桨尖及桨根轨迹。不难发现：桨盘上（左）侧的速度矢量明显在向中心汇聚，密度值在桨盘附近有一个明显
的跳跃。由等熵条件 
\begin_inset Formula $p=C\rho^{\gamma}$
\end_inset

 可以推知，压强在桨盘附近也有一跳跃，且下（右）侧值大于上（左）侧值。这说明流经桨盘平面的气体，正在被桨叶压缩做功；根据牛顿第三定律，桨叶必然受到气体对其施加的
反作用力，这正是旋翼升力的来源。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=1/Frame20.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=2e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=3/Frame20.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=2e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=1/Frame40.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=4e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题 在 
\begin_inset Formula $t=0.4$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=3/Frame40.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=4e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.4$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=1/Frame60.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=6e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.6$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=3/Frame60.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=6e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.6$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=1/Frame80.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=8e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.8$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=3/Frame80.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=8e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=0.8$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=1/Frame100.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=10e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/p=3/Frame100.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_t=10e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
比较不同时刻的 RK1/DG1、 RK3/DG3 近似解可以发现：两种求解器都能捕捉大尺度的涡结构，例如形成于桨盘下（右）侧、随时间推移而向下（右）移动的环状涡
；但只有 RK3/DG3 求解器才能在如此稀疏的网格上捕捉到声波的干涉条纹。这是因为 RK1/DG1 求解器采用分段常数近似，过大的数值耗散容易将流动细节抹平。
\end_layout

\begin_layout Standard
近似解的数值耗散，还可以通过环状涡的涡核清晰度来观察。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_p=1"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_p=3"

\end_inset

 在图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:upward_t=10e-1_p=3"

\end_inset

 的基础上，补充显示了 
\begin_inset Formula $x=4.8$
\end_inset

 平面上的密度分布。可以发现：环状涡的涡核在 RK1/DG1 近似解中较为模糊，在 RK3/DG3 近似解中仍十分明显。这再次体现了高阶求解器数值耗散低的优势。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/rotor_in_tunnel/upward_p=1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解（补充显示启动涡）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/rotor_in_tunnel/upward_p=3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:upward_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解（补充显示启动涡）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
孤立旋翼前飞问题
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[孤立旋翼前飞]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:孤立旋翼前飞"

\end_inset

令旋翼转轴指向风洞顶部，即以 
\begin_inset Formula $(0,0,1)$
\end_inset

 为方向矢量。在时间范围 
\begin_inset Formula $t\in[0,1]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及以下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为均匀中低速气流：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.29 & 10.0 & 0.0 & 0.0 & 101325.0\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Problem
边界条件设如下：
\end_layout

\begin_deeper
\begin_layout Itemize
风洞上、下、前、后四面均为固体壁面；
\end_layout

\begin_layout Itemize
风洞左端为亚声速入口，状态与初始条件兼容：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{x=-3}=\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0};
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
风洞右端为亚声速出口，只给定背景压强：
\begin_inset Formula 
\begin{equation}
\eval{p}_{x=9}=101325.0.
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
与
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题相同，这里采用只含 
\begin_inset Formula $h\approx0.25$
\end_inset

 的四面体单元的粗网格求解该问题，并且给出精度较低但物理上可靠的 RK1/DG1 近似解，作为定性验证 RK3/DG3 近似解的正确性的参照对象。
\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_t=2e-1_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_t=10e-1_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 依次给出了
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在若干时刻的 RK1/DG1、 RK3/DG3 近似解。具体的作图方式为：在 
\begin_inset Formula $x=4$
\end_inset

 平面上画出密度分布；在 
\begin_inset Formula $y=0$
\end_inset

 平面上画出速度方向，并以箭头根部密度着色；偏左侧的一对同心圆表示桨尖及桨根轨迹。不难发现：桨盘附近的速度矢量明显向下偏转，这表明旋转的桨叶在为气流提供动量；旋
翼尾迹（红色区域）向右偏转，这体现了左侧自由来流的驱动作用。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Frame20.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=2e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/Frame20.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=2e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.2$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Frame40.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=4e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.4$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/Frame40.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=4e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.4$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Frame60.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=6e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.6$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/Frame60.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=6e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.6$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Frame80.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=8e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.8$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/Frame80.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=8e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=0.8$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Frame100.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=10e-1_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/Frame100.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_t=10e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
与
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"

\end_inset

问题的结论类似，两种求解器都能捕捉大尺度的涡结构，例如从桨盘拖出、向右下方倾斜的旋翼尾迹；但只有三阶求解器才能在 
\begin_inset Formula $x=4$
\end_inset

 平面上捕捉到一对清晰的涡核（深蓝色区域）。下面采用两种方法来证明这对涡确实存在。
\end_layout

\begin_layout Standard
第一种方法基于流线。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_wake_y_view"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_wake_z_view"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_wake_x_view"

\end_inset

 分别沿 
\begin_inset Formula $+y$
\end_inset

、
\begin_inset Formula $-z$
\end_inset

、
\begin_inset Formula $+x$
\end_inset

 方向，画出了由 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 RK3/DG3 近似解导出的速度流线三视图。可以看出：桨盘两侧的流线在向后延伸的过程中，叠加了绕某个向后延伸的轴线的转动，该轴线恰好穿过图
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_t=10e-1_p=3"

\end_inset

 中的低密度区（即涡核所在位置）。这至少说明，由 RK3/DG3 近似解导出的结果是自洽的。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/y+.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_wake_y_view"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解导出的流线（主视图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/z-.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_wake_z_view"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解导出的流线（俯视图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=3/x+.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_wake_x_view"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解导出的流线（左视图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
第二种方法基于 
\begin_inset Formula $Q$
\end_inset

 准则，它是一种常用的涡结构可视化方法。图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_Q_y_view"
plural "false"
caps "false"
noprefix "false"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_Q_z_view"
plural "false"
caps "false"
noprefix "false"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_Q_x_view"
plural "false"
caps "false"
noprefix "false"

\end_inset

 分别沿 
\begin_inset Formula $+y$
\end_inset

、
\begin_inset Formula $-z$
\end_inset

、
\begin_inset Formula $+x$
\end_inset

 方向，画出了由 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 RK1/DG1 近似解导出的 
\begin_inset Formula $Q$
\end_inset

 等值面三视图。可以看出：桨盘两侧各有一道向后拖出的涡，且其位置与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_wake_y_view"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_wake_z_view"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:forward_wake_x_view"

\end_inset

 中流线螺旋延伸的轴线一致。这说明由两种近似解导出的结果是相容的。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Q_y+.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_Q_y_view"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解导出的 
\begin_inset Formula $Q$
\end_inset

 等值面（主视图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Q_z-.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_Q_z_view"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解导出的 
\begin_inset Formula $Q$
\end_inset

 等值面（俯视图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/forward/p=1/Q_x+.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_Q_x_view"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解导出的 
\begin_inset Formula $Q$
\end_inset

 等值面（左视图）
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/rotor_in_tunnel/forward_p=1.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_p=1"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK1/DG1 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../mdpi/figures/rotor_in_tunnel/forward_p=3.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:forward_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼前飞"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.0$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
并行性能测评
\begin_inset CommandInset label
LatexCommand label
name "subsec:rotor-parallel"

\end_inset


\end_layout

\begin_layout Standard
如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_mesh"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示，求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的网格与求解 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的网格类似，是高度非结构、非均匀的，因此基于几何分割的简单分块方法难以实现负载均衡。如前所述，本文通过调用第三方库 
\shape smallcaps
Metis
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Karypis_1998"
literal "false"

\end_inset

 来实施网格分块，分块结果如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_partition"

\end_inset

、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。与 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的分块结果（图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_balance"

\end_inset

）相比，这里的单元分布更加均匀：单元数量的波动小于 
\begin_inset Formula $0.5\%$
\end_inset

，粗略估计并行效率可达
\begin_inset Formula 
\begin{equation}
\begin{aligned}E & =\frac{T_{\text{serial}}}{PT_{\text{parallel}}}\times100\%\approx\frac{\sum_{i}N_{i}}{P\cdot\max_{i}N_{i}}\times100\%\\
 & =\frac{72859}{100\times732}\times100\%\approx99.5\%,
\end{aligned}
\label{eq:rotor_upward_estimate}
\end{equation}

\end_inset

其中 
\begin_inset Formula $N_{i}$
\end_inset

 表示第 
\begin_inset Formula $i$
\end_inset

 个进程所分得的体单元数量。与式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:yf17_estimate"

\end_inset

 类似，式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rotor_upward_estimate"

\end_inset

 只考虑了体单元上的计算所消耗的时间，因此依然是一种偏乐观的估计。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/partition.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_upward_partition"

\end_inset

将
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所用非结构网格分割为 
\begin_inset Formula $100$
\end_inset

 块的分块结果
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/balance.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_upward_balance"

\end_inset

图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_partition"

\end_inset

 所示分块结果的单元分布情况
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
表 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:rotor_upward_cost"

\end_inset

 给出了 UMS–RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所消耗的时间，以及换算后得到的单步核时。基于此表，可以画出加速比与并行效率随进程数量的变换趋势，如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_speedup"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示、图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_efficiency"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示。由图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_efficiency"
plural "false"
caps "false"
noprefix "false"

\end_inset

 可知，
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的实测并行效率约为 
\begin_inset Formula $83\%$
\end_inset

（含读写操作）到 
\begin_inset Formula $85\%$
\end_inset

（不含读写操作），低于
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:双马赫反射"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的对应结果（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_mach_efficiency"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示），但高于 
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:YF-17_超声速绕流"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题的对应结果（如图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_efficiency"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示）。 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:rotor_upward_cost"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所消耗的时间
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $P\,\si{(core)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{100}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{399}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $T_{400}\,\si{(s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\frac{T_{399}-T_{100}}{399-100}\,\si{(core\cdot s)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\frac{T_{400}-T_{100}}{400-100}\,\si{(core\cdot s)}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10027.9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40132.7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40250.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100.685
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100.741
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2134.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8590.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8615.49
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
107.950
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
108.012
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1181.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4731.58
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4745.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
118.722
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
118.794
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
591.964
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2371.17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2378.35
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
119.010
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
119.093
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
332.974
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1236.41
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1244.41
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
120.861
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
121.525
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
199.999
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
797.042
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
804.668
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
119.808
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
120.934
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
151.947
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
602.524
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
610.336
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
120.556
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
122.237
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
120.240
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
473.892
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
482.537
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
118.278
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
120.766
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/speedup.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_upward_speedup"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所得的加速比
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/upward/efficiency.pdf
	lyxscale 50
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rotor_upward_efficiency"

\end_inset

RK3/DG3 求解器以不同进程数量并行求解
\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:孤立旋翼爬升"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题所得的并行效率
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
与前两个问题不同，该问题含非定常动量源，一般而言会破坏负载均衡：并非所有单元都需要计算源项，即式 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:body_force"

\end_inset

，那些没有被桨叶轴线穿过的体单元在计算源项这一步时处于闲置状态，这会造成等待时间增加，从而引起并行效率降低。但比较图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rotor_upward_efficiency"

\end_inset

 与图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:yf17_efficiency"
plural "false"
caps "false"
noprefix "false"

\end_inset

 可知：这种不平衡性并没有显著降低实际运行所测得的并行效率。这是因为动量源计算所占比重较小，不足以破坏显著负载均衡。边界单元分布的不均匀以及进程间通信量的增加才
是降低并行效率的主要原因。
\end_layout

\begin_layout Section
本章小结
\end_layout

\begin_layout Standard
本章实现了对第
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:算法"
plural "false"
caps "false"
noprefix "false"

\end_inset

章所提高阶计算方法的并行加速，并在实验室自建的 100 核机群上测量了加速比及并行效率。测量结果表明：
\end_layout

\begin_layout Itemize
加速比近似随核心数量线性增长，说明该并行方案能够有效地降低计算时间。
\end_layout

\begin_layout Itemize
并行效率的测量值距离由分块结果估算得到的理论值有较大差距，说明“通信与计算重叠”的假设过于理想。
\end_layout

\begin_layout Itemize
读写操作对加速比和并行效率有负面影响，应尽量较少读写次数，避免对单一文件的持续写入。
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Chapter
舰载直升机典型气动干扰的数值模拟
\begin_inset CommandInset label
LatexCommand label
name "chap:应用"

\end_inset


\end_layout

\begin_layout Standard
本章利用上述经过验证的 UMS–RK3/DG3 并行求解器，对简化条件下的单旋翼–船体–海面气动干扰的形成过程进行模拟。
\end_layout

\begin_layout Standard
本章在图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ship_mesh"
plural "false"
caps "false"
noprefix "false"

\end_inset

 所示的非结构网格上，模拟舰载直升机的旋翼–船体–海面之间的气动干扰。该网格使用了图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ship_geometry"

\end_inset

 所示的简化版护卫舰模型，其中灰色长方体为文献-
\begin_inset CommandInset citation
LatexCommand cite
key "Thedin_2020"
literal "false"

\end_inset

 对网格进行加密的区域。本文将加密区域适当前移并令其底部与海面接触，以罩住舰体后半部分。该网格相当粗糙：远场单元尺度约为 
\begin_inset Formula $\SI{40}{ft}$
\end_inset

，加密区域内最小单元尺度约为 
\begin_inset Formula $\SI{5}{ft}$
\end_inset

， 为甲板距离海面的高度的三分之一。后面将会看到，在如此粗糙的网格上，高阶 UMS–RKDG 近似解依然能捕捉到许多经典有限体积解不可能捕捉到的流动细节。
\end_layout

\begin_layout Standard
旋翼桨盘中心固定于点 
\begin_inset Formula $(\SI{-45}{ft},\SI{22.5}{ft},\SI{40}{ft})$
\end_inset

 处，桨根及桨尖到该中心点的距离分别为 
\begin_inset Formula $\SI{0.1}{m}$
\end_inset

 与 
\begin_inset Formula $\SI{10}{m}$
\end_inset

，其他几何参数与 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:rotor_in_tunnel"

\end_inset

 节中的桨叶相同。旋翼转轴指向 
\begin_inset Formula $+z$
\end_inset

 方向，转速为每秒 
\begin_inset Formula $4$
\end_inset

 转，桨尖速率约为 
\begin_inset Formula $0.74$
\end_inset

 马赫（声速取 
\begin_inset Formula $\SI{340}{m/s}$
\end_inset

）。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/grid.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_mesh"

\end_inset

本文
\begin_inset CommandInset ref
LatexCommand nameref
reference "chap:应用"

\end_inset

算例所使用的网格
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/simple_frigate.jpeg
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_geometry"

\end_inset

简化的护卫舰几何模型
\begin_inset CommandInset citation
LatexCommand cite
key "Thedin_2020"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
直升机 
\begin_inset Formula $0^{\circ}$
\end_inset

 着舰
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[船头正面迎风]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:船头正面迎风"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0,10]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及以下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为与呈 
\begin_inset Formula $\ang{0}$
\end_inset

 夹角的均匀气流：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.29 & 5.0 & 0.0 & 0.0 & 101325.0\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ship_a=0_t=2_p=3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ship_a=0_t=10_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 清楚地显示了旋翼尾迹的形成过程。计时开始后，一个启动涡在旋翼后缘形成，并随来流向后（右）运动，运动轨迹大致对应旋翼尾迹后缘。该尾迹后缘不受船体阻挡，正常向后向
下延伸，直到触及海面。与之相反，尾迹前缘明显受到船尾甲板阻挡，气流撞击甲板形成高压、高密度区。相应地，旋翼前缘感受到来自甲板的托举力，其机理类似于直升机贴近平地
飞行时所产生的地面效应。因此，在船头正面迎风的情形下，实施船尾甲板起降任务的舰载直升机驾驶员（或自动控制系统）需修正桨距输入，以克服使直升机向后翻滚的俯仰力矩。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=0_p=3/Frame20.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=0_t=2_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头正面迎风"

\end_inset

问题在 
\begin_inset Formula $t=2$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=0_p=3/Frame40.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=0_t=4_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头正面迎风"

\end_inset

问题在 
\begin_inset Formula $t=4$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=0_p=3/Frame60.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=0_t=6_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头正面迎风"

\end_inset

问题在 
\begin_inset Formula $t=6$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=0_p=3/Frame80.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=0_t=8_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头正面迎风"

\end_inset

问题在 
\begin_inset Formula $t=8$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=0_p=3/Frame100.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=0_t=10_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头正面迎风"

\end_inset

问题在 
\begin_inset Formula $t=10$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
直升机 
\begin_inset Formula $45^{\circ}$
\end_inset

 着舰
\end_layout

\begin_layout Problem
\begin_inset ERT
status open

\begin_layout Plain Layout

[船头侧面迎风]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "prob:船头侧面迎风"

\end_inset

在时间范围 
\begin_inset Formula $t\in[0,10]$
\end_inset

 内，求满足三维欧拉方程 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:euler_system"
plural "false"
caps "false"
noprefix "false"

\end_inset

 及以下定解条件的广义解。
\end_layout

\begin_layout Problem
初始条件设为与呈 
\begin_inset Formula $\ang{45}$
\end_inset

 夹角的均匀气流：
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\rho & u_{x} & u_{y} & u_{z} & p\end{bmatrix}_{t=0}=\begin{bmatrix}1.29 & 2.5\sqrt{2} & 2.5\sqrt{2} & 0.0 & 101325.0\end{bmatrix}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
图 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ship_a=45_t=11e-1_p=3"

\end_inset

–
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ship_a=45_t=99e-1_p=3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 给出了 UMS–RK3/DG3 求解器给出的旋翼尾迹的形成过程。可以看到：在船头侧面迎风的条件下，形成于船尾甲板正上方的旋翼尾迹，受海面自由来流的影响向右后方
发展，并且因受到甲板的阻挡而发生变形。与船头正面迎风的情形类似，此时旋翼的受力情况也与平地起降时同等操纵输入的情况不一样。因此，在船头侧面迎风的情形下，实施船尾
甲板起降任务的舰载直升机驾驶员（或自动控制系统）需修正桨距输入，以克服使直升机向右后方翻滚的俯仰和滚转力矩。
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame11.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=11e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=1.1$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame22.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=22e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=2.2$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame33.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=33e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=3.3$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame44.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=44e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=4.4$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame55.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=55e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=5.5$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame66.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=66e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=6.6$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame77.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=77e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=7.7$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame88.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=88e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=8.8$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ship/a=45_p=3/Frame99.png
	lyxscale 15
	width 100text%
	height 26theight%
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ship_a=45_t=99e-1_p=3"

\end_inset


\begin_inset CommandInset ref
LatexCommand nameref
reference "prob:船头侧面迎风"
plural "false"
caps "false"
noprefix "false"

\end_inset

问题在 
\begin_inset Formula $t=9.9$
\end_inset

 时刻的 UMS–RK3/DG3 近似解
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
直升机 
\begin_inset Formula $90^{\circ}$
\end_inset

 着舰
\end_layout

\begin_layout Section
直升机 
\begin_inset Formula $180^{\circ}$
\end_inset

 着舰
\end_layout

\begin_layout Section
本章小结
\end_layout

\begin_layout Standard
本章结果表明：非定常动量源模型与高阶 RKDG 求解器配合使用，能够在静态网格上高效、高精度地模拟旋翼对流场的扰动，避免了传统旋翼空气动力学数值模拟方法对变形网
格、滑动网格、重叠网格等动态网格技术的依赖。
\begin_inset Note Note
status open

\begin_layout Plain Layout
充实内容
\end_layout

\end_inset


\end_layout

\end_body
\end_document
